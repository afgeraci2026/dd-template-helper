(()=>{"use strict";var e={942(e,t,n){n.d(t,{A:()=>i});var r=n(601),o=n.n(r),a=n(314),s=n.n(a)()(o());s.push([e.id,'/* ══════════════════════════════════════════════════════════\n   Automate Loan Docs Template Helper — Taskpane Styles\n   Brand: Midnight Slate, Steel Blue, Paper White\n   ══════════════════════════════════════════════════════════ */\n\n:root {\n  --midnight: #0F1720;\n  --steel: #2C3F52;\n  --gunmetal: #8E949A;\n  --chrome: #C7CCD1;\n  --charcoal: #1C1F23;\n  --graphite: #3A3F45;\n  --paper: #F5F7FA;\n  --cta: #223447;\n  --cta-hover: #3E566E;\n  --mono: "Consolas", "IBM Plex Mono", monospace;\n  --sans: "Segoe UI", "Inter", sans-serif;\n}\n\n* { margin: 0; padding: 0; box-sizing: border-box; }\n\nhtml, body {\n  height: 100%;\n  font-family: var(--sans);\n  font-size: 12px;\n  color: var(--charcoal);\n  background: var(--paper);\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n/* ── Header ────────────────────────────────────────────── */\n#header {\n  background: var(--midnight);\n  padding: 10px 12px;\n  flex-shrink: 0;\n}\n\n.header-brand {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.header-logo {\n  background: var(--steel);\n  color: white;\n  font-weight: 800;\n  font-size: 11px;\n  width: 24px;\n  height: 24px;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.header-title {\n  color: white;\n  font-weight: 600;\n  font-size: 13px;\n}\n\n/* ── Search ────────────────────────────────────────────── */\n#search-bar {\n  padding: 8px 12px;\n  background: white;\n  border-bottom: 1px solid var(--chrome);\n  flex-shrink: 0;\n}\n\n#search-input {\n  width: 100%;\n  padding: 6px 10px;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  font-size: 12px;\n  font-family: var(--sans);\n  outline: none;\n  background: var(--paper);\n}\n\n#search-input:focus {\n  border-color: var(--cta);\n}\n\n/* ── Tab Bar ───────────────────────────────────────────── */\n#tab-bar {\n  display: flex;\n  background: var(--steel);\n  flex-shrink: 0;\n}\n\n.tab {\n  flex: 1;\n  padding: 7px 4px;\n  background: none;\n  border: none;\n  border-bottom: 2px solid transparent;\n  color: rgba(255,255,255,0.6);\n  font-size: 10px;\n  font-weight: 600;\n  font-family: var(--sans);\n  cursor: pointer;\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  transition: all 0.15s;\n}\n\n.tab:hover {\n  color: rgba(255,255,255,0.85);\n}\n\n.tab.active {\n  color: white;\n  border-bottom-color: white;\n}\n\n/* ── Tab Content ───────────────────────────────────────── */\n#tab-content {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n.tab-panel {\n  display: none;\n  padding: 8px;\n}\n\n.tab-panel.active {\n  display: block;\n}\n\n/* ── Accordion Category ────────────────────────────────── */\n.category {\n  margin-bottom: 4px;\n}\n\n.category-header {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 8px;\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 11px;\n  font-weight: 600;\n  color: var(--steel);\n  user-select: none;\n  transition: background 0.1s;\n}\n\n.category-header:hover {\n  background: var(--paper);\n}\n\n.category-header .arrow {\n  font-size: 8px;\n  transition: transform 0.15s;\n  color: var(--gunmetal);\n}\n\n.category.open .category-header .arrow {\n  transform: rotate(90deg);\n}\n\n.category-header .count {\n  margin-left: auto;\n  background: var(--paper);\n  color: var(--gunmetal);\n  padding: 1px 5px;\n  border-radius: 8px;\n  font-size: 9px;\n  font-weight: 700;\n}\n\n.category-body {\n  display: none;\n  padding: 2px 0;\n}\n\n.category.open .category-body {\n  display: block;\n}\n\n/* ── Field Item ────────────────────────────────────────── */\n.field-item {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 5px 8px 5px 20px;\n  cursor: pointer;\n  border-radius: 3px;\n  transition: background 0.1s;\n}\n\n.field-item:hover {\n  background: rgba(34, 52, 71, 0.06);\n}\n\n.field-key {\n  font-family: var(--mono);\n  font-size: 10.5px;\n  font-weight: 600;\n  color: var(--cta);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 170px;\n}\n\n.field-desc {\n  font-size: 10px;\n  color: var(--gunmetal);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  flex: 1;\n}\n\n/* ── Format Picker (inline) ────────────────────────────── */\n.format-picker {\n  display: none;\n  padding: 4px 20px 8px;\n  gap: 4px;\n  flex-wrap: wrap;\n}\n\n.format-picker.open {\n  display: flex;\n}\n\n.format-btn {\n  padding: 2px 8px;\n  font-size: 9px;\n  font-family: var(--mono);\n  font-weight: 600;\n  background: var(--paper);\n  border: 1px solid var(--chrome);\n  border-radius: 3px;\n  cursor: pointer;\n  color: var(--steel);\n  transition: all 0.1s;\n}\n\n.format-btn:hover {\n  background: var(--cta);\n  color: white;\n  border-color: var(--cta);\n}\n\n/* ── Custom Condition Input ────────────────────────────── */\n.custom-condition-box {\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 6px;\n  padding: 8px 10px;\n  margin-bottom: 8px;\n}\n\n.custom-condition-label {\n  font-size: 10px;\n  font-weight: 700;\n  color: var(--steel);\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  margin-bottom: 5px;\n}\n\n.custom-condition-input {\n  width: 100%;\n  padding: 5px 8px;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  font-size: 11px;\n  font-family: var(--mono);\n  font-weight: 600;\n  color: var(--cta);\n  background: var(--paper);\n  outline: none;\n  margin-bottom: 6px;\n  text-transform: uppercase;\n}\n\n.custom-condition-input:focus {\n  border-color: var(--cta);\n}\n\n.custom-condition-input::placeholder {\n  text-transform: none;\n  font-weight: 400;\n  color: var(--gunmetal);\n}\n\n.custom-condition-actions {\n  display: flex;\n  gap: 4px;\n  flex-wrap: wrap;\n}\n\n.custom-action-btn {\n  padding: 3px 8px;\n  font-size: 10px;\n  font-weight: 600;\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 3px;\n  cursor: pointer;\n  color: var(--steel);\n  font-family: var(--sans);\n  transition: all 0.1s;\n}\n\n.custom-action-btn:hover {\n  background: var(--cta);\n  color: white;\n  border-color: var(--cta);\n}\n\n/* ── Condition Item ────────────────────────────────────── */\n.condition-item {\n  padding: 5px 8px 5px 20px;\n  cursor: pointer;\n  border-radius: 3px;\n  transition: background 0.1s;\n}\n\n.condition-item:hover {\n  background: rgba(34, 52, 71, 0.06);\n}\n\n.condition-actions {\n  display: none;\n  padding: 4px 20px 8px;\n  gap: 4px;\n}\n\n.condition-actions.open {\n  display: flex;\n}\n\n.action-btn {\n  padding: 3px 8px;\n  font-size: 10px;\n  font-weight: 600;\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 3px;\n  cursor: pointer;\n  color: var(--steel);\n  font-family: var(--sans);\n  transition: all 0.1s;\n}\n\n.action-btn:hover {\n  background: var(--cta);\n  color: white;\n  border-color: var(--cta);\n}\n\n/* ── Compound / AND / OR buttons ─────────────────────── */\n.compound-btn {\n  background: var(--paper);\n  color: var(--steel);\n  border-color: var(--steel);\n  font-style: italic;\n}\n.compound-btn:hover {\n  background: var(--steel);\n  color: white;\n  border-color: var(--steel);\n}\n\n/* ── Comparison builder ──────────────────────────────── */\n.comparison-insert-btn {\n  margin-top: 2px;\n}\n\n/* ── Loop / Collection Card ────────────────────────────── */\n.collection-card {\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 6px;\n  margin-bottom: 6px;\n  overflow: hidden;\n}\n\n.collection-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 10px;\n  cursor: pointer;\n  font-weight: 600;\n  font-size: 11px;\n  color: var(--steel);\n}\n\n.collection-header .arrow {\n  font-size: 8px;\n  color: var(--gunmetal);\n  transition: transform 0.15s;\n}\n\n.collection-card.open .collection-header .arrow {\n  transform: rotate(90deg);\n}\n\n.collection-body {\n  display: none;\n  padding: 0 10px 8px;\n}\n\n.collection-card.open .collection-body {\n  display: block;\n}\n\n.collection-desc {\n  font-size: 10px;\n  color: var(--gunmetal);\n  margin-bottom: 6px;\n}\n\n.insert-btns {\n  display: flex;\n  gap: 4px;\n  margin-bottom: 6px;\n}\n\n.item-field {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 3px 6px;\n  cursor: pointer;\n  border-radius: 3px;\n  transition: background 0.1s;\n}\n\n.item-field:hover {\n  background: rgba(34, 52, 71, 0.06);\n}\n\n/* ── Validate Tab ──────────────────────────────────────── */\n.validate-btn {\n  width: 100%;\n  padding: 10px;\n  background: var(--cta);\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 12px;\n  font-weight: 700;\n  font-family: var(--sans);\n  cursor: pointer;\n  margin-bottom: 10px;\n  transition: background 0.15s;\n}\n\n.validate-btn:hover {\n  background: var(--cta-hover);\n}\n\n.validate-summary {\n  padding: 8px 10px;\n  border-radius: 6px;\n  font-size: 11px;\n  font-weight: 600;\n  margin-bottom: 8px;\n}\n\n.validate-summary.success {\n  background: #ecfdf5;\n  color: #065f46;\n  border: 1px solid #a7f3d0;\n}\n\n.validate-summary.errors {\n  background: #fef2f2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n}\n\n.issue-card {\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  padding: 6px 8px;\n  margin-bottom: 4px;\n  cursor: pointer;\n  transition: background 0.1s;\n}\n\n.issue-card:hover {\n  background: #fef2f2;\n}\n\n.issue-type {\n  font-size: 9px;\n  font-weight: 700;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  margin-bottom: 2px;\n}\n\n.issue-type.error { color: #dc2626; }\n.issue-type.warning { color: #d97706; }\n\n.issue-text {\n  font-size: 11px;\n  color: var(--charcoal);\n}\n\n.issue-detail {\n  font-size: 10px;\n  color: var(--gunmetal);\n  font-family: var(--mono);\n  margin-top: 2px;\n}\n\n/* ── Reference Tab ─────────────────────────────────────── */\n.ref-section {\n  margin-bottom: 12px;\n}\n\n.ref-section h3 {\n  font-size: 11px;\n  font-weight: 700;\n  color: var(--steel);\n  margin-bottom: 4px;\n  padding-bottom: 2px;\n  border-bottom: 1px solid var(--chrome);\n}\n\n.ref-row {\n  display: flex;\n  padding: 3px 0;\n  font-size: 10.5px;\n}\n\n.ref-syntax {\n  font-family: var(--mono);\n  font-weight: 600;\n  color: var(--cta);\n  min-width: 130px;\n}\n\n.ref-explain {\n  color: var(--graphite);\n  flex: 1;\n}\n\n/* ── Status Bar ────────────────────────────────────────── */\n#status-bar {\n  background: var(--midnight);\n  color: var(--gunmetal);\n  padding: 4px 12px;\n  font-size: 10px;\n  flex-shrink: 0;\n}\n\n/* ── Scrollbar ─────────────────────────────────────────── */\n#tab-content::-webkit-scrollbar { width: 5px; }\n#tab-content::-webkit-scrollbar-track { background: transparent; }\n#tab-content::-webkit-scrollbar-thumb { background: var(--chrome); border-radius: 3px; }\n',""]);const i=s},314(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,o,a){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(s[c]=!0)}for(var d=0;d<e.length;d++){var p=[].concat(e[d]);r&&s[p[0]]||(void 0!==a&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=a),n&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=n):p[2]=n),o&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=o):p[4]="".concat(o)),t.push(p))}},t}},601(e){e.exports=function(e){return e[1]}},72(e){var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var a={},s=[],i=0;i<e.length;i++){var c=e[i],d=r.base?c[0]+r.base:c[0],p=a[d]||0,y="".concat(d," ").concat(p);a[d]=p+1;var l=n(y),g={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==l)t[l].references++,t[l].updater(g);else{var m=o(g,r);r.byIndex=i,t.splice(i,0,{identifier:y,updater:m,references:1})}s.push(y)}return s}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var a=r(e=e||[],o=o||{});return function(e){e=e||[];for(var s=0;s<a.length;s++){var i=n(a[s]);t[i].references--}for(var c=r(e,o),d=0;d<a.length;d++){var p=n(a[d]);0===t[p].references&&(t[p].updater(),t.splice(p,1))}a=c}}},659(e){var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56(e,t,n){e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={id:r,exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var r={};n.r(r),n.d(r,{init:()=>G,search:()=>W});var o={};n.r(o),n.d(o,{init:()=>q,search:()=>j});var a={};n.r(a),n.d(a,{init:()=>re,search:()=>oe});var s={};n.r(s),n.d(s,{init:()=>le,search:()=>ge});var i={};n.r(i),n.d(i,{init:()=>ue,search:()=>Re});var c=n(72),d=n.n(c),p=n(825),y=n.n(p),l=n(659),g=n.n(l),m=n(56),T=n.n(m),E=n(540),u=n.n(E),R=n(113),f=n.n(R),S=n(942),_={};_.styleTagTransform=f(),_.setAttributes=T(),_.insert=g().bind(null,"head"),_.domAPI=y(),_.insertStyleElement=u(),d()(S.A,_),S.A&&S.A.locals&&S.A.locals;const k=[{key:"LOAN_AMOUNT",description:"Principal loan amount",category:"Core Loan Terms",dataType:"money",suggestedFormats:["CURRENCY","WORDS","CENTS"]},{key:"INTEREST_RATE",description:"Annual interest rate",category:"Core Loan Terms",dataType:"rate",suggestedFormats:["DECIMAL2","PERCENT","WORDS"]},{key:"DEFAULT_RATE",description:"Default interest rate",category:"Core Loan Terms",dataType:"rate",suggestedFormats:["DECIMAL2","PERCENT","WORDS"]},{key:"TERM_MONTHS",description:"Loan term in months",category:"Core Loan Terms",dataType:"number",suggestedFormats:["WORDS"]},{key:"AMORTIZATION_TYPE",description:"Amortization type (IO, Fully Amortized, etc.)",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"REPAYMENT_SCHEDULE",description:"Payment frequency (Monthly, Quarterly, etc.)",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"LOAN_TYPE",description:"Loan type code (bridge, dscr, construction, etc.)",category:"Core Loan Terms",dataType:"text",suggestedFormats:["UPPER"]},{key:"LOAN_NAME",description:"Loan name/identifier",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"LOAN_NUMBER",description:"Loan number (maps from loan name)",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"IO_MONTHS",description:"Interest-only period in months",category:"Core Loan Terms",dataType:"number",suggestedFormats:["WORDS"]},{key:"PAYMENT_TYPE_DESCRIPTION",description:"Descriptive text for payment type",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"AMORT_PERIOD",description:"Amortization period in months",category:"Core Loan Terms",dataType:"number",suggestedFormats:[]},{key:"AMORT_PERIOD_AFTER_IO",description:"Amortization months after IO period",category:"Core Loan Terms",dataType:"number",suggestedFormats:[]},{key:"AMORT_SCHEDULE_MONTHS",description:"Partial amortization schedule months",category:"Core Loan Terms",dataType:"number",suggestedFormats:[]},{key:"EFFECTIVE_DATE",description:"Loan effective/origination date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"ORIGINATION_DATE",description:"Loan origination date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"ORIGINATION_DATE_LONG",description:"Origination date (pre-formatted long)",category:"Dates",dataType:"text",suggestedFormats:[]},{key:"TODAY",description:"Current date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"CLOSING_DATE",description:"Closing date (if set)",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"PAYMENT_START_DATE",description:"First payment date (month after origination)",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"MATURITY_DATE",description:"Loan maturity date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"MATURITY_DATE_LONG",description:"Maturity date (pre-formatted long)",category:"Dates",dataType:"text",suggestedFormats:[]},{key:"MONTHLY_PAYMENT",description:"Computed monthly payment amount",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"MONTHLY_PAYMENT_WORDS",description:"Monthly payment in English words",category:"Payment Calculations",dataType:"text",suggestedFormats:[]},{key:"MONTHLY_PAYMENT_CENTS",description:"Monthly payment cents portion",category:"Payment Calculations",dataType:"text",suggestedFormats:[]},{key:"IO_MONTHLY_PAYMENT",description:"Interest-only period payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"AMORT_MONTHLY_PAYMENT",description:"Amortized period payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"PARTIAL_AMORT_PAYMENT",description:"Partially amortized payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"BALLOON_PAYMENT",description:"Balloon payment at maturity",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"DAILY_INTEREST",description:"Daily interest amount (principal x rate / 360)",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"IO_PERIOD_END_MONTH",description:"Last month of IO period",category:"Payment Calculations",dataType:"number",suggestedFormats:[]},{key:"AMORT_START_MONTH",description:"First month of amortization",category:"Payment Calculations",dataType:"number",suggestedFormats:[]},{key:"FULL_PRINCIPAL_IO_PAYMENT",description:"IO payment on full principal (no holdback)",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"FULL_PRINCIPAL_AMORT_PAYMENT",description:"Amort payment on full principal (no holdback)",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"DSR_MONTHS_PAYMENT",description:"Debt service reserve months x payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"LOAN_AMOUNT_WORDS",description:"Loan amount in English words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LOAN_AMOUNT_CENTS",description:"Loan amount cents portion",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LOAN_AMOUNT_DOUBLED",description:"Principal x 2 (mortgage max obligation)",category:"Words & Cents",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"INTEREST_RATE_WORDS",description:"Interest rate whole part in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"INTEREST_RATE_CENTS",description:"Interest rate decimal portion",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"DEFAULT_RATE_WORDS",description:"Default rate in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"DEFAULT_RATE_CENTS",description:"Default rate decimal portion",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LATE_CHARGE_PERCENT_WORDS",description:"Late charge percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LATE_CHARGE_DAYS_WORDS",description:"Late charge days in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"TERM_MONTHS_WORDS",description:"Term months in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"IO_MONTHS_WORDS",description:"IO months in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXIT_FEE_DOLLAR_WORDS",description:"Exit fee dollar amount in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXIT_FEE_PERCENT_WORDS",description:"Exit fee percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"TERMINATION_PERCENT_WORDS",description:"Termination percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_WORDS",description:"Construction holdback in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_CENTS",description:"Construction holdback cents",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXTENSION_COUNT_WORDS",description:"Extension count in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXTENSION_LENGTH_WORDS",description:"Extension length in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXTENSION_FEE_PERCENT_WORDS",description:"Extension fee percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LATE_CHARGE_PERCENT",description:"Late charge percentage",category:"Late Charges",dataType:"rate",suggestedFormats:["PERCENT","DECIMAL2"]},{key:"LATE_CHARGE_DAYS",description:"Grace period days before late charge",category:"Late Charges",dataType:"number",suggestedFormats:["WORDS"]},{key:"STATE_CHOICE_OF_LAW",description:"Governing state for the loan",category:"Choice of Law",dataType:"text",suggestedFormats:["UPPER"]},{key:"COUNTY_CHOICE_OF_LAW",description:"Governing county",category:"Choice of Law",dataType:"text",suggestedFormats:[]},{key:"TITLE_COMPANY_NAME",description:"Title company name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"TITLE_OFFICER_NAME",description:"Title officer name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"TITLE_EMAIL",description:"Title officer email",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"TITLE_POLICY_AMOUNT",description:"Title policy coverage amount",category:"Title & Escrow",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"TITLE_POLICY_PERCENT",description:"Title policy coverage percentage",category:"Title & Escrow",dataType:"rate",suggestedFormats:["PERCENT"]},{key:"ESCROW_COMPANY_NAME",description:"Escrow company name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"ESCROW_OFFICER_NAME",description:"Escrow officer name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"ESCROW_EMAIL",description:"Escrow officer email",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"DOC_PREP_NAME",description:"Document preparer name",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"DOC_PREP_CLOSING_NAME",description:"Closing contact name",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"DOC_PREP_CLOSING_EMAIL",description:"Closing contact email",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"MATTER_NUMBER",description:"Matter/file number",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_NAME",description:"General contractor name",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_ADDRESS",description:"Contractor street address",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_CITY",description:"Contractor city",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_STATE",description:"Contractor state",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_ZIP",description:"Contractor ZIP code",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGN_PROFESSIONAL_NAME",description:"Design professional/architect name",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_ADDRESS",description:"Designer street address",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_CITY",description:"Designer city",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_STATE",description:"Designer state",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_ZIP",description:"Designer ZIP code",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_AMOUNT",description:"Construction holdback/reserve amount",category:"Construction",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"CONSTRUCTION_HOLDBACK_PAID_TO",description:"Construction holdback payee",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_PAID_TO_NOTES",description:"Construction holdback delivery notes",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"EXTENSION_COUNT",description:"Number of extension options",category:"Extensions",dataType:"number",suggestedFormats:["WORDS"]},{key:"EXTENSION_LENGTH",description:"Duration of each extension (months)",category:"Extensions",dataType:"number",suggestedFormats:["WORDS"]},{key:"EXTENSION_FEE_PERCENT",description:"Extension fee as % of loan amount",category:"Extensions",dataType:"rate",suggestedFormats:["PERCENT","WORDS"]},{key:"TERMINATION_FEE_TYPE",description:"Termination fee type (Percentage, Dollar, Greater Of)",category:"Termination & Fees",dataType:"text",suggestedFormats:[]},{key:"TERMINATION_PERCENT",description:"Termination fee percentage",category:"Termination & Fees",dataType:"rate",suggestedFormats:["PERCENT"]},{key:"TERMINATION_DOLLAR",description:"Termination fee dollar amount",category:"Termination & Fees",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"EXIT_FEE_DOLLAR",description:"Exit fee dollar amount",category:"Termination & Fees",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"EXIT_FEE_PERCENT",description:"Exit fee percentage",category:"Termination & Fees",dataType:"rate",suggestedFormats:["PERCENT","WORDS"]},{key:"GUARANTEED_MONTHS_INTEREST",description:"Guaranteed months of interest (prepay)",category:"Termination & Fees",dataType:"number",suggestedFormats:["WORDS"]},{key:"PREPAY_PENALTY_TYPE",description:"Prepayment penalty type (Stepdown, GuaranteedInterest)",category:"Termination & Fees",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_AMOUNT",description:"Debt service reserve amount",category:"Reserves",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"DEBT_SERVICE_RESERVE_AMOUNT_WORDS",description:"DSR amount in words",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_WORDS",description:"DSR amount in words (alias)",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_PAID_TO",description:"DSR payee",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_PAID_TO_NOTES",description:"DSR delivery notes",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_TAX_RESERVE_AMOUNT",description:"Property tax reserve amount",category:"Reserves",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"PROPERTY_TAX_RESERVE_PAID_TO",description:"Property tax reserve payee",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_TAX_RESERVE_NOTES",description:"Property tax reserve notes",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"MIN_NUMBER",description:"MERS Identification Number",category:"MERS",dataType:"text",suggestedFormats:[]},{key:"TOTAL_FEES_PERCENT",description:"Sum of all fee percentages",category:"Fees",dataType:"rate",suggestedFormats:["PERCENT"]},{key:"TOTAL_FEES_AMOUNT",description:"Sum of all fee amounts",category:"Fees",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"BORROWER_NAME",description:"Primary borrower full name",category:"Primary Borrower",dataType:"text",suggestedFormats:["UPPER"]},{key:"BORROWER_ENTITY_TYPE",description:"Primary borrower entity type",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_ENTITY_STRUCTURE",description:"Primary borrower entity structure",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_STATE_ORG",description:"Primary borrower state of formation",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_ADDRESS",description:"Primary borrower street address",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_CITY",description:"Primary borrower city",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_STATE",description:"Primary borrower state",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_ZIP",description:"Primary borrower ZIP",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_FULL_ADDRESS",description:"Primary borrower formatted address",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_AUTH_SIGNER",description:"Primary borrower authorized signer",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_AUTH_SIGNER_TITLE",description:"Primary borrower signer title",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"ALL_BORROWERS",description:"All borrowers with entity descriptions",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"LENDER_NAME",description:"Primary lender full name",category:"Primary Lender",dataType:"text",suggestedFormats:["UPPER"]},{key:"LENDER_ENTITY_TYPE",description:"Primary lender entity type",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_ENTITY_STRUCTURE",description:"Primary lender entity structure",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_STATE_ORG",description:"Primary lender state of formation",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_ADDRESS",description:"Primary lender street address",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_CITY",description:"Primary lender city",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_STATE",description:"Primary lender state",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_ZIP",description:"Primary lender ZIP",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_FULL_ADDRESS",description:"Primary lender formatted address",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_LICENSE",description:"Primary lender license number",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_CLOSING_CONTACT",description:"Primary lender closing contact name",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_CLOSING_CONTACT_EMAIL",description:"Primary lender closing contact email",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"ALL_LENDERS",description:"All lenders with entity descriptions and licenses",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_NAME",description:"Primary guarantor full name",category:"Primary Guarantor",dataType:"text",suggestedFormats:["UPPER"]},{key:"GUARANTOR_ADDRESS",description:"Primary guarantor street address",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_CITY",description:"Primary guarantor city",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_STATE",description:"Primary guarantor state",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_ZIP",description:"Primary guarantor ZIP",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_FULL_ADDRESS",description:"Primary guarantor formatted address",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_ENTITY_TYPE",description:"Primary guarantor entity type",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_ENTITY_STRUCTURE",description:"Primary guarantor entity structure",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_STATE_ORG",description:"Primary guarantor state of formation",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"ALL_GUARANTORS",description:"All guarantors with entity descriptions",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"BROKER_NAME",description:"Primary broker name",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ADDRESS",description:"Primary broker street address",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_CITY",description:"Primary broker city",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_STATE",description:"Primary broker state",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ZIP",description:"Primary broker ZIP",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_FULL_ADDRESS",description:"Primary broker formatted address",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ENTITY_TYPE",description:"Primary broker entity type",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ENTITY_STRUCTURE",description:"Primary broker entity structure",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_STATE_ORG",description:"Primary broker state of formation",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_LICENSE_TYPE",description:"Primary broker license type",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_LICENSE",description:"Primary broker license number",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_ADDRESS",description:"Primary property street address",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_CITY",description:"Primary property city",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_STATE",description:"Primary property state",category:"Property",dataType:"text",suggestedFormats:["UPPER"]},{key:"PROPERTY_STATE_UPPER",description:"Primary property state (uppercase)",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_ZIP",description:"Primary property ZIP",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_TYPE",description:"Primary property type",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_PARCEL",description:"Primary property parcel/APN number",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_FULL_ADDRESS",description:"Primary property formatted address",category:"Property",dataType:"text",suggestedFormats:[]},{key:"SECURITY_INSTRUMENT_TYPE",description:"Deed of Trust or Mortgage (per primary property state)",category:"Property",dataType:"text",suggestedFormats:[]},{key:"SERVICER_NAME",description:"Loan servicer name",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_ADDRESS",description:"Servicer street address",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_CITY",description:"Servicer city",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_STATE",description:"Servicer state",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_ZIP",description:"Servicer ZIP",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_FULL_ADDRESS",description:"Servicer formatted full address",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"BORROWER_COUNT",description:"Number of borrowers",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"LENDER_COUNT",description:"Number of lenders",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"GUARANTOR_COUNT",description:"Number of guarantors",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"PROPERTY_COUNT",description:"Number of properties",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"DOT_COUNT",description:"Number of Deed of Trust properties",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"MORTGAGE_COUNT",description:"Number of Mortgage properties",category:"Counts",dataType:"number",suggestedFormats:[]}],A=(new Set(k.map(e=>e.category)),new Set(k.map(e=>e.key)),[{key:"IS_BRIDGE",description:"Loan type is Bridge",category:"Loan Type"},{key:"IS_DSCR",description:"Loan type is DSCR / Rental",category:"Loan Type"},{key:"IS_CONSTRUCTION",description:"Loan type is Construction",category:"Loan Type"},{key:"IS_FIX_FLIP",description:"Loan type is Fix & Flip",category:"Loan Type"},{key:"IS_COMMERCIAL",description:"Loan type is Commercial",category:"Loan Type"},{key:"IS_LAND",description:"Loan type is Land",category:"Loan Type"},{key:"IS_INTEREST_ONLY",description:"Amortization is Interest-Only",category:"Amortization"},{key:"IS_FULLY_AMORTIZED",description:"Amortization is Fully Amortized",category:"Amortization"},{key:"IS_IO_THEN_AMORT",description:"IO then Fully Amortized",category:"Amortization"},{key:"IS_IO_THEN_AMORTIZED",description:"IO then Fully Amortized (alias)",category:"Amortization"},{key:"IS_PARTIALLY_AMORTIZED",description:"Partially Amortized with balloon",category:"Amortization"},{key:"HAS_MERS",description:"MERS is included",category:"Loan Features"},{key:"HAS_CONSTRUCTION_HOLDBACK",description:"Construction holdback/reserve exists",category:"Loan Features"},{key:"HAS_DUTCH_INTEREST",description:"Dutch interest applies",category:"Loan Features"},{key:"HAS_CONSTRUCTION_CONTRACT",description:"Construction contract provided",category:"Loan Features"},{key:"HAS_DESIGN_PROFESSIONAL",description:"Design professional/architect assigned",category:"Loan Features"},{key:"HAS_CONDITIONAL_EXTENSION",description:"Conditional extension right exists",category:"Loan Features"},{key:"HAS_PARTIAL_RELEASE",description:"Partial release clause included",category:"Loan Features"},{key:"HAS_TERMINATION_FEE",description:"Termination fee applies",category:"Loan Features"},{key:"HAS_EXIT_FEE",description:"Exit fee applies",category:"Loan Features"},{key:"HAS_PREPAYMENT_PENALTY",description:"Prepayment penalty applies",category:"Loan Features"},{key:"HAS_DEBT_SERVICE_RESERVE",description:"Debt service reserve exists",category:"Loan Features"},{key:"HAS_PROPERTY_TAX_RESERVE",description:"Property tax reserve exists",category:"Loan Features"},{key:"HAS_CROSS_COLLATERAL",description:"Cross-collateral clause included",category:"Loan Features"},{key:"HAS_BORROWER_SERVICE_FEES",description:"Borrower service fees apply",category:"Loan Features"},{key:"HAS_ACH_PAYMENTS",description:"ACH payments required",category:"Loan Features"},{key:"HAS_W9",description:"W-9 included",category:"Loan Features"},{key:"HAS_SIGNING_AFFIDAVIT",description:"Signing affidavit included",category:"Loan Features"},{key:"LOAN_INTENDED_FOR_SALE",description:"Loan intended for sale",category:"Loan Features"},{key:"NOT_HAS_CONSTRUCTION_HOLDBACK",description:"No construction holdback",category:"Negated Flags"},{key:"NOT_HAS_PREPAYMENT_PENALTY",description:"No prepayment penalty",category:"Negated Flags"},{key:"NOT_HAS_ACH_PAYMENTS",description:"No ACH payments required",category:"Negated Flags"},{key:"HAS_BORROWER",description:"At least one borrower exists",category:"Party Presence"},{key:"HAS_LENDER",description:"At least one lender exists",category:"Party Presence"},{key:"HAS_PROPERTY",description:"At least one property exists",category:"Party Presence"},{key:"HAS_GUARANTOR",description:"Guarantor exists on the loan",category:"Party Presence"},{key:"HAS_BROKER",description:"Broker exists on the loan",category:"Party Presence"},{key:"HAS_SERVICER",description:"Loan servicer is assigned",category:"Party Presence"},{key:"HAS_ESCROW",description:"Escrow company exists",category:"Party Presence"},{key:"HAS_ASSIGNEE",description:"Loan assignee exists",category:"Party Presence"},{key:"MULTIPLE_BORROWERS",description:"More than one borrower",category:"Party Presence"},{key:"MULTIPLE_LENDERS",description:"More than one lender",category:"Party Presence"},{key:"MULTIPLE_GUARANTORS",description:"More than one guarantor",category:"Party Presence"},{key:"MULTIPLE_PROPERTIES",description:"More than one property",category:"Party Presence"},{key:"SINGLE_BORROWER",description:"Exactly one borrower",category:"Party Presence"},{key:"SINGLE_LENDER",description:"Exactly one lender",category:"Party Presence"},{key:"SINGLE_GUARANTOR",description:"Exactly one guarantor",category:"Party Presence"},{key:"SINGLE_PROPERTY",description:"Exactly one property",category:"Party Presence"},{key:"MULTIPLE_ASSIGNEES",description:"More than one assignee",category:"Party Presence"},{key:"HAS_ENTITY_BORROWER",description:"Any borrower is an entity (LLC, Corp)",category:"Borrower Types"},{key:"HAS_TRUST_BORROWER",description:"Any borrower is a trust",category:"Borrower Types"},{key:"HAS_INDIVIDUAL_BORROWER",description:"Any borrower is an individual",category:"Borrower Types"},{key:"BORROWER_IS_ENTITY",description:"Primary borrower is an entity",category:"Borrower Types"},{key:"BORROWER_IS_TRUST",description:"Primary borrower is a trust",category:"Borrower Types"},{key:"BORROWER_IS_INDIVIDUAL",description:"Primary borrower is an individual",category:"Borrower Types"},{key:"BORROWER_HAS_REG_AGENT",description:"Primary borrower has registered agent",category:"Borrower Types"},{key:"HAS_DOT",description:"Has property in a Deed of Trust state",category:"Security Instrument"},{key:"HAS_MORTGAGE",description:"Has property in a Mortgage state",category:"Security Instrument"},{key:"HAS_DOT_AND_MORTGAGE",description:"Has properties in both DOT and Mortgage states",category:"Security Instrument"},{key:"PROPERTY_IS_DOT_STATE",description:"Primary property is in a DOT state",category:"Security Instrument"},{key:"PROPERTY_REQUIRES_WITNESSES",description:"Primary property state requires witnesses",category:"Security Instrument"},{key:"MULTIPLE_DOT_PROPERTIES",description:"More than one DOT property",category:"Security Instrument"},{key:"MULTIPLE_MORTGAGE_PROPERTIES",description:"More than one Mortgage property",category:"Security Instrument"},{key:"MULTIPLE_BORROWER_SIGNERS",description:"More than one borrower signer total",category:"Signature Blocks"},{key:"SIGNER_IS_ENTITY",description:"Any borrower is an entity (needs auth signer)",category:"Signature Blocks"},{key:"HAS_LENDER_FEES",description:"Lender fees exist",category:"Fee Presence"},{key:"HAS_BROKER_FEES",description:"Broker fees exist",category:"Fee Presence"},{key:"HAS_OTHER_FEES",description:"Other fees exist",category:"Fee Presence"},{key:"TERMINATION_IS_PERCENTAGE",description:"Termination fee is percentage-based",category:"Termination & Prepay Types"},{key:"TERMINATION_IS_DOLLAR",description:"Termination fee is dollar-based",category:"Termination & Prepay Types"},{key:"TERMINATION_IS_GREATER_OF",description:"Termination fee is greater of % or $",category:"Termination & Prepay Types"},{key:"PREPAY_TYPE_STEPDOWN",description:"Prepayment penalty is stepdown schedule",category:"Termination & Prepay Types"},{key:"PREPAY_TYPE_GUARANTEED_INTEREST_FOR_X_MONTHS",description:"Prepay is guaranteed months of interest",category:"Termination & Prepay Types"},{key:"HAS_TITLE_COMPANY",description:"Title company info exists",category:"Title & Escrow"},{key:"HAS_CFL_LICENSE",description:"Any lender has CFL license",category:"Title & Escrow"},{key:"PROPERTY_IS_LOUISIANA",description:"Primary property is in Louisiana",category:"State-Specific"},{key:"PROPERTY_IS_HAWAII",description:"Primary property is in Hawaii",category:"State-Specific"},{key:"PROPERTY_IS_OHIO",description:"Primary property is in Ohio",category:"State-Specific"},{key:"MULTIPLE_EXTENSION_COUNT",description:"More than one extension option",category:"Extensions"},{key:"MULTIPLE_EXTENSION_LENGTH",description:"Extension length > 1 month",category:"Extensions"},{key:"MULTIPLE_OWNERS_OF_ENTITYS",description:"More than one entity owner",category:"Entity Owners"},{key:"OWNERS_OF_ENTITY_COUNT_GT_2",description:"More than two entity owners",category:"Entity Owners"},{key:"IS_GUARANTY_LIMITED",description:"Guaranty is limited (not yet implemented)",category:"Defaults"},{key:"IS_NOTE_HYPOTHECATION",description:"Note hypothecation (not yet implemented)",category:"Defaults"},{key:"HAS_DIFFERENT_EFFECTIVE_DATE",description:"Different effective date (not yet implemented)",category:"Defaults"}]),N=(new Set(A.map(e=>e.category)),new Set(A.map(e=>e.key)),[{key:"NAME",description:"Full legal name"},{key:"FIRST_NAME",description:"First name (individual)"},{key:"LAST_NAME",description:"Last name (individual)"},{key:"ENTITY_TYPE",description:"Individual, Entity, or Trust"},{key:"ENTITY_STRUCTURE",description:"LLC, Corporation, etc."},{key:"STATE_OF_FORMATION",description:"State of organization"},{key:"STATE_ORG",description:"State of organization (alias)"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"FULL_ADDRESS",description:"Formatted full address"},{key:"ENTITY_DESCRIPTION",description:'e.g., "a California limited liability company"'},{key:"TYPE_IS_INDIVIDUAL",description:"True if individual"},{key:"TYPE_IS_ENTITY",description:"True if entity"},{key:"TYPE_IS_TRUST",description:"True if trust"},{key:"AUTH_SIGNER",description:"First authorized signer name"},{key:"AUTH_SIGNER_TITLE",description:"First signer title"},{key:"HAS_AUTH_SIGNER",description:"True if any signer exists"},{key:"MULTIPLE_AUTH_SIGNERS",description:"True if > 1 signer"},{key:"AUTH_SIGNER_COUNT",description:"Number of signers"}]),O=[{key:"BORROWERS",description:"All borrowers on the loan",category:"Parties",itemFields:[...N,{key:"REG_AGENT",description:"Registered agent name"},{key:"REG_AGENT_ADDRESS",description:"Registered agent address"},{key:"AKA_NAMES",description:"Also-known-as names (comma-separated)"},{key:"HAS_AKA",description:"True if has AKA names"},{key:"AUTH_SIGNER_2",description:"Second authorized signer"},{key:"AUTH_SIGNER_2_TITLE",description:"Second signer title"},{key:"TYPE_IS_CORPORATION",description:"True if entity structure is corporation"},{key:"TYPE_IS_NON_CORPORATION",description:"True if entity structure is NOT corporation"},{key:"BORROWER_SIGNER_NEEDS_SIGNER",description:"True if entity/trust (needs auth signer)"}]},{key:"LENDERS",description:"All lenders on the loan",category:"Parties",itemFields:[...N,{key:"PERCENTAGE_INTEREST",description:"Lender's percentage interest (e.g., 75.00)"},{key:"HAS_CFL",description:"True if has CFL license"},{key:"CFL_LICENSE",description:"CFL license number"},{key:"HAS_DRE",description:"True if has DRE license"},{key:"DRE_LICENSE",description:"DRE license number"},{key:"LICENSE",description:"Primary license number (CFL or DRE)"},{key:"CLOSING_CONTACT",description:"Closing contact name"},{key:"CLOSING_CONTACT_EMAIL",description:"Closing contact email"}]},{key:"GUARANTORS",description:"All guarantors on the loan",category:"Parties",itemFields:[...N,{key:"AKA_NAMES",description:"Also-known-as names"},{key:"GUARANTOR_NAME",description:"Guarantor name (alias)"},{key:"GUARANTOR_AKA_NAME",description:"Guarantor AKA names"},{key:"GUARANTOR_NAME_NOT_IN_ALL_SIGNERS",description:"True if guarantor isn't already a borrower signer"}]},{key:"BROKERS",description:"All brokers on the loan",category:"Parties",itemFields:[{key:"NAME",description:"Broker name"},{key:"ENTITY_TYPE",description:"Individual, Entity, or Trust"},{key:"ENTITY_STRUCTURE",description:"LLC, Corporation, etc."},{key:"STATE_OF_FORMATION",description:"State of organization"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"FULL_ADDRESS",description:"Formatted full address"},{key:"LICENSE_TYPE",description:"License type (CFL, DRE, etc.)"},{key:"LICENSE",description:"License number"},{key:"FEE",description:"Broker fee"}]},{key:"PROPERTIES",description:"All collateral properties",category:"Properties",itemFields:[{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"STATE_UPPER",description:"State (uppercase)"},{key:"FULL_ADDRESS",description:"Formatted full address"},{key:"PROPERTY_TYPE",description:"Property type (Single Family, etc.)"},{key:"PARCEL_NUMBER",description:"Parcel/APN number"},{key:"IS_DOT",description:"True if Deed of Trust state"},{key:"SECURITY_TYPE",description:'"Deed of Trust" or "Mortgage"'},{key:"REQUIRES_WITNESSES",description:"True if witness-required state"},{key:"LIEN",description:"Lien position (first, second, etc.)"},{key:"LIEN_LOWER",description:"Lien position lowercase"},{key:"ORDINAL",description:"Position ordinal (1st, 2nd, 3rd)"},{key:"PARTIAL_RELEASE_AMOUNT",description:"Partial release amount"},{key:"OWNER",description:"Property owner name"},{key:"OWNER_ENTITY_TYPE",description:"Owner entity type"},{key:"OWNER_STATE_ORG",description:"Owner state of organization"},{key:"DESCRIPTION",description:"Legal description"},{key:"TITLE_ORDER_NUMBER",description:"Title order number"},{key:"TITLE_EFFECTIVE_DATE",description:"Title effective date"}]},{key:"DOT_PROPERTIES",description:"Properties in Deed of Trust states only",category:"Properties",itemFields:[{key:"(same as PROPERTIES)",description:"Same fields as PROPERTIES collection"}]},{key:"MORTGAGE_PROPERTIES",description:"Properties in Mortgage states only",category:"Properties",itemFields:[{key:"(same as PROPERTIES)",description:"Same fields as PROPERTIES collection"}]},{key:"FEES",description:"All fees (lender, broker, and other)",category:"Fees",itemFields:[{key:"DESCRIPTION",description:"Fee type/description"},{key:"AMOUNT",description:"Fee amount (cleaned numeric)"},{key:"OWED_TO",description:"Fee recipient"},{key:"NOTES",description:"Additional notes"},{key:"CATEGORY",description:"Lender, Broker, or Other"}]},{key:"LENDER_FEES",description:"Lender fees only",category:"Fees",itemFields:[{key:"(same as FEES)",description:"Same fields as FEES collection"}]},{key:"BROKER_FEES",description:"Broker fees only",category:"Fees",itemFields:[{key:"(same as FEES)",description:"Same fields as FEES collection"}]},{key:"OTHER_FEES",description:"Other fees only",category:"Fees",itemFields:[{key:"(same as FEES)",description:"Same fields as FEES collection"}]},{key:"PARTIAL_RELEASES",description:"Properties with partial release amounts",category:"Other",itemFields:[{key:"PROPERTY",description:"Property address"},{key:"AMOUNT",description:"Release amount"},{key:"RELEASE_AMOUNT",description:"Release amount (alias)"}]},{key:"ASSIGNEES",description:"Loan assignees",category:"Other",itemFields:[{key:"NAME",description:"Assignee name"},{key:"ENTITY_TYPE",description:"Entity type"},{key:"ENTITY_STRUCTURE",description:"Entity structure"},{key:"STATE_OF_FORMATION",description:"State of organization"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"FULL_ADDRESS",description:"Formatted full address"}]},{key:"ENTITY_OWNERS",description:"Owners of the borrowing entity",category:"Other",itemFields:[{key:"NAME",description:"Owner name"},{key:"FIRST_NAME",description:"First name"},{key:"LAST_NAME",description:"Last name"},{key:"ENTITY_TYPE",description:"Entity type"},{key:"ENTITY_STRUCTURE",description:"Entity structure"},{key:"STATE_OF_FORMATION",description:"State of formation"},{key:"ABBREVIATION",description:"Owner abbreviation"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"}]},{key:"SIGNATURE_BLOCKS",description:"Signature blocks for all borrowers",category:"Signatures",itemFields:[{key:"TYPE",description:'"individual" or "entity"'},{key:"NAME",description:"Individual signer name"},{key:"LINE_LABEL",description:"Signature line label text"},{key:"ENTITY_NAME",description:"Entity name (for entity signers)"},{key:"SIGNER_NAME",description:"Authorized signer name"},{key:"SIGNER_TITLE",description:"Signer title"}]},{key:"BORROWER_SIGNERS",description:"Authorized signers for all borrowers",category:"Signatures",itemFields:[{key:"SIGNER_NAME",description:"Signer full name"},{key:"SIGNER_TITLE",description:"Signer title"},{key:"ENTITY_NAME",description:"Entity being signed for"},{key:"ENTITY_TYPE",description:"Entity type"}]},{key:"LENDER_SIGNERS",description:"Authorized signers for all lenders",category:"Signatures",itemFields:[{key:"SIGNER_NAME",description:"Signer full name"},{key:"SIGNER_TITLE",description:"Signer title"},{key:"ENTITY_NAME",description:"Entity being signed for"}]},{key:"GUARANTOR_SIGNERS",description:"Authorized signers for all guarantors",category:"Signatures",itemFields:[{key:"SIGNER_NAME",description:"Signer full name"},{key:"SIGNER_TITLE",description:"Signer title"},{key:"ENTITY_NAME",description:"Entity being signed for"},{key:"AKA_NAME",description:"Guarantor AKA names"}]}],I=(new Set(O.map(e=>e.category)),new Set(O.map(e=>e.key)),"https://app.automateloandocs.com");function x(){try{return localStorage.getItem("ald_api_url")||I}catch{return I}}let P=null,C=null,h=null;const L=[{suffix:"CURRENCY",description:"US dollar format",example:"$850,000.00",applicableTo:["money","number"]},{suffix:"WORDS",description:"Number in English words",example:"Eight Hundred Fifty Thousand and 00/100",applicableTo:["money","number"]},{suffix:"CENTS",description:"Cents portion only",example:"00",applicableTo:["money","number"]},{suffix:"UPPER",description:"UPPERCASE text",example:"JOHN DOE",applicableTo:["text"]},{suffix:"LOWER",description:"lowercase text",example:"john doe",applicableTo:["text"]},{suffix:"DECIMAL2",description:"Two decimal places",example:"12.50",applicableTo:["rate","number"]},{suffix:"DECIMAL3",description:"Three decimal places",example:"12.500",applicableTo:["rate","number"]},{suffix:"LONGDATE",description:"Full date format",example:"January 15, 2026",applicableTo:["date"]},{suffix:"SHORTDATE",description:"Short date format",example:"01/15/2026",applicableTo:["date"]},{suffix:"PERCENT",description:"Percentage with % sign",example:"12.50%",applicableTo:["rate","number"]}];function b(e,t){if(!t.trim())return e;const n=t.toLowerCase();return e.filter(e=>e.key.toLowerCase().includes(n)||e.description.toLowerCase().includes(n))}async function F(e){await Word.run(async t=>{t.document.getSelection().insertText(e,Word.InsertLocation.replace),await t.sync()})}async function v(e){let t=!1;return await Word.run(async n=>{const r=n.document.body.search(e,{matchCase:!1});r.load("items"),await n.sync(),r.items.length>0&&(r.items[0].select(),t=!0),await n.sync()}),t}function D(e,t,...n){const r=document.createElement(e);return t?.cls&&(r.className=t.cls),t?.attrs&&Object.entries(t.attrs).forEach(([e,t])=>r.setAttribute(e,t)),t?.text&&(r.textContent=t.text),t?.html&&(r.innerHTML=t.html),n.forEach(e=>{"string"==typeof e?r.appendChild(document.createTextNode(e)):r.appendChild(e)}),r}function w(e,t,n){e.addEventListener("click",r=>{const o=r.target.closest(t);o&&e.contains(o)&&n(o,r)})}L.map(e=>e.suffix);let M,U,Y="",H=k;function G(e){M=e,w(M,".field-item",(e,t)=>{if(t.target.closest(".format-picker"))return;const n=e.getAttribute("data-key"),r=M.querySelector(`.format-picker[data-for="${n}"]`);r&&(M.querySelectorAll(".format-picker.open").forEach(e=>{e!==r&&e.classList.remove("open")}),r.classList.contains("open")?r.classList.remove("open"):r.querySelectorAll(".format-btn").length<=1?$(n,""):r.classList.add("open"))}),w(M,".format-btn",e=>{const t=e.closest(".format-picker");$(t?.getAttribute("data-for")??"",e.getAttribute("data-fmt")??""),t?.classList.remove("open")}),B(),async function(){if(C)return C;try{const e=await fetch(`${x()}/api/catalog/fields`);if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();return C=t.flatMap(e=>e.items.map(t=>({key:t.key,description:t.description,category:e.category,dataType:t.dataType,suggestedFormats:t.formats}))),C}catch{return C=k,C}}().then(e=>{e!==H&&(H=e,B())})}function W(e){Y=e,B()}function B(){M.innerHTML="";const e=b(H,Y),t=new Map;for(const n of e){const e=t.get(n.category)??[];e.push(n),t.set(n.category,e)}if(0!==t.size)for(const[e,n]of t){const t=D("div",{cls:"category"+(Y.length>0?" open":"")}),r=D("div",{cls:"category-header"});r.innerHTML=`<span class="arrow">&#9654;</span> ${e} <span class="count">${n.length}</span>`,r.addEventListener("click",()=>t.classList.toggle("open"));const o=D("div",{cls:"category-body"});for(const e of n){const t=D("div",{cls:"field-item",attrs:{"data-key":e.key}});t.innerHTML=`<span class="field-key">${e.key}</span><span class="field-desc">${e.description}</span>`;const n=D("div",{cls:"format-picker",attrs:{"data-for":e.key}}),r=D("button",{cls:"format-btn",text:"Plain",attrs:{"data-fmt":""}});n.appendChild(r);for(const t of e.suggestedFormats){const e=L.find(e=>e.suffix===t),r=D("button",{cls:"format-btn",text:t,attrs:{"data-fmt":t,title:e?.example??""}});n.appendChild(r)}o.appendChild(t),o.appendChild(n)}t.appendChild(r),t.appendChild(o),M.appendChild(t)}else M.appendChild(D("div",{cls:"field-desc",text:"No fields match your search."}))}async function $(e,t){const n=t?`{{${e}:${t}}}`:`{{${e}}}`;try{await F(n),z(`Inserted ${n}`)}catch{z("Place cursor in document first")}}function z(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}let V,K="",Z=A;async function X(e,t){let n="";switch(t){case"block-if":n=`{{#IF ${e}}}\n\n{{/IF}}`;break;case"block-else":n=`{{#IF ${e}}}\n\n{{#ELSE}}\n\n{{/IF}}`;break;case"inline-if":n=`{{#IF ${e}}}text here{{/IF}}`;break;case"unless":n=`{{#UNLESS ${e}}}\n\n{{/IF}}`}if(n)try{await F(n),Q(`Inserted ${t.toUpperCase()} ${e}`)}catch{Q("Place cursor in document first")}}function q(e){U=e,w(U,".condition-item",e=>{const t=e.getAttribute("data-key"),n=U.querySelector(`.condition-actions[data-for="${t}"]`);n&&(U.querySelectorAll(".condition-actions.open").forEach(e=>{e!==n&&e.classList.remove("open")}),n.classList.toggle("open"))}),w(U,".action-btn",async e=>{const t=e.closest(".condition-actions"),n=t?.getAttribute("data-for")??"",r=e.getAttribute("data-action")??"";"and"===r||"or"===r?await async function(e,t){try{await F(` ${t} `),Q(`Inserted ${t} after ${e}`)}catch{Q("Place cursor in document first")}}(n,r.toUpperCase()):await X(n,r),t?.classList.remove("open")}),w(U,".custom-action-btn",async e=>{const t=U.querySelector("#custom-condition-input"),n=t?.value.trim().toUpperCase().replace(/\s+/g,"_")??"";if(!n)return void Q("Enter a condition name first");const r=e.getAttribute("data-action")??"";await X(n,r)}),w(U,".comparison-insert-btn",async()=>{const e=U.querySelector("#comparison-field")?.value.trim().toUpperCase().replace(/\s+/g,"_"),t=U.querySelector("#comparison-op")?.value,n=U.querySelector("#comparison-value")?.value.trim();if(!e)return void Q("Enter a field name");if(!n)return void Q("Enter a comparison value");const r=isNaN(Number(n))?`"${n}"`:n;await async function(e,t,n){const r=`${e} ${t} ${n}`;try{await F(`{{#IF ${r}}}\n\n{{/IF}}`),Q(`Inserted comparison: ${r}`)}catch{Q("Place cursor in document first")}}(e,t,r)}),J(),async function(){if(P)return P;try{const e=await fetch(`${x()}/api/catalog/conditions`);if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();return P=t.flatMap(e=>e.items.map(t=>({key:t.key,description:t.description,category:e.category}))),P}catch{return P=A,P}}().then(e=>{e!==Z&&(Z=e,J())})}function j(e){K=e,J()}function J(){U.innerHTML="";const e=D("div",{cls:"custom-condition-box"});e.innerHTML='\n    <div class="custom-condition-label">Insert custom condition</div>\n    <input id="custom-condition-input" type="text" class="custom-condition-input"\n           placeholder="e.g. MY_CONDITION" spellcheck="false" autocomplete="off" />\n    <div class="custom-condition-actions">\n      <button class="custom-action-btn" data-action="block-if">Block IF</button>\n      <button class="custom-action-btn" data-action="block-else">IF / ELSE</button>\n      <button class="custom-action-btn" data-action="inline-if">Inline IF</button>\n      <button class="custom-action-btn" data-action="unless">UNLESS</button>\n    </div>\n  ',U.appendChild(e);const t=D("div",{cls:"custom-condition-box"});t.innerHTML='\n    <div class="custom-condition-label">Insert field comparison</div>\n    <div style="display:flex; gap:4px; margin-bottom:4px;">\n      <input id="comparison-field" type="text" class="custom-condition-input"\n             placeholder="FIELD_NAME" spellcheck="false" autocomplete="off" style="flex:2;" />\n      <select id="comparison-op" class="custom-condition-input" style="flex:1; min-width:50px;">\n        <option value="==">=</option>\n        <option value="!=">!=</option>\n        <option value=">">&gt;</option>\n        <option value=">=">&gt;=</option>\n        <option value="<">&lt;</option>\n        <option value="<=">&lt;=</option>\n        <option value="IN">IN</option>\n      </select>\n      <input id="comparison-value" type="text" class="custom-condition-input"\n             placeholder="value" spellcheck="false" autocomplete="off" style="flex:2;" />\n    </div>\n    <button class="comparison-insert-btn custom-action-btn" style="width:100%;">Insert Comparison</button>\n  ',U.appendChild(t);const n=b(Z,K),r=new Map;for(const e of n){const t=r.get(e.category)??[];t.push(e),r.set(e.category,t)}if(0===r.size){const e=D("div",{cls:"field-desc",text:"No conditions match your search."});return e.style.padding="8px",void U.appendChild(e)}for(const[e,t]of r){const n=D("div",{cls:"category"+(K.length>0?" open":"")}),r=D("div",{cls:"category-header"});r.innerHTML=`<span class="arrow">&#9654;</span> ${e} <span class="count">${t.length}</span>`,r.addEventListener("click",()=>n.classList.toggle("open"));const o=D("div",{cls:"category-body"});for(const e of t){const t=D("div",{cls:"condition-item",attrs:{"data-key":e.key}});t.innerHTML=`<span class="field-key">${e.key}</span><span class="field-desc" style="margin-left:6px;">${e.description}</span>`;const n=D("div",{cls:"condition-actions",attrs:{"data-for":e.key}});n.innerHTML='\n        <button class="action-btn" data-action="block-if">Block IF</button>\n        <button class="action-btn" data-action="block-else">IF / ELSE</button>\n        <button class="action-btn" data-action="inline-if">Inline IF</button>\n        <button class="action-btn" data-action="unless">UNLESS</button>\n        <button class="action-btn compound-btn" data-action="and">+ AND</button>\n        <button class="action-btn compound-btn" data-action="or">+ OR</button>\n      ',o.appendChild(t),o.appendChild(n)}n.appendChild(r),n.appendChild(o),U.appendChild(n)}}function Q(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}let ee,te="",ne=O;function re(e){V=e,w(V,".action-btn[data-col]",async e=>{const t=e.getAttribute("data-col")??"",n="row"===(e.getAttribute("data-type")??"")?"ROW":"EACH",r=`{{#${n} ${t}}}\n\n{{/${n} ${t}}}`;try{await F(r),se(`Inserted ${n} ${t}`)}catch{se("Place cursor in document first")}}),w(V,".item-field",async e=>{const t=`{{ITEM.${e.getAttribute("data-item")??""}}}`;try{await F(t),se(`Inserted ${t}`)}catch{se("Place cursor in document first")}}),ae(),async function(){if(h)return h;try{const e=await fetch(`${x()}/api/catalog/collections`);if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();return h=t.flatMap(e=>e.items.map(t=>({key:t.key,description:t.description,category:e.category,itemFields:t.itemFields}))),h}catch{return h=O,h}}().then(e=>{e!==ne&&(ne=e,ae())})}function oe(e){te=e,ae()}function ae(){V.innerHTML="";const e=te.toLowerCase(),t=e?ne.filter(t=>t.key.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.itemFields.some(t=>t.key.toLowerCase().includes(e)||t.description.toLowerCase().includes(e))):ne;if(0===t.length)return void V.appendChild(D("div",{cls:"field-desc",text:"No collections match your search."}));const n=D("div",{cls:"ref-section",html:'<div style="font-size:10px; color:#8E949A; padding:4px 4px 8px;">\n      All loops include: <code style="font-family:var(--mono);">ITEM.INDEX</code>,\n      <code style="font-family:var(--mono);">ITEM.IS_FIRST</code>,\n      <code style="font-family:var(--mono);">ITEM.IS_LAST</code>,\n      <code style="font-family:var(--mono);">ITEM.COUNT</code>,\n      <code style="font-family:var(--mono);">ITEM.SEPARATOR</code>\n    </div>'});V.appendChild(n);for(const e of t){const t=D("div",{cls:"collection-card"+(te?" open":"")}),n=D("div",{cls:"collection-header",attrs:{"data-key":e.key}});n.innerHTML=`<span>${e.key} <span style="font-weight:400; color:#8E949A; font-size:10px;">(${e.itemFields.length} fields)</span></span><span class="arrow">&#9654;</span>`,n.addEventListener("click",()=>t.classList.toggle("open"));const r=D("div",{cls:"collection-body"});r.appendChild(D("div",{cls:"collection-desc",text:e.description}));const o=D("div",{cls:"insert-btns"}),a=D("button",{cls:"action-btn",text:"Block EACH",attrs:{"data-col":e.key,"data-type":"each"}}),s=D("button",{cls:"action-btn",text:"Table ROW",attrs:{"data-col":e.key,"data-type":"row"}});o.appendChild(a),o.appendChild(s),r.appendChild(o);for(const t of e.itemFields){const e=D("div",{cls:"item-field",attrs:{"data-item":t.key}});e.innerHTML=`<span class="field-key" style="font-size:10px;">ITEM.${t.key}</span><span class="field-desc">${t.description}</span>`,r.appendChild(e)}t.appendChild(n),t.appendChild(r),V.appendChild(t)}}function se(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}const ie=new Set(k.map(e=>e.key.toUpperCase())),ce=new Set(A.map(e=>e.key.toUpperCase())),de=new Set(O.map(e=>e.key.toUpperCase())),pe=new Set(L.map(e=>e.suffix.toUpperCase())),ye=new Set;for(const e of O)for(const t of e.itemFields)ye.add(t.key.toUpperCase());function le(e){ee=e,function(){ee.innerHTML="";const e=D("button",{cls:"validate-btn",text:"Scan Document"});e.addEventListener("click",me),ee.appendChild(e),ee.appendChild(D("div",{cls:"field-desc",html:"Click <strong>Scan Document</strong> to find all placeholders and check for errors."}))}()}function ge(e){}async function me(){ee.innerHTML="";const e=D("div",{cls:"field-desc",text:"Scanning document..."});ee.appendChild(e);try{const e=(await async function(){const e=[];return await Word.run(async t=>{const n=t.document.body.paragraphs;n.load("text"),await t.sync();for(let t=0;t<n.items.length;t++)e.push(n.items[t].text)}),e}()).join("\n"),t=[];let n=0,r=0,o=0;const a=/\{\{([^}]+)\}\}/g;let s;const i=[];for(;null!==(s=a.exec(e));){const e=s[1].trim();if(e.startsWith("#IF ")||e.startsWith("#UNLESS ")){const n=e.replace(/^#(IF|UNLESS)\s+/,"").trim();i.push({type:e.startsWith("#UNLESS")?"UNLESS":"IF",key:n}),r++,ce.has(n.toUpperCase())||n.startsWith("ITEM.")||t.push({type:"warning",message:`Unknown condition: ${n}`,detail:s[0]})}else if(e.startsWith("/IF ")||"/IF"===e){const n=e.replace(/^\/IF\s*/,"").trim();i.length>0?i.pop():t.push({type:"error",message:`Unmatched closing: {{/IF ${n}}}`,detail:s[0]})}else if(e.startsWith("#EACH ")||e.startsWith("#ROW ")){const n=e.replace(/^#(EACH|ROW)\s+/,"").trim();i.push({type:e.startsWith("#ROW")?"ROW":"EACH",key:n}),o++,de.has(n.toUpperCase())||t.push({type:"warning",message:`Unknown collection: ${n}`,detail:s[0]})}else if(e.startsWith("/EACH ")||e.startsWith("/ROW "))if(i.length>0)i.pop();else{const n=e.replace(/^\/(EACH|ROW)\s*/,"").trim();t.push({type:"error",message:`Unmatched closing: ${s[0]}`,detail:`No open block for ${n}`})}else if(e.startsWith("ITEM.")||e.startsWith("item.")){const r=e.replace(/^item\./i,"").split(":")[0].trim().toUpperCase();n++,ye.has(r)||t.push({type:"warning",message:`Unknown item field: ITEM.${r}`,detail:s[0]})}else if(!e.startsWith("#")&&!e.startsWith("/")){n++;const r=e.split(":"),o=r[0].trim().toUpperCase(),a=r[1]?.trim().toUpperCase();ie.has(o)||ce.has(o)||t.push({type:"warning",message:`Unknown field: ${o}`,detail:s[0]}),a&&!pe.has(a)&&t.push({type:"warning",message:`Unknown format: ${a}`,detail:s[0]})}}for(const e of i)t.push({type:"error",message:`Unclosed ${e.type} block: ${e.key}`,detail:`Missing {{/${"UNLESS"===e.type?"IF":e.type} ${e.key}}}`});ee.innerHTML="";const c=D("button",{cls:"validate-btn",text:"Re-scan Document"});c.addEventListener("click",me),ee.appendChild(c);const d=t.filter(e=>"error"===e.type).length,p=t.filter(e=>"warning"===e.type).length,y=d>0?"errors":"success",l=0===d&&0===p?`${n} fields, ${r} conditions, ${o} loops — No issues found`:`${n} fields, ${r} conditions, ${o} loops — ${d} error${1!==d?"s":""}, ${p} warning${1!==p?"s":""}`;ee.appendChild(D("div",{cls:`validate-summary ${y}`,text:l}));for(const e of t){const t=D("div",{cls:"issue-card"});t.innerHTML=`\n        <div class="issue-type ${e.type}">${e.type}</div>\n        <div class="issue-text">${e.message}</div>\n        <div class="issue-detail">${e.detail}</div>\n      `,t.addEventListener("click",async()=>{Te(await v(e.detail)?`Navigated to: ${e.detail}`:"Could not locate in document")}),ee.appendChild(t)}Te(`Scan complete: ${n} fields, ${t.length} issues`)}catch(e){ee.innerHTML="",ee.appendChild(D("div",{cls:"validate-summary errors",text:`Error scanning: ${e}`}))}}function Te(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}let Ee;function ue(e){Ee=e,function(){Ee.innerHTML="";const e=D("div",{cls:"ref-section"});e.innerHTML='\n    <h3>Placeholder Syntax</h3>\n    <div class="ref-row"><span class="ref-syntax">{{FIELD}}</span><span class="ref-explain">Simple field replacement</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{FIELD:FORMAT}}</span><span class="ref-explain">Formatted field (e.g., :CURRENCY, :WORDS)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF FLAG}}</span><span class="ref-explain">Start conditional block</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{/IF FLAG}}</span><span class="ref-explain">End conditional block</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#UNLESS FLAG}}</span><span class="ref-explain">Negated conditional (show when false)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#ELSE}}</span><span class="ref-explain">Else branch inside IF block</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#EACH COLL}}</span><span class="ref-explain">Loop over collection (paragraph-level)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{/EACH COLL}}</span><span class="ref-explain">End loop</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#ROW COLL}}</span><span class="ref-explain">Loop table rows</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{ITEM.FIELD}}</span><span class="ref-explain">Field inside a loop</span></div>\n  ',Ee.appendChild(e);const t=D("div",{cls:"ref-section"});let n="<h3>Format Specifiers</h3>";for(const e of L)n+=`<div class="ref-row"><span class="ref-syntax">:${e.suffix}</span><span class="ref-explain">${e.description} &mdash; <em>${e.example}</em></span></div>`;t.innerHTML=n,Ee.appendChild(t);const r=D("div",{cls:"ref-section"});r.innerHTML='\n    <h3>Tips</h3>\n    <div class="ref-row"><span class="ref-explain"><strong>Case-insensitive</strong> &mdash; {{loan_amount}}, {{LOAN_AMOUNT}}, {{Loan_Amount}} all work</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Whitespace-tolerant</strong> &mdash; {{ FIELD }} and {{FIELD}} both work</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Block vs Inline IF</strong> &mdash; If opening and closing tags are in the <em>same</em> paragraph, only text between them is toggled. If in <em>different</em> paragraphs, entire paragraphs are removed.</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Split runs</strong> &mdash; Word may split {{FIELD}} across multiple XML runs. The engine normalizes this automatically.</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Content Controls</strong> &mdash; You can also use Word Content Controls with a Tag matching the field name.</span></div>\n  ',Ee.appendChild(r);const o=D("div",{cls:"ref-section"});o.innerHTML='\n    <h3>Loop Meta Fields</h3>\n    <div class="ref-row"><span class="ref-syntax">ITEM.INDEX</span><span class="ref-explain">1-based position (1, 2, 3...)</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.IS_FIRST</span><span class="ref-explain">"true" for the first item</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.IS_LAST</span><span class="ref-explain">"true" for the last item</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.COUNT</span><span class="ref-explain">Total items in collection</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.SEPARATOR</span><span class="ref-explain">Smart comma+and: "A, B, and C"</span></div>\n  ',Ee.appendChild(o)}()}function Re(e){}["INDEX","IS_FIRST","IS_LAST","COUNT","SEPARATOR"].forEach(e=>ye.add(e));const fe={fields:r,conditions:o,loops:a,validate:s,reference:i};let Se="fields",_e=null;function ke(e){Se=e,document.querySelectorAll("#tab-bar .tab").forEach(t=>{t.classList.toggle("active",t.getAttribute("data-tab")===e)}),document.querySelectorAll(".tab-panel").forEach(t=>{t.classList.toggle("active",t.id===`tab-${e}`)});const t=document.getElementById("search-input");t&&t.value&&(t.value="",fe[e]?.search(""))}Office.onReady(e=>{e.host===Office.HostType.Word&&function(){const e=document.getElementById("tab-bar");e&&e.addEventListener("click",e=>{const t=e.target.closest("[data-tab]");if(!t)return;const n=t.getAttribute("data-tab");n&&n!==Se&&ke(n)});const t=document.getElementById("search-input");t&&t.addEventListener("input",()=>{_e&&clearTimeout(_e),_e=setTimeout(()=>{const e=t.value.trim();fe[Se]?.search(e)},200)});for(const[e,t]of Object.entries(fe)){const n=document.getElementById(`tab-${e}`);n&&t.init(n)}ke("fields"),function(){const e=document.getElementById("status-text");e&&(e.textContent="Ready — click a field to insert")}()}()})})();