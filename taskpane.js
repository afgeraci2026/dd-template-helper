(()=>{"use strict";var e={942(e,t,n){n.d(t,{A:()=>s});var r=n(601),a=n.n(r),o=n(314),i=n.n(o)()(a());i.push([e.id,'/* ══════════════════════════════════════════════════════════\n   Automate Loan Docs Template Helper — Taskpane Styles\n   Brand: Midnight Slate, Steel Blue, Paper White\n   ══════════════════════════════════════════════════════════ */\n\n:root {\n  --midnight: #0F1720;\n  --steel: #2C3F52;\n  --gunmetal: #8E949A;\n  --chrome: #C7CCD1;\n  --charcoal: #1C1F23;\n  --graphite: #3A3F45;\n  --paper: #F5F7FA;\n  --cta: #223447;\n  --cta-hover: #3E566E;\n  --mono: "Consolas", "IBM Plex Mono", monospace;\n  --sans: "Segoe UI", "Inter", sans-serif;\n}\n\n* { margin: 0; padding: 0; box-sizing: border-box; }\n\nhtml, body {\n  height: 100%;\n  font-family: var(--sans);\n  font-size: 12px;\n  color: var(--charcoal);\n  background: var(--paper);\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n/* ── Header ────────────────────────────────────────────── */\n#header {\n  background: var(--midnight);\n  padding: 10px 12px;\n  flex-shrink: 0;\n}\n\n.header-brand {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.header-logo {\n  background: var(--steel);\n  color: white;\n  font-weight: 800;\n  font-size: 11px;\n  width: 24px;\n  height: 24px;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.header-title {\n  color: white;\n  font-weight: 600;\n  font-size: 13px;\n}\n\n/* ── Search ────────────────────────────────────────────── */\n#search-bar {\n  padding: 8px 12px;\n  background: white;\n  border-bottom: 1px solid var(--chrome);\n  flex-shrink: 0;\n}\n\n#search-input {\n  width: 100%;\n  padding: 6px 10px;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  font-size: 12px;\n  font-family: var(--sans);\n  outline: none;\n  background: var(--paper);\n}\n\n#search-input:focus {\n  border-color: var(--cta);\n}\n\n/* ── Tab Bar ───────────────────────────────────────────── */\n#tab-bar {\n  display: flex;\n  background: var(--steel);\n  flex-shrink: 0;\n}\n\n.tab {\n  flex: 1;\n  padding: 7px 4px;\n  background: none;\n  border: none;\n  border-bottom: 2px solid transparent;\n  color: rgba(255,255,255,0.6);\n  font-size: 10px;\n  font-weight: 600;\n  font-family: var(--sans);\n  cursor: pointer;\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  transition: all 0.15s;\n}\n\n.tab:hover {\n  color: rgba(255,255,255,0.85);\n}\n\n.tab.active {\n  color: white;\n  border-bottom-color: white;\n}\n\n/* ── Tab Content ───────────────────────────────────────── */\n#tab-content {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n.tab-panel {\n  display: none;\n  padding: 8px;\n}\n\n.tab-panel.active {\n  display: block;\n}\n\n/* ── Accordion Category ────────────────────────────────── */\n.category {\n  margin-bottom: 4px;\n}\n\n.category-header {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 8px;\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 11px;\n  font-weight: 600;\n  color: var(--steel);\n  user-select: none;\n  transition: background 0.1s;\n}\n\n.category-header:hover {\n  background: var(--paper);\n}\n\n.category-header .arrow {\n  font-size: 8px;\n  transition: transform 0.15s;\n  color: var(--gunmetal);\n}\n\n.category.open .category-header .arrow {\n  transform: rotate(90deg);\n}\n\n.category-header .count {\n  margin-left: auto;\n  background: var(--paper);\n  color: var(--gunmetal);\n  padding: 1px 5px;\n  border-radius: 8px;\n  font-size: 9px;\n  font-weight: 700;\n}\n\n.category-body {\n  display: none;\n  padding: 2px 0;\n}\n\n.category.open .category-body {\n  display: block;\n}\n\n/* ── Field Item ────────────────────────────────────────── */\n.field-item {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 5px 8px 5px 20px;\n  cursor: pointer;\n  border-radius: 3px;\n  transition: background 0.1s;\n}\n\n.field-item:hover {\n  background: rgba(34, 52, 71, 0.06);\n}\n\n.field-key {\n  font-family: var(--mono);\n  font-size: 10.5px;\n  font-weight: 600;\n  color: var(--cta);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 170px;\n}\n\n.field-desc {\n  font-size: 10px;\n  color: var(--gunmetal);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  flex: 1;\n}\n\n/* ── Format Picker (inline) ────────────────────────────── */\n.format-picker {\n  display: none;\n  padding: 4px 20px 8px;\n  gap: 4px;\n  flex-wrap: wrap;\n}\n\n.format-picker.open {\n  display: flex;\n}\n\n.format-btn {\n  padding: 2px 8px;\n  font-size: 9px;\n  font-family: var(--mono);\n  font-weight: 600;\n  background: var(--paper);\n  border: 1px solid var(--chrome);\n  border-radius: 3px;\n  cursor: pointer;\n  color: var(--steel);\n  transition: all 0.1s;\n}\n\n.format-btn:hover {\n  background: var(--cta);\n  color: white;\n  border-color: var(--cta);\n}\n\n/* ── Unified Condition Builder ─────────────────────────── */\n.builder-box {\n  background: white;\n  border: 1px solid var(--steel);\n  border-radius: 6px;\n  padding: 8px 10px;\n  margin-bottom: 8px;\n}\n\n.builder-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 6px;\n}\n\n.builder-label {\n  font-size: 10px;\n  font-weight: 700;\n  color: var(--steel);\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n}\n\n.builder-clear-btn {\n  padding: 2px 8px;\n  font-size: 9px;\n  font-weight: 600;\n  font-family: var(--sans);\n  background: white;\n  border: 1px solid #dc2626;\n  border-radius: 3px;\n  color: #dc2626;\n  cursor: pointer;\n  transition: all 0.1s;\n}\n\n.builder-clear-btn:hover {\n  background: #dc2626;\n  color: white;\n}\n\n.builder-empty {\n  font-size: 10px;\n  color: var(--gunmetal);\n  padding: 4px 0 2px;\n}\n\n.builder-parts {\n  padding: 4px 0;\n}\n\n.builder-chip {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  padding: 3px 6px 3px 8px;\n  background: var(--paper);\n  border: 1px solid var(--chrome);\n  border-radius: 12px;\n  font-family: var(--mono);\n  font-size: 10.5px;\n  font-weight: 600;\n  color: var(--cta);\n  max-width: 100%;\n  margin-bottom: 2px;\n}\n\n.chip-text {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.chip-remove {\n  background: none;\n  border: none;\n  font-size: 13px;\n  font-weight: 700;\n  color: var(--gunmetal);\n  cursor: pointer;\n  padding: 0 2px;\n  line-height: 1;\n  flex-shrink: 0;\n}\n\n.chip-remove:hover {\n  color: #dc2626;\n}\n\n.builder-join-toggle {\n  display: block;\n  margin: 3px auto;\n  padding: 1px 12px;\n  font-size: 9px;\n  font-weight: 700;\n  font-family: var(--sans);\n  background: var(--steel);\n  color: white;\n  border: none;\n  border-radius: 10px;\n  cursor: pointer;\n  letter-spacing: 0.5px;\n  transition: background 0.1s;\n}\n\n.builder-join-toggle:hover {\n  background: var(--cta-hover);\n}\n\n.builder-preview {\n  font-family: var(--mono);\n  font-size: 10px;\n  font-weight: 600;\n  color: var(--cta);\n  background: var(--paper);\n  border: 1px solid var(--chrome);\n  border-radius: 3px;\n  padding: 6px 8px;\n  margin: 6px 0;\n  word-break: break-all;\n  white-space: pre-wrap;\n}\n\n.builder-insert-actions {\n  display: flex;\n  gap: 4px;\n  flex-wrap: wrap;\n}\n\n.builder-insert-btn {\n  padding: 3px 8px;\n  font-size: 10px;\n  font-weight: 600;\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 3px;\n  cursor: pointer;\n  color: var(--steel);\n  font-family: var(--sans);\n  transition: all 0.1s;\n}\n\n.builder-insert-btn:hover {\n  background: var(--cta);\n  color: white;\n  border-color: var(--cta);\n}\n\n/* ── Builder Inputs (custom + comparison) ─────────────── */\n.builder-inputs {\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 6px;\n  padding: 8px 10px;\n  margin-bottom: 8px;\n}\n\n.input-row {\n  display: flex;\n  gap: 4px;\n  margin-bottom: 4px;\n}\n\n.input-row:last-child {\n  margin-bottom: 0;\n}\n\n.builder-input {\n  flex: 1;\n  padding: 5px 8px;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  font-size: 11px;\n  font-family: var(--mono);\n  font-weight: 600;\n  color: var(--cta);\n  background: var(--paper);\n  outline: none;\n  text-transform: uppercase;\n}\n\n.builder-input:focus {\n  border-color: var(--cta);\n}\n\n.builder-input::placeholder {\n  text-transform: none;\n  font-weight: 400;\n  color: var(--gunmetal);\n}\n\n.builder-add-btn {\n  flex-shrink: 0;\n  width: 28px;\n  height: 28px;\n  padding: 0;\n  font-size: 16px;\n  font-weight: 700;\n  font-family: var(--sans);\n  background: var(--steel);\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background 0.1s;\n}\n\n.builder-add-btn:hover {\n  background: var(--cta);\n}\n\n/* ── Condition Item ────────────────────────────────────── */\n.condition-item {\n  display: flex;\n  align-items: center;\n  padding: 5px 8px 5px 20px;\n  cursor: pointer;\n  border-radius: 3px;\n  transition: background 0.1s;\n}\n\n.condition-item:hover {\n  background: rgba(34, 52, 71, 0.06);\n}\n\n.condition-item .add-hint {\n  margin-left: auto;\n  font-size: 14px;\n  font-weight: 700;\n  color: var(--chrome);\n  opacity: 0;\n  transition: opacity 0.15s;\n  flex-shrink: 0;\n  padding-left: 4px;\n}\n\n.condition-item:hover .add-hint {\n  opacity: 1;\n  color: var(--steel);\n}\n\n/* ── Catalog section ──────────────────────────────────── */\n.catalog-section {\n  /* no extra styles needed, just a container */\n}\n\n/* ── Loop / Collection Card ────────────────────────────── */\n.collection-card {\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 6px;\n  margin-bottom: 6px;\n  overflow: hidden;\n}\n\n.collection-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 10px;\n  cursor: pointer;\n  font-weight: 600;\n  font-size: 11px;\n  color: var(--steel);\n}\n\n.collection-header .arrow {\n  font-size: 8px;\n  color: var(--gunmetal);\n  transition: transform 0.15s;\n}\n\n.collection-card.open .collection-header .arrow {\n  transform: rotate(90deg);\n}\n\n.collection-body {\n  display: none;\n  padding: 0 10px 8px;\n}\n\n.collection-card.open .collection-body {\n  display: block;\n}\n\n.collection-desc {\n  font-size: 10px;\n  color: var(--gunmetal);\n  margin-bottom: 6px;\n}\n\n.insert-btns {\n  display: flex;\n  gap: 4px;\n  margin-bottom: 6px;\n}\n\n.item-field {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 3px 6px;\n  cursor: pointer;\n  border-radius: 3px;\n  transition: background 0.1s;\n}\n\n.item-field:hover {\n  background: rgba(34, 52, 71, 0.06);\n}\n\n/* ── Validate Tab ──────────────────────────────────────── */\n.validate-btn {\n  width: 100%;\n  padding: 10px;\n  background: var(--cta);\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 12px;\n  font-weight: 700;\n  font-family: var(--sans);\n  cursor: pointer;\n  margin-bottom: 10px;\n  transition: background 0.15s;\n}\n\n.validate-btn:hover {\n  background: var(--cta-hover);\n}\n\n.validate-summary {\n  padding: 8px 10px;\n  border-radius: 6px;\n  font-size: 11px;\n  font-weight: 600;\n  margin-bottom: 8px;\n}\n\n.validate-summary.success {\n  background: #ecfdf5;\n  color: #065f46;\n  border: 1px solid #a7f3d0;\n}\n\n.validate-summary.errors {\n  background: #fef2f2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n}\n\n.validate-info {\n  padding: 8px 10px;\n  border-radius: 6px;\n  font-size: 11px;\n  margin-bottom: 8px;\n  background: #fffbeb;\n  color: #78350f;\n  border: 1px solid #fde68a;\n  line-height: 1.5;\n}\n\n.issue-card {\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  padding: 6px 8px;\n  margin-bottom: 4px;\n  cursor: pointer;\n  transition: background 0.1s;\n}\n\n.issue-card:hover {\n  background: #fef2f2;\n}\n\n.issue-type {\n  font-size: 9px;\n  font-weight: 700;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  margin-bottom: 2px;\n}\n\n.issue-type.error { color: #dc2626; }\n.issue-type.warning { color: #d97706; }\n\n.issue-text {\n  font-size: 11px;\n  color: var(--charcoal);\n}\n\n.issue-detail {\n  font-size: 10px;\n  color: var(--gunmetal);\n  font-family: var(--mono);\n  margin-top: 2px;\n}\n\n/* ── Reference Tab ─────────────────────────────────────── */\n.ref-section {\n  margin-bottom: 12px;\n}\n\n.ref-section h3 {\n  font-size: 11px;\n  font-weight: 700;\n  color: var(--steel);\n  margin-bottom: 4px;\n  padding-bottom: 2px;\n  border-bottom: 1px solid var(--chrome);\n}\n\n.ref-row {\n  display: flex;\n  padding: 3px 0;\n  font-size: 10.5px;\n}\n\n.ref-syntax {\n  font-family: var(--mono);\n  font-weight: 600;\n  color: var(--cta);\n  min-width: 130px;\n}\n\n.ref-explain {\n  color: var(--graphite);\n  flex: 1;\n}\n\n/* ── Ask AI Tab ────────────────────────────────────────── */\n.ask-section-label {\n  font-size: 10px;\n  font-weight: 700;\n  color: var(--steel);\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  margin-bottom: 6px;\n}\n\n.ask-chips {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 4px;\n  margin-bottom: 10px;\n}\n\n.ask-chip {\n  padding: 4px 10px;\n  font-size: 10px;\n  font-weight: 600;\n  font-family: var(--sans);\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 12px;\n  cursor: pointer;\n  color: var(--steel);\n  transition: all 0.1s;\n}\n\n.ask-chip:hover {\n  background: var(--cta);\n  color: white;\n  border-color: var(--cta);\n}\n\n.ask-input-row {\n  display: flex;\n  gap: 4px;\n  margin-bottom: 10px;\n}\n\n.ask-input {\n  flex: 1;\n  padding: 7px 10px;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  font-size: 12px;\n  font-family: var(--sans);\n  outline: none;\n  background: white;\n}\n\n.ask-input:focus {\n  border-color: var(--cta);\n}\n\n.ask-send-btn {\n  flex-shrink: 0;\n  width: 32px;\n  height: 32px;\n  padding: 0;\n  font-size: 14px;\n  background: var(--cta);\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background 0.1s;\n}\n\n.ask-send-btn:hover {\n  background: var(--cta-hover);\n}\n\n.ask-loading {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px 0;\n  font-size: 11px;\n  color: var(--gunmetal);\n}\n\n.ask-spinner {\n  width: 16px;\n  height: 16px;\n  border: 2px solid var(--chrome);\n  border-top-color: var(--cta);\n  border-radius: 50%;\n  animation: ask-spin 0.6s linear infinite;\n}\n\n@keyframes ask-spin {\n  to { transform: rotate(360deg); }\n}\n\n.ask-answer {\n  font-size: 11px;\n  line-height: 1.6;\n  color: var(--charcoal);\n  padding: 10px 12px;\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 6px;\n  word-break: break-word;\n}\n\n.ask-answer code.ask-code {\n  font-family: var(--mono);\n  font-size: 10.5px;\n  font-weight: 600;\n  background: var(--paper);\n  padding: 1px 4px;\n  border-radius: 3px;\n  color: var(--cta);\n}\n\n.ask-field-chip {\n  display: inline-block;\n  padding: 2px 8px;\n  font-family: var(--mono);\n  font-size: 10.5px;\n  font-weight: 600;\n  background: var(--paper);\n  border: 1px solid var(--cta);\n  border-radius: 12px;\n  color: var(--cta);\n  cursor: pointer;\n  transition: all 0.1s;\n  vertical-align: baseline;\n}\n\n.ask-field-chip:hover {\n  background: var(--cta);\n  color: white;\n}\n\n.ask-error {\n  font-size: 11px;\n  padding: 10px 12px;\n  background: #fef2f2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n  border-radius: 6px;\n}\n\n/* ── Status Bar ────────────────────────────────────────── */\n#status-bar {\n  background: var(--midnight);\n  color: var(--gunmetal);\n  padding: 4px 12px;\n  font-size: 10px;\n  flex-shrink: 0;\n}\n\n/* ── Scrollbar ─────────────────────────────────────────── */\n#tab-content::-webkit-scrollbar { width: 5px; }\n#tab-content::-webkit-scrollbar-track { background: transparent; }\n#tab-content::-webkit-scrollbar-thumb { background: var(--chrome); border-radius: 3px; }\n',""]);const s=i},314(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,a,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var s=0;s<this.length;s++){var d=this[s][0];null!=d&&(i[d]=!0)}for(var c=0;c<e.length;c++){var p=[].concat(e[c]);r&&i[p[0]]||(void 0!==o&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=o),n&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=n):p[2]=n),a&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=a):p[4]="".concat(a)),t.push(p))}},t}},601(e){e.exports=function(e){return e[1]}},72(e){var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},i=[],s=0;s<e.length;s++){var d=e[s],c=r.base?d[0]+r.base:d[0],p=o[c]||0,l="".concat(c," ").concat(p);o[c]=p+1;var y=n(l),g={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==y)t[y].references++,t[y].updater(g);else{var u=a(g,r);r.byIndex=s,t.splice(s,0,{identifier:l,updater:u,references:1})}i.push(l)}return i}function a(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var o=r(e=e||[],a=a||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var s=n(o[i]);t[s].references--}for(var d=r(e,a),c=0;c<o.length;c++){var p=n(o[c]);0===t[p].references&&(t[p].updater(),t.splice(p,1))}o=d}}},659(e){var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56(e,t,n){e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var r={};n.r(r),n.d(r,{init:()=>W,search:()=>$});var a={};n.r(a),n.d(a,{init:()=>ie,search:()=>se});var o={};n.r(o),n.d(o,{init:()=>Te,search:()=>Ee});var i={};n.r(i),n.d(i,{init:()=>Ae,search:()=>xe});var s={};n.r(s),n.d(s,{init:()=>ve,search:()=>Fe});var d={};n.r(d),n.d(d,{init:()=>Me,search:()=>Ue});var c=n(72),p=n.n(c),l=n(825),y=n.n(l),g=n(659),u=n.n(g),T=n(56),E=n.n(T),m=n(540),f=n.n(m),R=n(113),S=n.n(R),k=n(942),_={};_.styleTagTransform=S(),_.setAttributes=E(),_.insert=u().bind(null,"head"),_.domAPI=y(),_.insertStyleElement=f(),p()(k.A,_),k.A&&k.A.locals&&k.A.locals;const I=[{key:"LOAN_AMOUNT",description:"Principal loan amount",category:"Core Loan Terms",dataType:"money",suggestedFormats:["CURRENCY","WORDS","CENTS"]},{key:"INTEREST_RATE",description:"Annual interest rate",category:"Core Loan Terms",dataType:"rate",suggestedFormats:["DECIMAL2","PERCENT","WORDS"]},{key:"DEFAULT_RATE",description:"Default interest rate",category:"Core Loan Terms",dataType:"rate",suggestedFormats:["DECIMAL2","PERCENT","WORDS"]},{key:"TERM_MONTHS",description:"Loan term in months",category:"Core Loan Terms",dataType:"number",suggestedFormats:["WORDS"]},{key:"AMORTIZATION_TYPE",description:"Amortization type (IO, Fully Amortized, etc.)",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"REPAYMENT_SCHEDULE",description:"Payment frequency (Monthly, Quarterly, etc.)",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"LOAN_TYPE",description:"Loan type code (bridge, dscr, construction, etc.)",category:"Core Loan Terms",dataType:"text",suggestedFormats:["UPPER"]},{key:"LOAN_NAME",description:"Loan name/identifier",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"LOAN_NUMBER",description:"Loan number (dedicated field; falls back to loan name if empty)",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"IO_MONTHS",description:"Interest-only period in months",category:"Core Loan Terms",dataType:"number",suggestedFormats:["WORDS"]},{key:"PAYMENT_TYPE_DESCRIPTION",description:"Descriptive text for payment type",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"AMORT_PERIOD",description:"Amortization period in months",category:"Core Loan Terms",dataType:"number",suggestedFormats:[]},{key:"AMORT_PERIOD_AFTER_IO",description:"Amortization months after IO period",category:"Core Loan Terms",dataType:"number",suggestedFormats:[]},{key:"AMORT_SCHEDULE_MONTHS",description:"Partial amortization schedule months",category:"Core Loan Terms",dataType:"number",suggestedFormats:[]},{key:"EFFECTIVE_DATE",description:"Loan effective/origination date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"ORIGINATION_DATE",description:"Loan origination date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"ORIGINATION_DATE_LONG",description:"Origination date (pre-formatted long)",category:"Dates",dataType:"text",suggestedFormats:[]},{key:"TODAY",description:"Current date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"CLOSING_DATE",description:"Closing date (if set)",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"PAYMENT_START_DATE",description:"First payment date (month after origination)",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"MATURITY_DATE",description:"Loan maturity date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"MATURITY_DATE_LONG",description:"Maturity date (pre-formatted long)",category:"Dates",dataType:"text",suggestedFormats:[]},{key:"MONTHLY_PAYMENT",description:"Computed monthly payment amount",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"MONTHLY_PAYMENT_WORDS",description:"Monthly payment in English words",category:"Payment Calculations",dataType:"text",suggestedFormats:[]},{key:"MONTHLY_PAYMENT_CENTS",description:"Monthly payment cents portion",category:"Payment Calculations",dataType:"text",suggestedFormats:[]},{key:"IO_MONTHLY_PAYMENT",description:"Interest-only period payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"AMORT_MONTHLY_PAYMENT",description:"Amortized period payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"PARTIAL_AMORT_PAYMENT",description:"Partially amortized payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"BALLOON_PAYMENT",description:"Balloon payment at maturity",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"DAILY_INTEREST",description:"Daily interest amount (principal x rate / 360)",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"IO_PERIOD_END_MONTH",description:"Last month of IO period",category:"Payment Calculations",dataType:"number",suggestedFormats:[]},{key:"AMORT_START_MONTH",description:"First month of amortization",category:"Payment Calculations",dataType:"number",suggestedFormats:[]},{key:"FULL_PRINCIPAL_IO_PAYMENT",description:"IO payment on full principal (no holdback)",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"FULL_PRINCIPAL_AMORT_PAYMENT",description:"Amort payment on full principal (no holdback)",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"DSR_MONTHS_PAYMENT",description:"Debt service reserve months x payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"LOAN_AMOUNT_WORDS",description:"Loan amount in English words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LOAN_AMOUNT_CENTS",description:"Loan amount cents portion",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LOAN_AMOUNT_DOUBLED",description:"Principal x 2 (mortgage max obligation)",category:"Words & Cents",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"INTEREST_RATE_WORDS",description:"Interest rate whole part in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"INTEREST_RATE_CENTS",description:"Interest rate decimal portion",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"DEFAULT_RATE_WORDS",description:"Default rate in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"DEFAULT_RATE_CENTS",description:"Default rate decimal portion",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LATE_CHARGE_PERCENT_WORDS",description:"Late charge percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LATE_CHARGE_DAYS_WORDS",description:"Late charge days in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"TERM_MONTHS_WORDS",description:"Term months in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"IO_MONTHS_WORDS",description:"IO months in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXIT_FEE_DOLLAR_WORDS",description:"Exit fee dollar amount in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXIT_FEE_PERCENT_WORDS",description:"Exit fee percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"TERMINATION_PERCENT_WORDS",description:"Termination percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_WORDS",description:"Construction holdback in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_CENTS",description:"Construction holdback cents",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXTENSION_COUNT_WORDS",description:"Extension count in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXTENSION_LENGTH_WORDS",description:"Extension length in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXTENSION_FEE_PERCENT_WORDS",description:"Extension fee percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LATE_CHARGE_PERCENT",description:"Late charge percentage",category:"Late Charges",dataType:"rate",suggestedFormats:["PERCENT","DECIMAL2"]},{key:"LATE_CHARGE_DAYS",description:"Grace period days before late charge",category:"Late Charges",dataType:"number",suggestedFormats:["WORDS"]},{key:"STATE_CHOICE_OF_LAW",description:"Governing state for the loan",category:"Choice of Law",dataType:"text",suggestedFormats:["UPPER"]},{key:"COUNTY_CHOICE_OF_LAW",description:"Governing county",category:"Choice of Law",dataType:"text",suggestedFormats:[]},{key:"TITLE_COMPANY_NAME",description:"Title company name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"TITLE_OFFICER_NAME",description:"Title officer name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"TITLE_EMAIL",description:"Title officer email",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"TITLE_POLICY_AMOUNT",description:"Title policy coverage amount",category:"Title & Escrow",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"TITLE_POLICY_PERCENT",description:"Title policy coverage percentage",category:"Title & Escrow",dataType:"rate",suggestedFormats:["PERCENT"]},{key:"ESCROW_COMPANY_NAME",description:"Escrow company name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"ESCROW_OFFICER_NAME",description:"Escrow officer name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"ESCROW_EMAIL",description:"Escrow officer email",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"DOC_PREP_NAME",description:"Document preparer name",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"DOC_PREP_CLOSING_NAME",description:"Closing contact name",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"DOC_PREP_CLOSING_EMAIL",description:"Closing contact email",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"MATTER_NUMBER",description:"Matter/file number",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_NAME",description:"General contractor name",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_ADDRESS",description:"Contractor street address",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_CITY",description:"Contractor city",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_STATE",description:"Contractor state",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_ZIP",description:"Contractor ZIP code",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGN_PROFESSIONAL_NAME",description:"Design professional/architect name",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_ADDRESS",description:"Designer street address",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_CITY",description:"Designer city",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_STATE",description:"Designer state",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_ZIP",description:"Designer ZIP code",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_AMOUNT",description:"Construction holdback/reserve amount",category:"Construction",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"CONSTRUCTION_HOLDBACK_PAID_TO",description:"Construction holdback payee",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_PAID_TO_NOTES",description:"Construction holdback delivery notes",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DISBURSED_AMOUNT",description:"Disbursed amount (loan minus holdback) when Dutch interest is on",category:"Construction",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"EXTENSION_COUNT",description:"Number of extension options",category:"Extensions",dataType:"number",suggestedFormats:["WORDS"]},{key:"EXTENSION_LENGTH",description:"Duration of each extension (months)",category:"Extensions",dataType:"number",suggestedFormats:["WORDS"]},{key:"EXTENSION_FEE_PERCENT",description:"Extension fee as % of loan amount",category:"Extensions",dataType:"rate",suggestedFormats:["PERCENT","WORDS"]},{key:"TERMINATION_FEE_TYPE",description:"Termination fee type (Percentage, Dollar, Greater Of)",category:"Termination & Fees",dataType:"text",suggestedFormats:[]},{key:"TERMINATION_PERCENT",description:"Termination fee percentage",category:"Termination & Fees",dataType:"rate",suggestedFormats:["PERCENT"]},{key:"TERMINATION_DOLLAR",description:"Termination fee dollar amount",category:"Termination & Fees",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"EXIT_FEE_DOLLAR",description:"Exit fee dollar amount",category:"Termination & Fees",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"EXIT_FEE_PERCENT",description:"Exit fee percentage",category:"Termination & Fees",dataType:"rate",suggestedFormats:["PERCENT","WORDS"]},{key:"GUARANTEED_MONTHS_INTEREST",description:"Guaranteed months of interest (prepay)",category:"Termination & Fees",dataType:"number",suggestedFormats:["WORDS"]},{key:"PREPAY_PENALTY_TYPE",description:"Prepayment penalty type (Stepdown, GuaranteedInterest)",category:"Termination & Fees",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_AMOUNT",description:"Debt service reserve amount",category:"Reserves",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"DEBT_SERVICE_RESERVE_AMOUNT_WORDS",description:"DSR amount in words",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_WORDS",description:"DSR amount in words (alias)",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_PAID_TO",description:"DSR payee",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_PAID_TO_NOTES",description:"DSR delivery notes",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_TAX_RESERVE_AMOUNT",description:"Property tax reserve amount",category:"Reserves",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"PROPERTY_TAX_RESERVE_PAID_TO",description:"Property tax reserve payee",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_TAX_RESERVE_NOTES",description:"Property tax reserve notes",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"MIN_NUMBER",description:"MERS Identification Number",category:"MERS",dataType:"text",suggestedFormats:[]},{key:"TOTAL_FEES_PERCENT",description:"Sum of all fee percentages",category:"Fees",dataType:"rate",suggestedFormats:["PERCENT"]},{key:"TOTAL_FEES_AMOUNT",description:"Sum of all fee amounts",category:"Fees",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"BORROWER_NAME",description:"Primary borrower full name",category:"Primary Borrower",dataType:"text",suggestedFormats:["UPPER"]},{key:"BORROWER_ENTITY_TYPE",description:"Primary borrower entity type",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_ENTITY_STRUCTURE",description:"Primary borrower entity structure",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_STATE_ORG",description:"Primary borrower state of formation",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_ADDRESS",description:"Primary borrower street address",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_CITY",description:"Primary borrower city",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_STATE",description:"Primary borrower state",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_ZIP",description:"Primary borrower ZIP",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_FULL_ADDRESS",description:"Primary borrower formatted address",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_AUTH_SIGNER",description:"Primary borrower authorized signer",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_AUTH_SIGNER_TITLE",description:"Primary borrower signer title",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"ALL_BORROWERS",description:"All borrowers with entity descriptions",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"LENDER_NAME",description:"Primary lender full name",category:"Primary Lender",dataType:"text",suggestedFormats:["UPPER"]},{key:"LENDER_ENTITY_TYPE",description:"Primary lender entity type",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_ENTITY_STRUCTURE",description:"Primary lender entity structure",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_STATE_ORG",description:"Primary lender state of formation",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_ADDRESS",description:"Primary lender street address",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_CITY",description:"Primary lender city",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_STATE",description:"Primary lender state",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_ZIP",description:"Primary lender ZIP",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_FULL_ADDRESS",description:"Primary lender formatted address",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_LICENSE",description:"Primary lender license number",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_CLOSING_CONTACT",description:"Primary lender closing contact name",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_CLOSING_CONTACT_EMAIL",description:"Primary lender closing contact email",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"ALL_LENDERS",description:"All lenders with entity descriptions and licenses",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_NAME",description:"Primary guarantor full name",category:"Primary Guarantor",dataType:"text",suggestedFormats:["UPPER"]},{key:"GUARANTOR_ADDRESS",description:"Primary guarantor street address",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_CITY",description:"Primary guarantor city",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_STATE",description:"Primary guarantor state",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_ZIP",description:"Primary guarantor ZIP",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_FULL_ADDRESS",description:"Primary guarantor formatted address",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_ENTITY_TYPE",description:"Primary guarantor entity type",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_ENTITY_STRUCTURE",description:"Primary guarantor entity structure",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_STATE_ORG",description:"Primary guarantor state of formation",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"ALL_GUARANTORS",description:"All guarantors with entity descriptions",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"BROKER_NAME",description:"Primary broker name",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ADDRESS",description:"Primary broker street address",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_CITY",description:"Primary broker city",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_STATE",description:"Primary broker state",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ZIP",description:"Primary broker ZIP",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_FULL_ADDRESS",description:"Primary broker formatted address",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ENTITY_TYPE",description:"Primary broker entity type",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ENTITY_STRUCTURE",description:"Primary broker entity structure",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_STATE_ORG",description:"Primary broker state of formation",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_LICENSE_TYPE",description:"Primary broker license type",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_LICENSE",description:"Primary broker license number",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_ADDRESS",description:"Primary property street address",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_CITY",description:"Primary property city",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_STATE",description:"Primary property state",category:"Property",dataType:"text",suggestedFormats:["UPPER"]},{key:"PROPERTY_STATE_UPPER",description:"Primary property state (uppercase)",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_ZIP",description:"Primary property ZIP",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_TYPE",description:"Primary property type",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_PARCEL",description:"Primary property parcel/APN number",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_FULL_ADDRESS",description:"Primary property formatted address",category:"Property",dataType:"text",suggestedFormats:[]},{key:"SECURITY_INSTRUMENT_TYPE",description:"Deed of Trust or Mortgage (per primary property state)",category:"Property",dataType:"text",suggestedFormats:[]},{key:"SERVICER_NAME",description:"Loan servicer name",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_ADDRESS",description:"Servicer street address",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_CITY",description:"Servicer city",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_STATE",description:"Servicer state",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_ZIP",description:"Servicer ZIP",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_FULL_ADDRESS",description:"Servicer formatted full address",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"ALL_BORROWER_SIGNATURE_BLOCKS",description:"All borrower signature blocks (pre-formatted with nested signatories)",category:"Signature Blocks",dataType:"text",suggestedFormats:[]},{key:"ALL_GUARANTOR_SIGNATURE_BLOCKS",description:"All guarantor signature blocks (pre-formatted with nested signatories)",category:"Signature Blocks",dataType:"text",suggestedFormats:[]},{key:"ALL_LENDER_SIGNATURE_BLOCKS",description:"All lender signature blocks (pre-formatted with nested signatories)",category:"Signature Blocks",dataType:"text",suggestedFormats:[]},{key:"BORROWER_COUNT",description:"Number of borrowers",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"LENDER_COUNT",description:"Number of lenders",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"GUARANTOR_COUNT",description:"Number of guarantors",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"PROPERTY_COUNT",description:"Number of properties",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"DOT_COUNT",description:"Number of Deed of Trust properties",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"MORTGAGE_COUNT",description:"Number of Mortgage properties",category:"Counts",dataType:"number",suggestedFormats:[]}],A=(new Set(I.map(e=>e.category)),new Set(I.map(e=>e.key)),[{key:"IS_BRIDGE",description:"Loan type is Bridge",category:"Loan Type"},{key:"IS_DSCR",description:"Loan type is DSCR / Rental",category:"Loan Type"},{key:"IS_CONSTRUCTION",description:"Loan type is Construction",category:"Loan Type"},{key:"IS_FIX_FLIP",description:"Loan type is Fix & Flip",category:"Loan Type"},{key:"IS_COMMERCIAL",description:"Loan type is Commercial",category:"Loan Type"},{key:"IS_LAND",description:"Loan type is Land",category:"Loan Type"},{key:"IS_INTEREST_ONLY",description:"Amortization is Interest-Only",category:"Amortization"},{key:"IS_FULLY_AMORTIZED",description:"Amortization is Fully Amortized",category:"Amortization"},{key:"IS_IO_THEN_AMORT",description:"IO then Fully Amortized",category:"Amortization"},{key:"IS_IO_THEN_AMORTIZED",description:"IO then Fully Amortized (alias)",category:"Amortization"},{key:"IS_PARTIALLY_AMORTIZED",description:"Partially Amortized with balloon",category:"Amortization"},{key:"HAS_MERS",description:"MERS is included",category:"Loan Features"},{key:"HAS_CONSTRUCTION_HOLDBACK",description:"Construction holdback/reserve exists (requires amount > $0)",category:"Loan Features"},{key:"HAS_DUTCH_INTEREST",description:"Dutch interest applies",category:"Loan Features"},{key:"HAS_CONSTRUCTION_CONTRACT",description:"Construction contract provided",category:"Loan Features"},{key:"HAS_DESIGN_PROFESSIONAL",description:"Design professional/architect assigned",category:"Loan Features"},{key:"HAS_CONDITIONAL_EXTENSION",description:"Conditional extension right exists",category:"Loan Features"},{key:"HAS_PARTIAL_RELEASE",description:"Partial release clause included",category:"Loan Features"},{key:"HAS_TERMINATION_FEE",description:"Termination fee applies",category:"Loan Features"},{key:"HAS_EXIT_FEE",description:"Exit fee applies",category:"Loan Features"},{key:"HAS_PREPAYMENT_PENALTY",description:"Prepayment penalty applies",category:"Loan Features"},{key:"HAS_DEBT_SERVICE_RESERVE",description:"Debt service reserve exists (requires amount)",category:"Loan Features"},{key:"HAS_DEBT_SERVICE_INTEREST_RESERVE",description:"Alias for HAS_DEBT_SERVICE_RESERVE",category:"Loan Features"},{key:"HAS_DEBT_RESERVE_HOLDBACK",description:"Alias for HAS_DEBT_SERVICE_RESERVE",category:"Loan Features"},{key:"HAS_PROPERTY_TAX_RESERVE",description:"Property tax reserve exists (requires amount)",category:"Loan Features"},{key:"HAS_PROPERTY_TAX_HOLDBACK",description:"Alias for HAS_PROPERTY_TAX_RESERVE",category:"Loan Features"},{key:"HAS_HOLDBACKS",description:"At least one holdback/reserve has amount > $0",category:"Loan Features"},{key:"HAS_CROSS_COLLATERAL",description:"Cross-collateral clause included",category:"Loan Features"},{key:"HAS_BORROWER_SERVICE_FEES",description:"Borrower service fees apply",category:"Loan Features"},{key:"HAS_ACH_PAYMENTS",description:"ACH payments required",category:"Loan Features"},{key:"HAS_W9",description:"W-9 included",category:"Loan Features"},{key:"HAS_SIGNING_AFFIDAVIT",description:"Signing affidavit included",category:"Loan Features"},{key:"LOAN_INTENDED_FOR_SALE",description:"Loan intended for sale",category:"Loan Features"},{key:"NOT_HAS_CONSTRUCTION_HOLDBACK",description:"No construction holdback",category:"Negated Flags"},{key:"NOT_HAS_PREPAYMENT_PENALTY",description:"No prepayment penalty",category:"Negated Flags"},{key:"NOT_HAS_ACH_PAYMENTS",description:"No ACH payments required",category:"Negated Flags"},{key:"HAS_BORROWER",description:"At least one borrower exists",category:"Party Presence"},{key:"HAS_LENDER",description:"At least one lender exists",category:"Party Presence"},{key:"HAS_PROPERTY",description:"At least one property exists",category:"Party Presence"},{key:"HAS_GUARANTOR",description:"Guarantor exists on the loan",category:"Party Presence"},{key:"HAS_BROKER",description:"Broker exists on the loan",category:"Party Presence"},{key:"HAS_SERVICER",description:"Loan servicer is assigned",category:"Party Presence"},{key:"HAS_ESCROW",description:"Escrow company exists",category:"Party Presence"},{key:"HAS_ASSIGNEE",description:"Loan assignee exists",category:"Party Presence"},{key:"MULTIPLE_BORROWERS",description:"More than one borrower",category:"Party Presence"},{key:"MULTIPLE_LENDERS",description:"More than one lender",category:"Party Presence"},{key:"MULTIPLE_GUARANTORS",description:"More than one guarantor",category:"Party Presence"},{key:"MULTIPLE_PROPERTIES",description:"More than one property",category:"Party Presence"},{key:"SINGLE_BORROWER",description:"Exactly one borrower",category:"Party Presence"},{key:"SINGLE_LENDER",description:"Exactly one lender",category:"Party Presence"},{key:"SINGLE_GUARANTOR",description:"Exactly one guarantor",category:"Party Presence"},{key:"SINGLE_PROPERTY",description:"Exactly one property",category:"Party Presence"},{key:"MULTIPLE_ASSIGNEES",description:"More than one assignee",category:"Party Presence"},{key:"HAS_ENTITY_BORROWER",description:"Any borrower is an entity (LLC, Corp)",category:"Borrower Types"},{key:"HAS_TRUST_BORROWER",description:"Any borrower is a trust",category:"Borrower Types"},{key:"HAS_INDIVIDUAL_BORROWER",description:"Any borrower is an individual",category:"Borrower Types"},{key:"BORROWER_IS_ENTITY",description:"Primary borrower is an entity",category:"Borrower Types"},{key:"BORROWER_IS_TRUST",description:"Primary borrower is a trust",category:"Borrower Types"},{key:"BORROWER_IS_INDIVIDUAL",description:"Primary borrower is an individual",category:"Borrower Types"},{key:"BORROWER_HAS_REG_AGENT",description:"Primary borrower has registered agent",category:"Borrower Types"},{key:"HAS_DOT",description:"Has property in a Deed of Trust state",category:"Security Instrument"},{key:"HAS_MORTGAGE",description:"Has property in a Mortgage state",category:"Security Instrument"},{key:"HAS_DOT_AND_MORTGAGE",description:"Has properties in both DOT and Mortgage states",category:"Security Instrument"},{key:"PROPERTY_IS_DOT_STATE",description:"Primary property is in a DOT state",category:"Security Instrument"},{key:"PROPERTY_REQUIRES_WITNESSES",description:"Primary property state requires witnesses",category:"Security Instrument"},{key:"MULTIPLE_DOT_PROPERTIES",description:"More than one DOT property",category:"Security Instrument"},{key:"MULTIPLE_MORTGAGE_PROPERTIES",description:"More than one Mortgage property",category:"Security Instrument"},{key:"MULTIPLE_BORROWER_SIGNERS",description:"More than one borrower signer total",category:"Signature Blocks"},{key:"SIGNER_IS_ENTITY",description:"Any borrower is an entity (needs auth signer)",category:"Signature Blocks"},{key:"HAS_LENDER_FEES",description:"Lender fees exist",category:"Fee Presence"},{key:"HAS_BROKER_FEES",description:"Broker fees exist",category:"Fee Presence"},{key:"HAS_OTHER_FEES",description:"Other fees exist",category:"Fee Presence"},{key:"TERMINATION_IS_PERCENTAGE",description:"Termination fee is percentage-based",category:"Termination & Prepay Types"},{key:"TERMINATION_IS_DOLLAR",description:"Termination fee is dollar-based",category:"Termination & Prepay Types"},{key:"TERMINATION_IS_GREATER_OF",description:"Termination fee is greater of % or $",category:"Termination & Prepay Types"},{key:"PREPAY_TYPE_STEPDOWN",description:"Prepayment penalty is stepdown schedule",category:"Termination & Prepay Types"},{key:"PREPAY_TYPE_GUARANTEED_INTEREST_FOR_X_MONTHS",description:"Prepay is guaranteed months of interest",category:"Termination & Prepay Types"},{key:"HAS_TITLE_COMPANY",description:"Title company info exists",category:"Title & Escrow"},{key:"HAS_CFL_LICENSE",description:"Any lender has CFL license",category:"Title & Escrow"},{key:"PROPERTY_IS_LOUISIANA",description:"Primary property is in Louisiana",category:"State-Specific"},{key:"PROPERTY_IS_HAWAII",description:"Primary property is in Hawaii",category:"State-Specific"},{key:"PROPERTY_IS_OHIO",description:"Primary property is in Ohio",category:"State-Specific"},{key:"MULTIPLE_EXTENSION_COUNT",description:"More than one extension option",category:"Extensions"},{key:"MULTIPLE_EXTENSION_LENGTH",description:"Extension length > 1 month",category:"Extensions"},{key:"MULTIPLE_OWNERS_OF_ENTITYS",description:"More than one entity owner",category:"Entity Owners"},{key:"OWNERS_OF_ENTITY_COUNT_GT_2",description:"More than two entity owners",category:"Entity Owners"},{key:"IS_GUARANTY_LIMITED",description:"Guaranty is limited (not yet implemented)",category:"Defaults"},{key:"IS_NOTE_HYPOTHECATION",description:"Note hypothecation (not yet implemented)",category:"Defaults"},{key:"HAS_DIFFERENT_EFFECTIVE_DATE",description:"Different effective date (not yet implemented)",category:"Defaults"}]),x=(new Set(A.map(e=>e.category)),new Set(A.map(e=>e.key)),[{key:"NAME",description:"Full legal name"},{key:"FIRST_NAME",description:"First name (individual)"},{key:"LAST_NAME",description:"Last name (individual)"},{key:"ENTITY_TYPE",description:"Individual, Entity, or Trust"},{key:"ENTITY_STRUCTURE",description:"LLC, Corporation, etc."},{key:"STATE_OF_FORMATION",description:"State of organization"},{key:"STATE_ORG",description:"State of organization (alias)"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"FULL_ADDRESS",description:"Formatted full address"},{key:"ENTITY_DESCRIPTION",description:'e.g., "a California limited liability company"'},{key:"TYPE_IS_INDIVIDUAL",description:"True if individual"},{key:"TYPE_IS_ENTITY",description:"True if entity"},{key:"TYPE_IS_TRUST",description:"True if trust"},{key:"AUTH_SIGNER",description:"First authorized signer name"},{key:"AUTH_SIGNER_TITLE",description:"First signer title"},{key:"HAS_AUTH_SIGNER",description:"True if any signer exists"},{key:"MULTIPLE_AUTH_SIGNERS",description:"True if > 1 signer"},{key:"AUTH_SIGNER_COUNT",description:"Number of signers"}]),N=[{key:"BORROWERS",description:"All borrowers on the loan",category:"Parties",itemFields:[...x,{key:"REG_AGENT",description:"Registered agent name"},{key:"REG_AGENT_ADDRESS",description:"Registered agent address"},{key:"AKA_NAMES",description:"Also-known-as names (comma-separated)"},{key:"HAS_AKA",description:"True if has AKA names"},{key:"AUTH_SIGNER_2",description:"Second authorized signer"},{key:"AUTH_SIGNER_2_TITLE",description:"Second signer title"},{key:"TYPE_IS_CORPORATION",description:"True if entity structure is corporation"},{key:"TYPE_IS_NON_CORPORATION",description:"True if entity structure is NOT corporation"},{key:"BORROWER_SIGNER_NEEDS_SIGNER",description:"True if entity/trust (needs auth signer)"},{key:"STATE_ORG_IS_{STATE}",description:"True if state of formation matches (e.g., STATE_ORG_IS_FLORIDA, STATE_ORG_IS_TEXAS)"},{key:"STATE_IS_{STATE}",description:"True if address state matches (e.g., STATE_IS_LOUISIANA, STATE_IS_CONNECTICUT)"},{key:"STATE_ORG_NOT_TEXAS",description:"True if state of formation is NOT Texas"}]},{key:"LENDERS",description:"All lenders on the loan",category:"Parties",itemFields:[...x,{key:"PERCENTAGE_INTEREST",description:"Lender's percentage interest (e.g., 75.00)"},{key:"HAS_CFL",description:"True if has CFL license"},{key:"CFL_LICENSE",description:"CFL license number"},{key:"HAS_DRE",description:"True if has DRE license"},{key:"DRE_LICENSE",description:"DRE license number"},{key:"LICENSE",description:"Primary license number (CFL or DRE)"},{key:"CLOSING_CONTACT",description:"Closing contact name"},{key:"CLOSING_CONTACT_EMAIL",description:"Closing contact email"}]},{key:"GUARANTORS",description:"All guarantors on the loan",category:"Parties",itemFields:[...x,{key:"AKA_NAMES",description:"Also-known-as names"},{key:"GUARANTOR_NAME",description:"Guarantor name (alias)"},{key:"GUARANTOR_AKA_NAME",description:"Guarantor AKA names"},{key:"GUARANTOR_NAME_NOT_IN_ALL_SIGNERS",description:"True if guarantor isn't already a borrower signer"}]},{key:"BROKERS",description:"All brokers on the loan",category:"Parties",itemFields:[{key:"NAME",description:"Broker name"},{key:"ENTITY_TYPE",description:"Individual, Entity, or Trust"},{key:"ENTITY_STRUCTURE",description:"LLC, Corporation, etc."},{key:"STATE_OF_FORMATION",description:"State of organization"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"FULL_ADDRESS",description:"Formatted full address"},{key:"LICENSE_TYPE",description:"License type (CFL, DRE, etc.)"},{key:"LICENSE",description:"License number"},{key:"FEE",description:"Broker fee"}]},{key:"PROPERTIES",description:"All collateral properties",category:"Properties",itemFields:[{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"STATE_UPPER",description:"State (uppercase)"},{key:"FULL_ADDRESS",description:"Formatted full address"},{key:"PROPERTY_TYPE",description:"Property type (Single Family, etc.)"},{key:"PARCEL_NUMBER",description:"Parcel/APN number"},{key:"IS_DOT",description:"True if Deed of Trust state"},{key:"SECURITY_TYPE",description:'"Deed of Trust" or "Mortgage"'},{key:"REQUIRES_WITNESSES",description:"True if witness-required state"},{key:"LIEN",description:"Lien position (first, second, etc.)"},{key:"LIEN_LOWER",description:"Lien position lowercase"},{key:"ORDINAL",description:"Position ordinal (1st, 2nd, 3rd)"},{key:"PARTIAL_RELEASE_AMOUNT",description:"Partial release amount"},{key:"OWNER",description:"Property owner name"},{key:"OWNER_ENTITY_TYPE",description:"Owner entity type"},{key:"OWNER_STATE_ORG",description:"Owner state of organization"},{key:"DESCRIPTION",description:"Legal description"},{key:"TITLE_ORDER_NUMBER",description:"Title order number"},{key:"TITLE_EFFECTIVE_DATE",description:"Title effective date"},{key:"TITLE_ENDORSEMENTS",description:"Title policy endorsements required"},{key:"TITLE_POLICY_EXCEPTIONS",description:"Instructions to title regarding exceptions"},{key:"TITLE_POLICY_REQUIRED",description:"Type of title policy requested"}]},{key:"DOT_PROPERTIES",description:"Properties in Deed of Trust states only",category:"Properties",itemFields:[{key:"(same as PROPERTIES)",description:"Same fields as PROPERTIES collection"}]},{key:"MORTGAGE_PROPERTIES",description:"Properties in Mortgage states only",category:"Properties",itemFields:[{key:"(same as PROPERTIES)",description:"Same fields as PROPERTIES collection"}]},{key:"FEES",description:"All fees (lender, broker, and other)",category:"Fees",itemFields:[{key:"DESCRIPTION",description:"Fee type/description"},{key:"AMOUNT",description:"Fee amount (cleaned numeric)"},{key:"OWED_TO",description:"Fee recipient"},{key:"NOTES",description:"Additional notes"},{key:"CATEGORY",description:"Lender, Broker, or Other"}]},{key:"LENDER_FEES",description:"Lender fees only",category:"Fees",itemFields:[{key:"(same as FEES)",description:"Same fields as FEES collection"}]},{key:"BROKER_FEES",description:"Broker fees only",category:"Fees",itemFields:[{key:"(same as FEES)",description:"Same fields as FEES collection"}]},{key:"OTHER_FEES",description:"Other fees only",category:"Fees",itemFields:[{key:"(same as FEES)",description:"Same fields as FEES collection"}]},{key:"PARTIAL_RELEASES",description:"Properties with partial release amounts (only properties that have a release amount set)",category:"Other",itemFields:[{key:"PROPERTY",description:"Full property address"},{key:"PARTIAL_RELEASE_PROP",description:"Full property address (alias)"},{key:"AMOUNT",description:"Release amount"},{key:"RELEASE_AMOUNT",description:"Release amount (alias)"}]},{key:"ASSIGNEES",description:"Loan assignees",category:"Other",itemFields:[{key:"NAME",description:"Assignee name"},{key:"ENTITY_TYPE",description:"Entity type"},{key:"ENTITY_STRUCTURE",description:"Entity structure"},{key:"STATE_OF_FORMATION",description:"State of organization"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"FULL_ADDRESS",description:"Formatted full address"}]},{key:"ENTITY_OWNERS",description:"Owners of the borrowing entity",category:"Other",itemFields:[{key:"NAME",description:"Owner name"},{key:"FIRST_NAME",description:"First name"},{key:"LAST_NAME",description:"Last name"},{key:"ENTITY_TYPE",description:"Entity type"},{key:"ENTITY_STRUCTURE",description:"Entity structure"},{key:"STATE_OF_FORMATION",description:"State of formation"},{key:"ABBREVIATION",description:"Owner abbreviation"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"TYPE_IS_INDIVIDUAL",description:"True if owner is Individual"},{key:"TYPE_IS_ENTITY",description:"True if owner is Entity"},{key:"TYPE_IS_TRUST",description:"True if owner is Trust"},{key:"HAS_AUTH_SIGNER",description:"True if owner has authorized signer"},{key:"AUTH_SIGNER",description:"First authorized signer name"},{key:"AUTH_SIGNER_TITLE",description:"First authorized signer title"},{key:"AUTH_SIGNER_COUNT",description:"Number of authorized signers"}]},{key:"SIGNATURE_BLOCKS",description:"Signature blocks for all borrowers (one per borrower)",category:"Signatures",itemFields:[{key:"BLOCK",description:"Full formatted signature block with nested signatories (use \\n for line breaks)"},{key:"TYPE",description:'"individual", "entity", or "trust"'},{key:"NAME",description:"Party name"},{key:"LINE_LABEL",description:"Flat signature line label (backward compat)"},{key:"ENTITY_NAME",description:"Entity/Trust name (empty for Individual)"},{key:"SIGNER_NAME",description:"Leaf signer name (deepest Individual)"},{key:"SIGNER_TITLE",description:"Leaf signer title"},{key:"TYPE_IS_INDIVIDUAL",description:"True if individual borrower"},{key:"TYPE_IS_ENTITY",description:"True if entity borrower"},{key:"TYPE_IS_TRUST",description:"True if trust borrower"},{key:"HAS_BLOCK",description:"Always true (for conditional use)"}]},{key:"GUARANTOR_SIGNATURE_BLOCKS",description:"Signature blocks for all guarantors (one per guarantor)",category:"Signatures",itemFields:[{key:"BLOCK",description:"Full formatted signature block with nested signatories"},{key:"TYPE",description:'"individual", "entity", or "trust"'},{key:"NAME",description:"Party name"},{key:"LINE_LABEL",description:"Flat signature line label"},{key:"ENTITY_NAME",description:"Entity/Trust name (empty for Individual)"},{key:"SIGNER_NAME",description:"Leaf signer name"},{key:"SIGNER_TITLE",description:"Leaf signer title"},{key:"TYPE_IS_INDIVIDUAL",description:"True if individual guarantor"},{key:"TYPE_IS_ENTITY",description:"True if entity guarantor"},{key:"TYPE_IS_TRUST",description:"True if trust guarantor"},{key:"HAS_BLOCK",description:"Always true"}]},{key:"LENDER_SIGNATURE_BLOCKS",description:"Signature blocks for all lenders (one per lender)",category:"Signatures",itemFields:[{key:"BLOCK",description:"Full formatted signature block with nested signatories"},{key:"TYPE",description:'"individual", "entity", or "trust"'},{key:"NAME",description:"Party name"},{key:"LINE_LABEL",description:"Flat signature line label"},{key:"ENTITY_NAME",description:"Entity/Trust name (empty for Individual)"},{key:"SIGNER_NAME",description:"Leaf signer name"},{key:"SIGNER_TITLE",description:"Leaf signer title"},{key:"TYPE_IS_INDIVIDUAL",description:"True if individual lender"},{key:"TYPE_IS_ENTITY",description:"True if entity lender"},{key:"TYPE_IS_TRUST",description:"True if trust lender"},{key:"HAS_BLOCK",description:"Always true"}]},{key:"BORROWER_SIGNERS",description:"Authorized signers for all borrowers",category:"Signatures",itemFields:[{key:"SIGNER_NAME",description:"Signer full name"},{key:"SIGNER_TITLE",description:"Signer title"},{key:"SIGNER_TYPE",description:"Signer entity type: Individual, Entity, or Trust"},{key:"SIGNER_TYPE_IS_INDIVIDUAL",description:"True if signer is Individual"},{key:"SIGNER_TYPE_IS_ENTITY",description:"True if signer is Entity"},{key:"SIGNER_TYPE_IS_TRUST",description:"True if signer is Trust"},{key:"SIGNER_ENTITY_STRUCTURE",description:"Signer's entity structure (e.g., limited liability company)"},{key:"SIGNER_STATE_OF_FORMATION",description:"Signer's state of formation"},{key:"SIGNER_ADDRESS",description:"Signer's street address"},{key:"SIGNER_CITY",description:"Signer's city"},{key:"SIGNER_STATE",description:"Signer's state"},{key:"SIGNER_ZIP",description:"Signer's ZIP code"},{key:"ENTITY_NAME",description:"Entity being signed for"},{key:"ENTITY_TYPE",description:"Entity type"}]},{key:"LENDER_SIGNERS",description:"Authorized signers for all lenders",category:"Signatures",itemFields:[{key:"SIGNER_NAME",description:"Signer full name"},{key:"SIGNER_TITLE",description:"Signer title"},{key:"SIGNER_TYPE",description:"Signer entity type: Individual, Entity, or Trust"},{key:"SIGNER_TYPE_IS_INDIVIDUAL",description:"True if signer is Individual"},{key:"SIGNER_TYPE_IS_ENTITY",description:"True if signer is Entity"},{key:"SIGNER_TYPE_IS_TRUST",description:"True if signer is Trust"},{key:"SIGNER_ENTITY_STRUCTURE",description:"Signer's entity structure"},{key:"SIGNER_STATE_OF_FORMATION",description:"Signer's state of formation"},{key:"SIGNER_ADDRESS",description:"Signer's street address"},{key:"SIGNER_CITY",description:"Signer's city"},{key:"SIGNER_STATE",description:"Signer's state"},{key:"SIGNER_ZIP",description:"Signer's ZIP code"},{key:"ENTITY_NAME",description:"Entity being signed for"}]},{key:"GUARANTOR_SIGNERS",description:"Authorized signers for all guarantors",category:"Signatures",itemFields:[{key:"SIGNER_NAME",description:"Signer full name"},{key:"SIGNER_TITLE",description:"Signer title"},{key:"SIGNER_TYPE",description:"Signer entity type: Individual, Entity, or Trust"},{key:"SIGNER_TYPE_IS_INDIVIDUAL",description:"True if signer is Individual"},{key:"SIGNER_TYPE_IS_ENTITY",description:"True if signer is Entity"},{key:"SIGNER_TYPE_IS_TRUST",description:"True if signer is Trust"},{key:"SIGNER_ENTITY_STRUCTURE",description:"Signer's entity structure"},{key:"SIGNER_STATE_OF_FORMATION",description:"Signer's state of formation"},{key:"SIGNER_ADDRESS",description:"Signer's street address"},{key:"SIGNER_CITY",description:"Signer's city"},{key:"SIGNER_STATE",description:"Signer's state"},{key:"SIGNER_ZIP",description:"Signer's ZIP code"},{key:"ENTITY_NAME",description:"Entity being signed for"},{key:"AKA_NAME",description:"Guarantor AKA names"}]}],h=(new Set(N.map(e=>e.category)),new Set(N.map(e=>e.key)),"https://app.automateloandocs.com");function b(){try{return localStorage.getItem("ald_api_url")||h}catch{return h}}let O=null,P=null,C=null;const L=[{suffix:"CURRENCY",description:"US dollar format",example:"$850,000.00",applicableTo:["money","number"]},{suffix:"WORDS",description:"Number in English words",example:"Eight Hundred Fifty Thousand and 00/100",applicableTo:["money","number"]},{suffix:"CENTS",description:"Cents portion only",example:"00",applicableTo:["money","number"]},{suffix:"UPPER",description:"UPPERCASE text",example:"JOHN DOE",applicableTo:["text"]},{suffix:"LOWER",description:"lowercase text",example:"john doe",applicableTo:["text"]},{suffix:"DECIMAL2",description:"Two decimal places",example:"12.50",applicableTo:["rate","number"]},{suffix:"DECIMAL3",description:"Three decimal places",example:"12.500",applicableTo:["rate","number"]},{suffix:"LONGDATE",description:"Full date format",example:"January 15, 2026",applicableTo:["date"]},{suffix:"SHORTDATE",description:"Short date format",example:"01/15/2026",applicableTo:["date"]},{suffix:"PERCENT",description:"Percentage with % sign",example:"12.50%",applicableTo:["rate","number"]}];function v(e,t){if(!t.trim())return e;const n=t.toLowerCase();return e.filter(e=>e.key.toLowerCase().includes(n)||e.description.toLowerCase().includes(n))}async function F(e){await Word.run(async t=>{t.document.getSelection().insertText(e,Word.InsertLocation.replace),await t.sync()})}async function w(e){let t=!1;return await Word.run(async n=>{const r=n.document.body.search(e,{matchCase:!1});r.load("items"),await n.sync(),r.items.length>0&&(r.items[0].select(),t=!0),await n.sync()}),t}function D(e,t,...n){const r=document.createElement(e);return t?.cls&&(r.className=t.cls),t?.attrs&&Object.entries(t.attrs).forEach(([e,t])=>r.setAttribute(e,t)),t?.text&&(r.textContent=t.text),t?.html&&(r.innerHTML=t.html),n.forEach(e=>{"string"==typeof e?r.appendChild(document.createTextNode(e)):r.appendChild(e)}),r}function M(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function U(e,t,n){e.addEventListener("click",r=>{const a=r.target.closest(t);a&&e.contains(a)&&n(a,r)})}L.map(e=>e.suffix);let Y,G,H="",B=I;function W(e){Y=e,U(Y,".field-item",(e,t)=>{if(t.target.closest(".format-picker"))return;const n=e.getAttribute("data-key"),r=Y.querySelector(`.format-picker[data-for="${n}"]`);r&&(Y.querySelectorAll(".format-picker.open").forEach(e=>{e!==r&&e.classList.remove("open")}),r.classList.contains("open")?r.classList.remove("open"):r.querySelectorAll(".format-btn").length<=1?K(n,""):r.classList.add("open"))}),U(Y,".format-btn",e=>{const t=e.closest(".format-picker");K(t?.getAttribute("data-for")??"",e.getAttribute("data-fmt")??""),t?.classList.remove("open")}),z(),async function(){if(P)return P;try{const e=await fetch(`${b()}/api/catalog/fields`);if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();return P=t.flatMap(e=>e.items.map(t=>({key:t.key,description:t.description,category:e.category,dataType:t.dataType,suggestedFormats:t.formats}))),P}catch{return P=I,P}}().then(e=>{e!==B&&(B=e,z())})}function $(e){H=e,z()}function z(){Y.innerHTML="";const e=v(B,H),t=new Map;for(const n of e){const e=t.get(n.category)??[];e.push(n),t.set(n.category,e)}if(0!==t.size)for(const[e,n]of t){const t=D("div",{cls:"category"+(H.length>0?" open":"")}),r=D("div",{cls:"category-header"});r.innerHTML=`<span class="arrow">&#9654;</span> ${e} <span class="count">${n.length}</span>`,r.addEventListener("click",()=>t.classList.toggle("open"));const a=D("div",{cls:"category-body"});for(const e of n){const t=D("div",{cls:"field-item",attrs:{"data-key":e.key}});t.innerHTML=`<span class="field-key">${e.key}</span><span class="field-desc">${e.description}</span>`;const n=D("div",{cls:"format-picker",attrs:{"data-for":e.key}}),r=D("button",{cls:"format-btn",text:"Plain",attrs:{"data-fmt":""}});n.appendChild(r);for(const t of e.suggestedFormats){const e=L.find(e=>e.suffix===t),r=D("button",{cls:"format-btn",text:t,attrs:{"data-fmt":t,title:e?.example??""}});n.appendChild(r)}a.appendChild(t),a.appendChild(n)}t.appendChild(r),t.appendChild(a),Y.appendChild(t)}else Y.appendChild(D("div",{cls:"field-desc",text:"No fields match your search."}))}async function K(e,t){const n=t?`{{${e}:${t}}}`:`{{${e}}}`;try{await F(n),V(`Inserted ${n}`)}catch{V("Place cursor in document first")}}function V(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}let Z,j="",q=A,X=[],Q=1,J=null,ee=null,te=null,ne=null;function re(e){if("boolean"===e.type)return e.key;if("IN"===e.operator)return`${e.field} IN "${e.value}"`;const t=isNaN(Number(e.value))?`"${e.value}"`:e.value;return`${e.field} ${e.operator} ${t}`}function ae(){return X.map((e,t)=>{const n=re(e.atom);return 0===t?n:`${e.joinOperator} ${n}`}).join(" ")}function oe(e){const t=0===X.length?null:"AND";X.push({id:Q++,atom:e,joinOperator:t}),ce()}function ie(e){G=e,U(G,".condition-item",e=>{ne&&clearTimeout(ne),ne=setTimeout(()=>{ne=null;const t=e.getAttribute("data-key");t&&(oe({type:"boolean",key:t}),le(`Added ${t} to builder`))},250)}),G.addEventListener("dblclick",e=>{const t=e.target.closest(".condition-item");if(!t||!G.contains(t))return;ne&&(clearTimeout(ne),ne=null);const n=t.getAttribute("data-key");n&&async function(e){try{await F(`{{#IF ${e}}}\n\n{{/IF}}`),le(`Inserted IF ${e}`)}catch{le("Place cursor in document first")}}(n)}),U(G,".chip-remove",e=>{var t;t=parseInt(e.getAttribute("data-id")??"0",10),X=X.filter(e=>e.id!==t),X.length>0&&(X[0].joinOperator=null),ce()}),U(G,".builder-join-toggle",e=>{!function(e){const t=X.find(t=>t.id===e);t&&null!==t.joinOperator&&(t.joinOperator="AND"===t.joinOperator?"OR":"AND",ce())}(parseInt(e.getAttribute("data-id")??"0",10))}),U(G,".builder-insert-btn",async e=>{const t=e.getAttribute("data-action")??"";await async function(e){if(0===X.length)return void le("Add at least one condition first");const t=function(e){const t=ae();switch(e){case"block-if":return`{{#IF ${t}}}\n\n{{/IF}}`;case"block-else":return`{{#IF ${t}}}\n\n{{#ELSE}}\n\n{{/IF}}`;case"inline-if":return`{{#IF ${t}}}text here{{/IF}}`;case"unless":return`{{#UNLESS ${t}}}\n\n{{/IF}}`;default:return""}}(e);if(t)try{await F(t);const n=ae();le(`Inserted ${e.toUpperCase()} ${n}`),X=[],ce()}catch{le("Place cursor in document first")}}(t)}),U(G,"#builder-clear-btn",()=>(X=[],ce(),void le("Builder cleared"))),U(G,"#add-custom-btn",()=>{const e=G.querySelector("#custom-input"),t=e?.value.trim().toUpperCase().replace(/\s+/g,"_")??"";t?(oe({type:"boolean",key:t}),e.value="",le(`Added ${t} to builder`)):le("Enter a condition name")}),U(G,"#add-comparison-btn",()=>{const e=G.querySelector("#cmp-field")?.value.trim().toUpperCase().replace(/\s+/g,"_"),t=G.querySelector("#cmp-op")?.value,n=G.querySelector("#cmp-value")?.value.trim();e?n?(oe({type:"comparison",field:e,operator:t,value:n}),G.querySelector("#cmp-field").value="",G.querySelector("#cmp-value").value="",le(`Added ${e} ${t} ${n} to builder`)):le("Enter a value"):le("Enter a field name")}),U(G,".category-header",e=>{const t=e.closest(".category");t&&t.classList.toggle("open")}),de(),async function(){if(O)return O;try{const e=await fetch(`${b()}/api/catalog/conditions`);if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();return O=t.flatMap(e=>e.items.map(t=>({key:t.key,description:t.description,category:e.category}))),O}catch{return O=A,O}}().then(e=>{e!==q&&(q=e,de())})}function se(e){j=e,pe()}function de(){G.innerHTML="",J=D("div",{cls:"builder-box"}),G.appendChild(J),ee=D("div",{cls:"builder-inputs"}),ee.innerHTML='\n    <div class="input-row">\n      <input id="custom-input" type="text" class="builder-input"\n             placeholder="Custom condition (e.g. MY_FLAG)" spellcheck="false" autocomplete="off" />\n      <button id="add-custom-btn" class="builder-add-btn" title="Add to builder">+</button>\n    </div>\n    <div class="input-row">\n      <input id="cmp-field" type="text" class="builder-input"\n             placeholder="FIELD" spellcheck="false" autocomplete="off" style="flex:2;" />\n      <select id="cmp-op" class="builder-input" style="flex:0 0 auto; min-width:48px;">\n        <option value="==">=</option>\n        <option value="!=">!=</option>\n        <option value=">">&gt;</option>\n        <option value=">=">&gt;=</option>\n        <option value="<">&lt;</option>\n        <option value="<=">&lt;=</option>\n        <option value="IN">IN</option>\n      </select>\n      <input id="cmp-value" type="text" class="builder-input"\n             placeholder="value" spellcheck="false" autocomplete="off" style="flex:2;" />\n      <button id="add-comparison-btn" class="builder-add-btn" title="Add comparison to builder">+</button>\n    </div>\n  ',G.appendChild(ee),te=D("div",{cls:"catalog-section"}),G.appendChild(te),ce(),pe()}function ce(){if(!J)return;if(0===X.length)return void(J.innerHTML='\n      <div class="builder-header">\n        <span class="builder-label">CONDITION BUILDER</span>\n      </div>\n      <div class="builder-empty">Click any condition below to start building, or type a custom one above.</div>\n    ');let e='<div class="builder-header">\n    <span class="builder-label">CONDITION BUILDER</span>\n    <button id="builder-clear-btn" class="builder-clear-btn" title="Clear all">Clear</button>\n  </div>';e+='<div class="builder-parts">';for(const t of X)t.joinOperator&&(e+=`<button class="builder-join-toggle" data-id="${t.id}" title="Click to toggle AND / OR">${t.joinOperator}</button>`),e+=`<div class="builder-chip">\n      <span class="chip-text">${M(re(t.atom))}</span>\n      <button class="chip-remove" data-id="${t.id}" title="Remove">&times;</button>\n    </div>`;e+="</div>",e+=`<div class="builder-preview">${M(function(){const e=ae();return`{{#IF ${e}}}\n  ...\n{{/IF}}`}())}</div>`,e+='<div class="builder-insert-actions">\n    <button class="builder-insert-btn" data-action="block-if">Block IF</button>\n    <button class="builder-insert-btn" data-action="block-else">IF / ELSE</button>\n    <button class="builder-insert-btn" data-action="inline-if">Inline IF</button>\n    <button class="builder-insert-btn" data-action="unless">UNLESS</button>\n  </div>',J.innerHTML=e}function pe(){if(!te)return;te.innerHTML="";const e=v(q,j),t=new Map;for(const n of e){const e=t.get(n.category)??[];e.push(n),t.set(n.category,e)}if(0===t.size){const e=D("div",{cls:"field-desc",text:"No conditions match your search."});return e.style.padding="8px",void te.appendChild(e)}for(const[e,n]of t){const t=D("div",{cls:"category"+(j.length>0?" open":"")}),r=D("div",{cls:"category-header"});r.innerHTML=`<span class="arrow">&#9654;</span> ${e} <span class="count">${n.length}</span>`;const a=D("div",{cls:"category-body"});for(const e of n){const t=D("div",{cls:"condition-item",attrs:{"data-key":e.key}});t.innerHTML=`<span class="field-key">${M(e.key)}</span><span class="field-desc" style="margin-left:6px;">${M(e.description)}</span><span class="add-hint">+</span>`,a.appendChild(t)}t.appendChild(r),t.appendChild(a),te.appendChild(t)}}function le(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}let ye,ge="",ue=N;function Te(e){Z=e,U(Z,".action-btn[data-col]",async e=>{const t=e.getAttribute("data-col")??"",n="row"===(e.getAttribute("data-type")??"")?"ROW":"EACH",r=ue.find(e=>e.key===t),a=r?.itemFields.some(e=>"BLOCK"===e.key),o=`{{#${n} ${t}}}${a?"\n{{ITEM.BLOCK}}\n":"\n\n"}{{/${n} ${t}}}`;try{await F(o),fe(`Inserted ${n} ${t}`)}catch{fe("Place cursor in document first")}}),U(Z,".item-field",async e=>{const t=`{{ITEM.${e.getAttribute("data-item")??""}}}`;try{await F(t),fe(`Inserted ${t}`)}catch{fe("Place cursor in document first")}}),me(),async function(){if(C)return C;try{const e=await fetch(`${b()}/api/catalog/collections`);if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();return C=t.flatMap(e=>e.items.map(t=>({key:t.key,description:t.description,category:e.category,itemFields:t.itemFields}))),C}catch{return C=N,C}}().then(e=>{e!==ue&&(ue=e,me())})}function Ee(e){ge=e,me()}function me(){Z.innerHTML="";const e=ge.toLowerCase(),t=e?ue.filter(t=>t.key.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.itemFields.some(t=>t.key.toLowerCase().includes(e)||t.description.toLowerCase().includes(e))):ue;if(0===t.length)return void Z.appendChild(D("div",{cls:"field-desc",text:"No collections match your search."}));const n=D("div",{cls:"ref-section",html:'<div style="font-size:10px; color:#8E949A; padding:4px 4px 8px;">\n      All loops include: <code style="font-family:var(--mono);">ITEM.INDEX</code>,\n      <code style="font-family:var(--mono);">ITEM.IS_FIRST</code>,\n      <code style="font-family:var(--mono);">ITEM.IS_LAST</code>,\n      <code style="font-family:var(--mono);">ITEM.COUNT</code>,\n      <code style="font-family:var(--mono);">ITEM.SEPARATOR</code>\n    </div>'});Z.appendChild(n);for(const e of t){const t=D("div",{cls:"collection-card"+(ge?" open":"")}),n=D("div",{cls:"collection-header",attrs:{"data-key":e.key}});n.innerHTML=`<span>${e.key} <span style="font-weight:400; color:#8E949A; font-size:10px;">(${e.itemFields.length} fields)</span></span><span class="arrow">&#9654;</span>`,n.addEventListener("click",()=>t.classList.toggle("open"));const r=D("div",{cls:"collection-body"});r.appendChild(D("div",{cls:"collection-desc",text:e.description}));const a=D("div",{cls:"insert-btns"}),o=D("button",{cls:"action-btn",text:"Block EACH",attrs:{"data-col":e.key,"data-type":"each"}}),i=D("button",{cls:"action-btn",text:"Table ROW",attrs:{"data-col":e.key,"data-type":"row"}});a.appendChild(o),a.appendChild(i),r.appendChild(a);for(const t of e.itemFields){const e=D("div",{cls:"item-field",attrs:{"data-item":t.key}});e.innerHTML=`<span class="field-key" style="font-size:10px;">ITEM.${t.key}</span><span class="field-desc">${t.description}</span>`,r.appendChild(e)}t.appendChild(n),t.appendChild(r),Z.appendChild(t)}}function fe(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}const Re=new Set(I.map(e=>e.key.toUpperCase())),Se=new Set(A.map(e=>e.key.toUpperCase())),ke=new Set(N.map(e=>e.key.toUpperCase())),_e=new Set(L.map(e=>e.suffix.toUpperCase())),Ie=new Set;for(const e of N)for(const t of e.itemFields)Ie.add(t.key.toUpperCase());function Ae(e){ye=e,function(){ye.innerHTML="";const e=D("button",{cls:"validate-btn",text:"Scan Document"});e.addEventListener("click",Ne),ye.appendChild(e),ye.appendChild(D("div",{cls:"field-desc",html:"Click <strong>Scan Document</strong> to find all placeholders and check for errors."}))}()}function xe(e){}async function Ne(){ye.innerHTML="";const e=D("div",{cls:"field-desc",text:"Scanning document..."});ye.appendChild(e);try{const e=(await async function(){const e=[];return await Word.run(async t=>{const n=t.document.body.paragraphs;n.load("text"),await t.sync();for(let t=0;t<n.items.length;t++)e.push(n.items[t].text)}),e}()).join("\n"),t=[];let n=0,r=0,a=0;const o=/\{\{([^}]+)\}\}/g;let i;const s=[];let d=0;for(;null!==(i=o.exec(e));){const e=i[1].trim();if(e.startsWith("#IF ")||e.startsWith("#UNLESS ")){const n=e.replace(/^#(IF|UNLESS)\s+/,"").trim();s.push({type:e.startsWith("#UNLESS")?"UNLESS":"IF",key:n}),r++;const a=n.split(/\s+(?:OR|AND)\s+/i);for(const e of a){const n=e.replace(/\s*[><=!]+\s*\S+$/,"").trim();Se.has(n.toUpperCase())||Re.has(n.toUpperCase())||ke.has(n.toUpperCase())||n.startsWith("ITEM.")||t.push({type:"warning",message:`Unknown condition: ${n}`,detail:i[0]}),n.toUpperCase().startsWith("ITEM.")&&0===d&&t.push({type:"error",message:`Condition ${n} used outside of {{#EACH}} loop`,detail:i[0]})}}else if("#ELSE"===e)if(0===s.length)t.push({type:"error",message:"{{#ELSE}} found outside of any IF/UNLESS block",detail:i[0]});else{const e=s[s.length-1];"IF"!==e.type&&"UNLESS"!==e.type&&t.push({type:"error",message:`{{#ELSE}} inside {{#${e.type} ${e.key}}} — ELSE is only valid inside IF/UNLESS`,detail:i[0]})}else if(e.startsWith("/IF ")||"/IF"===e)if(s.length>0){const e=s[s.length-1];"IF"===e.type||"UNLESS"===e.type?s.pop():t.push({type:"error",message:`Nesting error: {{/IF}} closes a {{#${e.type} ${e.key}}} block`,detail:i[0]})}else t.push({type:"error",message:`Unmatched closing: ${i[0]}`,detail:i[0]});else if(e.startsWith("#EACH ")||e.startsWith("#ROW ")){const n=e.replace(/^#(EACH|ROW)\s+/,"").trim();s.push({type:e.startsWith("#ROW")?"ROW":"EACH",key:n}),a++,d++,ke.has(n.toUpperCase())||t.push({type:"warning",message:`Unknown collection: ${n}`,detail:i[0]})}else if(e.startsWith("/EACH")||e.startsWith("/ROW")){const n=e.startsWith("/ROW")?"ROW":"EACH";if(s.length>0){const e=s[s.length-1];e.type===n?(s.pop(),d--):t.push({type:"error",message:`Nesting error: {{/${n}}} closes a {{#${e.type} ${e.key}}} block`,detail:i[0]})}else t.push({type:"error",message:`Unmatched closing: ${i[0]}`,detail:i[0]})}else if(e.startsWith("ITEM.")||e.startsWith("item.")){const r=e.replace(/^item\./i,"").split(":")[0].trim().toUpperCase();n++,0===d&&t.push({type:"error",message:`ITEM.${r} used outside of {{#EACH}} loop`,detail:i[0]}),Ie.has(r)||t.push({type:"warning",message:`Unknown item field: ITEM.${r}`,detail:i[0]})}else if(!e.startsWith("#")&&!e.startsWith("/")){n++;const r=e.split(":"),a=r[0].trim().toUpperCase(),o=r[1]?.trim().toUpperCase();Re.has(a)||Se.has(a)||t.push({type:"warning",message:`Unknown field: ${a}`,detail:i[0]}),o&&!_e.has(o)&&t.push({type:"warning",message:`Unknown format: ${o}`,detail:i[0]})}}for(const e of s){const n="UNLESS"===e.type?"IF":e.type;t.push({type:"error",message:`Unclosed ${e.type} block: ${e.key}`,detail:`Missing {{/${n} ${e.key}}}`})}ye.innerHTML="";const c=D("button",{cls:"validate-btn",text:"Re-scan Document"});c.addEventListener("click",Ne),ye.appendChild(c);const p=t.filter(e=>"error"===e.type).length,l=t.filter(e=>"warning"===e.type).length,y=p>0?"errors":"success",g=0===p&&0===l?`${n} fields, ${r} conditions, ${a} loops — No issues found`:`${n} fields, ${r} conditions, ${a} loops — ${p} error${1!==p?"s":""}, ${l} warning${1!==l?"s":""}`;if(ye.appendChild(D("div",{cls:`validate-summary ${y}`,text:g})),0===a&&0===p){const t=["PROPERTY_","BORROWER_","LENDER_","GUARANTOR_","BROKER_","ENTITY_OWNER_","ASSIGNEE_","FEE_"];if((e.match(/\{\{([^}]+)\}\}/g)||[]).some(e=>{const n=e.replace(/\{\{|\}\}/g,"").trim().split(":")[0].toUpperCase();return t.some(e=>n.startsWith(e))})){const e=D("div",{cls:"validate-info"});e.innerHTML='<span style="color:#92400e;font-weight:600;">Tip:</span> This template uses collection-derived fields (e.g., PROPERTY_*, BORROWER_*) without EACH loops. If configured as a <strong>Multiply By</strong> template in the admin panel, each copy will automatically receive per-item data.',ye.appendChild(e)}}for(const e of t){const t=D("div",{cls:"issue-card"});t.innerHTML=`\n        <div class="issue-type ${e.type}">${e.type}</div>\n        <div class="issue-text">${e.message}</div>\n        <div class="issue-detail">${e.detail}</div>\n      `,t.addEventListener("click",async()=>{he(await w(e.detail)?`Navigated to: ${e.detail}`:"Could not locate in document")}),ye.appendChild(t)}he(`Scan complete: ${n} fields, ${t.length} issues`)}catch(e){ye.innerHTML="",ye.appendChild(D("div",{cls:"validate-summary errors",text:`Error scanning: ${e}`}))}}function he(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}let be,Oe,Pe,Ce,Le;function ve(e){be=e,function(){be.innerHTML="";const e=D("div",{cls:"ref-section"});e.innerHTML='\n    <h3>Placeholder Syntax</h3>\n    <div class="ref-row"><span class="ref-syntax">{{FIELD}}</span><span class="ref-explain">Simple field replacement</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{FIELD:FORMAT}}</span><span class="ref-explain">Formatted field (e.g., :CURRENCY, :WORDS)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF FLAG}}</span><span class="ref-explain">Start conditional block</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{/IF FLAG}}</span><span class="ref-explain">End conditional block</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF A and B}}</span><span class="ref-explain">AND &mdash; both must be true</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF A or B}}</span><span class="ref-explain">OR &mdash; either can be true</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF A and B or C}}</span><span class="ref-explain">AND binds tighter: (A AND B) OR C</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF KEY == "val"}}</span><span class="ref-explain">Field comparison (==, !=, &gt;, &gt;=, &lt;, &lt;=)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF KEY IN "a,b,c"}}</span><span class="ref-explain">True if KEY matches any listed value</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#UNLESS FLAG}}</span><span class="ref-explain">Negated conditional (show when false)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#ELSE}}</span><span class="ref-explain">Else branch inside IF block</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#EACH COLL}}</span><span class="ref-explain">Loop over collection (paragraph-level)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{/EACH COLL}}</span><span class="ref-explain">End loop</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#ROW COLL}}</span><span class="ref-explain">Loop table rows</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{ITEM.FIELD}}</span><span class="ref-explain">Field inside a loop</span></div>\n  ',be.appendChild(e);const t=D("div",{cls:"ref-section"});let n="<h3>Format Specifiers</h3>";for(const e of L)n+=`<div class="ref-row"><span class="ref-syntax">:${e.suffix}</span><span class="ref-explain">${e.description} &mdash; <em>${e.example}</em></span></div>`;t.innerHTML=n,be.appendChild(t);const r=D("div",{cls:"ref-section"});r.innerHTML='\n    <h3>Tips</h3>\n    <div class="ref-row"><span class="ref-explain"><strong>Case-insensitive</strong> &mdash; {{loan_amount}}, {{LOAN_AMOUNT}}, {{Loan_Amount}} all work</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Whitespace-tolerant</strong> &mdash; {{ FIELD }} and {{FIELD}} both work</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Block vs Inline IF</strong> &mdash; If opening and closing tags are in the <em>same</em> paragraph, only text between them is toggled. If in <em>different</em> paragraphs, entire paragraphs are removed.</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Split runs</strong> &mdash; Word may split {{FIELD}} across multiple XML runs. The engine normalizes this automatically.</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Content Controls</strong> &mdash; You can also use Word Content Controls with a Tag matching the field name.</span></div>\n  ',be.appendChild(r);const a=D("div",{cls:"ref-section"});a.innerHTML='\n    <h3>Loop Meta Fields</h3>\n    <div class="ref-row"><span class="ref-syntax">ITEM.INDEX</span><span class="ref-explain">1-based position (1, 2, 3...)</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.IS_FIRST</span><span class="ref-explain">"true" for the first item</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.IS_LAST</span><span class="ref-explain">"true" for the last item</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.COUNT</span><span class="ref-explain">Total items in collection</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.SEPARATOR</span><span class="ref-explain">Smart comma+and: "A, B, and C"</span></div>\n  ',be.appendChild(a)}()}function Fe(e){}["INDEX","IS_FIRST","IS_LAST","COUNT","SEPARATOR"].forEach(e=>Ie.add(e));let we=!1;const De=["What field for borrower name?","How to conditionally show a section?","Show me a ROW table example","What conditions for construction loans?"];function Me(e){Oe=e,Oe.innerHTML=`\n    <div class="ask-quick-section">\n      <div class="ask-section-label">Quick Questions</div>\n      <div class="ask-chips">\n        ${De.map(e=>`<button class="ask-chip" data-quick="${M(e)}">${M(e)}</button>`).join("")}\n      </div>\n    </div>\n    <div class="ask-input-row">\n      <input type="text" class="ask-input" placeholder="Ask about fields, conditions, syntax..." autocomplete="off" maxlength="500" />\n      <button class="ask-send-btn" title="Send">&#9654;</button>\n    </div>\n    <div class="ask-response"></div>\n  `,Pe=Oe.querySelector(".ask-input"),Ce=Oe.querySelector(".ask-response"),Le=Oe.querySelector(".ask-send-btn"),Pe&&Pe.addEventListener("keydown",e=>{"Enter"===e.key&&!e.shiftKey&&Pe.value.trim()&&(e.preventDefault(),Ye(Pe.value.trim()))}),U(Oe,"[data-quick]",e=>{const t=e.getAttribute("data-quick");t&&Ye(t)}),U(Oe,".ask-send-btn",()=>{Pe?.value.trim()&&Ye(Pe.value.trim())}),U(Oe,"[data-insert-field]",async e=>{const t=e.getAttribute("data-insert-field")||"";try{await F(t),Ge(`Inserted ${t}`)}catch{Ge("Insert failed")}}),Pe=Oe.querySelector(".ask-input"),Ce=Oe.querySelector(".ask-response"),Le=Oe.querySelector(".ask-send-btn"),Pe&&Pe.addEventListener("keydown",e=>{"Enter"===e.key&&!e.shiftKey&&Pe.value.trim()&&(e.preventDefault(),Ye(Pe.value.trim()))})}function Ue(e){}async function Ye(e){if(!we){we=!0,Pe&&(Pe.value=e),Ce&&(Ce.innerHTML='\n    <div class="ask-loading">\n      <div class="ask-spinner"></div>\n      <span>Thinking...</span>\n    </div>\n  '),Ge("Asking AI...");try{const t=await async function(e){const t=await fetch(`${b()}/api/catalog/ask`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})});if(!t.ok){const e=await t.text();throw new Error(e||`Error ${t.status}`)}return(await t.json()).answer}(e);!function(e,t){Ce&&(Ce.innerHTML=`<div class="ask-answer">${function(e){let t=M(e);return t=t.replace(/`(\{\{[^`]+?\}\})`/g,(e,t)=>{const n=t.trim();return`<button class="ask-field-chip" data-insert-field="${M(n)}" title="Click to insert">${M(n)}</button>`}),t=t.replace(/`([^`]+?)`/g,(e,t)=>`<code class="ask-code">${M(t)}</code>`),t=t.replace(/\n/g,"<br>"),t}(t)}</div>`)}(0,t),Ge("Ready")}catch(e){t=e instanceof Error?e.message:"Unknown error",Ce&&(Ce.innerHTML=`\n    <div class="ask-error">\n      Could not get a response. ${M(t)}\n    </div>\n  `),Ge("Error")}finally{we=!1,Pe&&(Pe.value="",Pe.focus())}}var t}function Ge(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}const He={fields:r,conditions:a,loops:o,validate:i,reference:s,ask:d};let Be="fields",We=null;function $e(e){Be=e,document.querySelectorAll("#tab-bar .tab").forEach(t=>{t.classList.toggle("active",t.getAttribute("data-tab")===e)}),document.querySelectorAll(".tab-panel").forEach(t=>{t.classList.toggle("active",t.id===`tab-${e}`)});const t=document.getElementById("search-input");t&&t.value&&(t.value="",He[e]?.search(""))}Office.onReady(e=>{e.host===Office.HostType.Word&&function(){const e=document.getElementById("tab-bar");e&&e.addEventListener("click",e=>{const t=e.target.closest("[data-tab]");if(!t)return;const n=t.getAttribute("data-tab");n&&n!==Be&&$e(n)});const t=document.getElementById("search-input");t&&t.addEventListener("input",()=>{We&&clearTimeout(We),We=setTimeout(()=>{const e=t.value.trim();He[Be]?.search(e)},200)});for(const[e,t]of Object.entries(He)){const n=document.getElementById(`tab-${e}`);n&&t.init(n)}$e("fields"),function(){const e=document.getElementById("status-text");e&&(e.textContent="Ready — click a field to insert")}()}()})})();