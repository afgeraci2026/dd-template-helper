(()=>{"use strict";var e={942(e,t,n){n.d(t,{A:()=>s});var r=n(601),i=n.n(r),o=n(314),a=n.n(o)()(i());a.push([e.id,'/* ══════════════════════════════════════════════════════════\n   Automate Loan Docs Template Helper — Taskpane Styles\n   Brand: Midnight Slate, Steel Blue, Paper White\n   ══════════════════════════════════════════════════════════ */\n\n:root {\n  --midnight: #0F1720;\n  --steel: #2C3F52;\n  --gunmetal: #8E949A;\n  --chrome: #C7CCD1;\n  --charcoal: #1C1F23;\n  --graphite: #3A3F45;\n  --paper: #F5F7FA;\n  --cta: #223447;\n  --cta-hover: #3E566E;\n  --mono: "Consolas", "IBM Plex Mono", monospace;\n  --sans: "Segoe UI", "Inter", sans-serif;\n}\n\n* { margin: 0; padding: 0; box-sizing: border-box; }\n\nhtml, body {\n  height: 100%;\n  font-family: var(--sans);\n  font-size: 12px;\n  color: var(--charcoal);\n  background: var(--paper);\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n/* ── Header ────────────────────────────────────────────── */\n#header {\n  background: var(--midnight);\n  padding: 10px 12px;\n  flex-shrink: 0;\n}\n\n.header-brand {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.header-logo {\n  background: var(--steel);\n  color: white;\n  font-weight: 800;\n  font-size: 11px;\n  width: 24px;\n  height: 24px;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.header-title {\n  color: white;\n  font-weight: 600;\n  font-size: 13px;\n}\n\n/* ── Search ────────────────────────────────────────────── */\n#search-bar {\n  padding: 8px 12px;\n  background: white;\n  border-bottom: 1px solid var(--chrome);\n  flex-shrink: 0;\n}\n\n#search-input {\n  width: 100%;\n  padding: 6px 10px;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  font-size: 12px;\n  font-family: var(--sans);\n  outline: none;\n  background: var(--paper);\n}\n\n#search-input:focus {\n  border-color: var(--cta);\n}\n\n/* ── Tab Bar ───────────────────────────────────────────── */\n#tab-bar {\n  display: flex;\n  background: var(--steel);\n  flex-shrink: 0;\n}\n\n.tab {\n  flex: 1;\n  padding: 7px 4px;\n  background: none;\n  border: none;\n  border-bottom: 2px solid transparent;\n  color: rgba(255,255,255,0.6);\n  font-size: 10px;\n  font-weight: 600;\n  font-family: var(--sans);\n  cursor: pointer;\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  transition: all 0.15s;\n}\n\n.tab:hover {\n  color: rgba(255,255,255,0.85);\n}\n\n.tab.active {\n  color: white;\n  border-bottom-color: white;\n}\n\n/* ── Tab Content ───────────────────────────────────────── */\n#tab-content {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n.tab-panel {\n  display: none;\n  padding: 8px;\n}\n\n.tab-panel.active {\n  display: block;\n}\n\n/* ── Accordion Category ────────────────────────────────── */\n.category {\n  margin-bottom: 4px;\n}\n\n.category-header {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 8px;\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 11px;\n  font-weight: 600;\n  color: var(--steel);\n  user-select: none;\n  transition: background 0.1s;\n}\n\n.category-header:hover {\n  background: var(--paper);\n}\n\n.category-header .arrow {\n  font-size: 8px;\n  transition: transform 0.15s;\n  color: var(--gunmetal);\n}\n\n.category.open .category-header .arrow {\n  transform: rotate(90deg);\n}\n\n.category-header .count {\n  margin-left: auto;\n  background: var(--paper);\n  color: var(--gunmetal);\n  padding: 1px 5px;\n  border-radius: 8px;\n  font-size: 9px;\n  font-weight: 700;\n}\n\n.category-body {\n  display: none;\n  padding: 2px 0;\n}\n\n.category.open .category-body {\n  display: block;\n}\n\n/* ── Field Item ────────────────────────────────────────── */\n.field-item {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 5px 8px 5px 20px;\n  cursor: pointer;\n  border-radius: 3px;\n  transition: background 0.1s;\n}\n\n.field-item:hover {\n  background: rgba(34, 52, 71, 0.06);\n}\n\n.field-key {\n  font-family: var(--mono);\n  font-size: 10.5px;\n  font-weight: 600;\n  color: var(--cta);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 170px;\n}\n\n.field-desc {\n  font-size: 10px;\n  color: var(--gunmetal);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  flex: 1;\n}\n\n/* ── Format Picker (inline) ────────────────────────────── */\n.format-picker {\n  display: none;\n  padding: 4px 20px 8px;\n  gap: 4px;\n  flex-wrap: wrap;\n}\n\n.format-picker.open {\n  display: flex;\n}\n\n.format-btn {\n  padding: 2px 8px;\n  font-size: 9px;\n  font-family: var(--mono);\n  font-weight: 600;\n  background: var(--paper);\n  border: 1px solid var(--chrome);\n  border-radius: 3px;\n  cursor: pointer;\n  color: var(--steel);\n  transition: all 0.1s;\n}\n\n.format-btn:hover {\n  background: var(--cta);\n  color: white;\n  border-color: var(--cta);\n}\n\n/* ── Unified Condition Builder ─────────────────────────── */\n.builder-box {\n  background: white;\n  border: 1px solid var(--steel);\n  border-radius: 6px;\n  padding: 8px 10px;\n  margin-bottom: 8px;\n}\n\n.builder-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 6px;\n}\n\n.builder-label {\n  font-size: 10px;\n  font-weight: 700;\n  color: var(--steel);\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n}\n\n.builder-clear-btn {\n  padding: 2px 8px;\n  font-size: 9px;\n  font-weight: 600;\n  font-family: var(--sans);\n  background: white;\n  border: 1px solid #dc2626;\n  border-radius: 3px;\n  color: #dc2626;\n  cursor: pointer;\n  transition: all 0.1s;\n}\n\n.builder-clear-btn:hover {\n  background: #dc2626;\n  color: white;\n}\n\n.builder-empty {\n  font-size: 10px;\n  color: var(--gunmetal);\n  padding: 4px 0 2px;\n}\n\n.builder-parts {\n  padding: 4px 0;\n}\n\n.builder-chip {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  padding: 3px 6px 3px 8px;\n  background: var(--paper);\n  border: 1px solid var(--chrome);\n  border-radius: 12px;\n  font-family: var(--mono);\n  font-size: 10.5px;\n  font-weight: 600;\n  color: var(--cta);\n  max-width: 100%;\n  margin-bottom: 2px;\n}\n\n.chip-text {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.chip-remove {\n  background: none;\n  border: none;\n  font-size: 13px;\n  font-weight: 700;\n  color: var(--gunmetal);\n  cursor: pointer;\n  padding: 0 2px;\n  line-height: 1;\n  flex-shrink: 0;\n}\n\n.chip-remove:hover {\n  color: #dc2626;\n}\n\n.builder-join-toggle {\n  display: block;\n  margin: 3px auto;\n  padding: 1px 12px;\n  font-size: 9px;\n  font-weight: 700;\n  font-family: var(--sans);\n  background: var(--steel);\n  color: white;\n  border: none;\n  border-radius: 10px;\n  cursor: pointer;\n  letter-spacing: 0.5px;\n  transition: background 0.1s;\n}\n\n.builder-join-toggle:hover {\n  background: var(--cta-hover);\n}\n\n.builder-preview {\n  font-family: var(--mono);\n  font-size: 10px;\n  font-weight: 600;\n  color: var(--cta);\n  background: var(--paper);\n  border: 1px solid var(--chrome);\n  border-radius: 3px;\n  padding: 6px 8px;\n  margin: 6px 0;\n  word-break: break-all;\n  white-space: pre-wrap;\n}\n\n.builder-insert-actions {\n  display: flex;\n  gap: 4px;\n  flex-wrap: wrap;\n}\n\n.builder-insert-btn {\n  padding: 3px 8px;\n  font-size: 10px;\n  font-weight: 600;\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 3px;\n  cursor: pointer;\n  color: var(--steel);\n  font-family: var(--sans);\n  transition: all 0.1s;\n}\n\n.builder-insert-btn:hover {\n  background: var(--cta);\n  color: white;\n  border-color: var(--cta);\n}\n\n/* ── Builder Inputs (custom + comparison) ─────────────── */\n.builder-inputs {\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 6px;\n  padding: 8px 10px;\n  margin-bottom: 8px;\n}\n\n.input-row {\n  display: flex;\n  gap: 4px;\n  margin-bottom: 4px;\n}\n\n.input-row:last-child {\n  margin-bottom: 0;\n}\n\n.builder-input {\n  flex: 1;\n  padding: 5px 8px;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  font-size: 11px;\n  font-family: var(--mono);\n  font-weight: 600;\n  color: var(--cta);\n  background: var(--paper);\n  outline: none;\n  text-transform: uppercase;\n}\n\n.builder-input:focus {\n  border-color: var(--cta);\n}\n\n.builder-input::placeholder {\n  text-transform: none;\n  font-weight: 400;\n  color: var(--gunmetal);\n}\n\n.builder-add-btn {\n  flex-shrink: 0;\n  width: 28px;\n  height: 28px;\n  padding: 0;\n  font-size: 16px;\n  font-weight: 700;\n  font-family: var(--sans);\n  background: var(--steel);\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background 0.1s;\n}\n\n.builder-add-btn:hover {\n  background: var(--cta);\n}\n\n/* ── Condition Item ────────────────────────────────────── */\n.condition-item {\n  display: flex;\n  align-items: center;\n  padding: 5px 8px 5px 20px;\n  cursor: pointer;\n  border-radius: 3px;\n  transition: background 0.1s;\n}\n\n.condition-item:hover {\n  background: rgba(34, 52, 71, 0.06);\n}\n\n.condition-item .add-hint {\n  margin-left: auto;\n  font-size: 14px;\n  font-weight: 700;\n  color: var(--chrome);\n  opacity: 0;\n  transition: opacity 0.15s;\n  flex-shrink: 0;\n  padding-left: 4px;\n}\n\n.condition-item:hover .add-hint {\n  opacity: 1;\n  color: var(--steel);\n}\n\n/* ── Catalog section ──────────────────────────────────── */\n.catalog-section {\n  /* no extra styles needed, just a container */\n}\n\n/* ── Loop / Collection Card ────────────────────────────── */\n.collection-card {\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 6px;\n  margin-bottom: 6px;\n  overflow: hidden;\n}\n\n.collection-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 10px;\n  cursor: pointer;\n  font-weight: 600;\n  font-size: 11px;\n  color: var(--steel);\n}\n\n.collection-header .arrow {\n  font-size: 8px;\n  color: var(--gunmetal);\n  transition: transform 0.15s;\n}\n\n.collection-card.open .collection-header .arrow {\n  transform: rotate(90deg);\n}\n\n.collection-body {\n  display: none;\n  padding: 0 10px 8px;\n}\n\n.collection-card.open .collection-body {\n  display: block;\n}\n\n.collection-desc {\n  font-size: 10px;\n  color: var(--gunmetal);\n  margin-bottom: 6px;\n}\n\n.insert-btns {\n  display: flex;\n  gap: 4px;\n  margin-bottom: 6px;\n}\n\n.item-field {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 3px 6px;\n  cursor: pointer;\n  border-radius: 3px;\n  transition: background 0.1s;\n}\n\n.item-field:hover {\n  background: rgba(34, 52, 71, 0.06);\n}\n\n/* ── Validate Tab ──────────────────────────────────────── */\n.validate-btn {\n  width: 100%;\n  padding: 10px;\n  background: var(--cta);\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 12px;\n  font-weight: 700;\n  font-family: var(--sans);\n  cursor: pointer;\n  margin-bottom: 10px;\n  transition: background 0.15s;\n}\n\n.validate-btn:hover {\n  background: var(--cta-hover);\n}\n\n.validate-summary {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 10px;\n  border-radius: 6px;\n  font-size: 11px;\n  font-weight: 600;\n  margin-bottom: 8px;\n}\n\n.validate-summary.success {\n  background: #ecfdf5;\n  color: #065f46;\n  border: 1px solid #a7f3d0;\n}\n\n.validate-summary.errors {\n  background: #fef2f2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n}\n\n.validate-info {\n  padding: 8px 10px;\n  border-radius: 6px;\n  font-size: 11px;\n  margin-bottom: 8px;\n  background: #fffbeb;\n  color: #78350f;\n  border: 1px solid #fde68a;\n  line-height: 1.5;\n}\n\n.issue-card {\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  padding: 6px 8px;\n  margin-bottom: 4px;\n  cursor: pointer;\n  transition: background 0.1s;\n}\n\n.issue-card:hover {\n  background: #fef2f2;\n}\n\n.issue-type {\n  font-size: 9px;\n  font-weight: 700;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  margin-bottom: 2px;\n}\n\n.issue-type.error { color: #dc2626; }\n.issue-type.warning { color: #d97706; }\n\n.issue-text {\n  font-size: 11px;\n  color: var(--charcoal);\n}\n\n.issue-detail {\n  font-size: 10px;\n  color: var(--gunmetal);\n  font-family: var(--mono);\n  margin-top: 2px;\n}\n\n.issue-suggestion-row {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-top: 4px;\n  gap: 6px;\n}\n\n.issue-suggestion {\n  font-size: 10px;\n  color: #065f46;\n  line-height: 1.4;\n}\n\n.issue-suggestion code {\n  font-family: var(--mono);\n  background: #ecfdf5;\n  padding: 1px 4px;\n  border-radius: 2px;\n  font-size: 10px;\n}\n\n.issue-fix-btn {\n  font-size: 10px;\n  padding: 2px 10px;\n  background: #065f46;\n  color: white;\n  border: none;\n  border-radius: 3px;\n  cursor: pointer;\n  font-family: var(--sans);\n  font-weight: 600;\n  white-space: nowrap;\n  flex-shrink: 0;\n  transition: background 0.15s;\n}\n\n.issue-fix-btn:hover { background: #047857; }\n.issue-fix-btn.fixed { background: #a7f3d0; color: #065f46; cursor: default; }\n\n.issue-card.fixed {\n  opacity: 0.55;\n  border-color: #a7f3d0;\n}\n\n.issue-type.fixed-label { color: #065f46; }\n\n.fix-all-btn {\n  font-size: 10px;\n  padding: 3px 10px;\n  background: #065f46;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-family: var(--sans);\n  font-weight: 600;\n  white-space: nowrap;\n  margin-left: auto;\n  transition: background 0.15s;\n}\n\n.fix-all-btn:hover { background: #047857; }\n.fix-all-btn.fixed { background: #a7f3d0; color: #065f46; cursor: default; }\n\n/* ── Reference Tab ─────────────────────────────────────── */\n.ref-section {\n  margin-bottom: 12px;\n}\n\n.ref-section h3 {\n  font-size: 11px;\n  font-weight: 700;\n  color: var(--steel);\n  margin-bottom: 4px;\n  padding-bottom: 2px;\n  border-bottom: 1px solid var(--chrome);\n}\n\n.ref-row {\n  display: flex;\n  padding: 3px 0;\n  font-size: 10.5px;\n}\n\n.ref-syntax {\n  font-family: var(--mono);\n  font-weight: 600;\n  color: var(--cta);\n  min-width: 130px;\n}\n\n.ref-explain {\n  color: var(--graphite);\n  flex: 1;\n}\n\n/* ── Ask AI Tab ────────────────────────────────────────── */\n.ask-section-label {\n  font-size: 10px;\n  font-weight: 700;\n  color: var(--steel);\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  margin-bottom: 6px;\n}\n\n.ask-chips {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 4px;\n  margin-bottom: 10px;\n}\n\n.ask-chip {\n  padding: 4px 10px;\n  font-size: 10px;\n  font-weight: 600;\n  font-family: var(--sans);\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 12px;\n  cursor: pointer;\n  color: var(--steel);\n  transition: all 0.1s;\n}\n\n.ask-chip:hover {\n  background: var(--cta);\n  color: white;\n  border-color: var(--cta);\n}\n\n.ask-input-row {\n  display: flex;\n  align-items: flex-end;\n  gap: 4px;\n  margin-bottom: 10px;\n}\n\n.ask-input {\n  flex: 1;\n  padding: 7px 10px;\n  border: 1px solid var(--chrome);\n  border-radius: 4px;\n  font-size: 12px;\n  font-family: var(--sans);\n  outline: none;\n  background: white;\n  resize: none;\n  overflow-y: auto;\n  min-height: 36px;\n  max-height: 120px;\n  line-height: 1.4;\n}\n\n.ask-input:focus {\n  border-color: var(--cta);\n}\n\n.ask-send-btn {\n  flex-shrink: 0;\n  width: 32px;\n  height: 36px;\n  padding: 0;\n  font-size: 14px;\n  background: var(--cta);\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background 0.1s;\n}\n\n.ask-send-btn:hover {\n  background: var(--cta-hover);\n}\n\n.ask-loading {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px 0;\n  font-size: 11px;\n  color: var(--gunmetal);\n}\n\n.ask-spinner {\n  width: 16px;\n  height: 16px;\n  border: 2px solid var(--chrome);\n  border-top-color: var(--cta);\n  border-radius: 50%;\n  animation: ask-spin 0.6s linear infinite;\n}\n\n@keyframes ask-spin {\n  to { transform: rotate(360deg); }\n}\n\n.ask-answer {\n  font-size: 11px;\n  line-height: 1.6;\n  color: var(--charcoal);\n  padding: 10px 12px;\n  background: white;\n  border: 1px solid var(--chrome);\n  border-radius: 6px;\n  word-break: break-word;\n}\n\n.ask-answer code.ask-code {\n  font-family: var(--mono);\n  font-size: 10.5px;\n  font-weight: 600;\n  background: var(--paper);\n  padding: 1px 4px;\n  border-radius: 3px;\n  color: var(--cta);\n}\n\n.ask-field-chip {\n  display: inline-block;\n  padding: 2px 8px;\n  font-family: var(--mono);\n  font-size: 10.5px;\n  font-weight: 600;\n  background: var(--paper);\n  border: 1px solid var(--cta);\n  border-radius: 12px;\n  color: var(--cta);\n  cursor: pointer;\n  transition: all 0.1s;\n  vertical-align: baseline;\n}\n\n.ask-field-chip:hover {\n  background: var(--cta);\n  color: white;\n}\n\n.ask-error {\n  font-size: 11px;\n  padding: 10px 12px;\n  background: #fef2f2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n  border-radius: 6px;\n}\n\n/* ── Status Bar ────────────────────────────────────────── */\n#status-bar {\n  background: var(--midnight);\n  color: var(--gunmetal);\n  padding: 4px 12px;\n  font-size: 10px;\n  flex-shrink: 0;\n}\n\n/* ── Scrollbar ─────────────────────────────────────────── */\n#tab-content::-webkit-scrollbar { width: 5px; }\n#tab-content::-webkit-scrollbar-track { background: transparent; }\n#tab-content::-webkit-scrollbar-thumb { background: var(--chrome); border-radius: 3px; }\n',""]);const s=a},314(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var d=0;d<e.length;d++){var p=[].concat(e[d]);r&&a[p[0]]||(void 0!==o&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=o),n&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=n):p[2]=n),i&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=i):p[4]="".concat(i)),t.push(p))}},t}},601(e){e.exports=function(e){return e[1]}},72(e){var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},a=[],s=0;s<e.length;s++){var c=e[s],d=r.base?c[0]+r.base:c[0],p=o[d]||0,y="".concat(d," ").concat(p);o[d]=p+1;var l=n(y),g={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==l)t[l].references++,t[l].updater(g);else{var u=i(g,r);r.byIndex=s,t.splice(s,0,{identifier:y,updater:u,references:1})}a.push(y)}return a}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var o=r(e=e||[],i=i||{});return function(e){e=e||[];for(var a=0;a<o.length;a++){var s=n(o[a]);t[s].references--}for(var c=r(e,i),d=0;d<o.length;d++){var p=n(o[d]);0===t[p].references&&(t[p].updater(),t.splice(p,1))}o=c}}},659(e){var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56(e,t,n){e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var r={};n.r(r),n.d(r,{init:()=>$,search:()=>z});var i={};n.r(i),n.d(i,{init:()=>se,search:()=>ce});var o={};n.r(o),n.d(o,{init:()=>Ee,search:()=>me});var a={};n.r(a),n.d(a,{init:()=>Fe,search:()=>we});var s={};n.r(s),n.d(s,{init:()=>Ge,search:()=>He});var c={};n.r(c),n.d(c,{init:()=>$e,search:()=>ze});var d=n(72),p=n.n(d),y=n(825),l=n.n(y),g=n(659),u=n.n(g),T=n(56),E=n.n(T),m=n(540),f=n.n(m),S=n(113),R=n.n(S),k=n(942),_={};_.styleTagTransform=R(),_.setAttributes=E(),_.insert=u().bind(null,"head"),_.domAPI=l(),_.insertStyleElement=f(),p()(k.A,_),k.A&&k.A.locals&&k.A.locals;const A=[{key:"LOAN_AMOUNT",description:"Principal loan amount",category:"Core Loan Terms",dataType:"money",suggestedFormats:["CURRENCY","WORDS","CENTS"]},{key:"INTEREST_RATE",description:"Annual interest rate",category:"Core Loan Terms",dataType:"rate",suggestedFormats:["DECIMAL2","PERCENT","WORDS"]},{key:"DEFAULT_RATE",description:"Default interest rate",category:"Core Loan Terms",dataType:"rate",suggestedFormats:["DECIMAL2","PERCENT","WORDS"]},{key:"TERM_MONTHS",description:"Loan term in months",category:"Core Loan Terms",dataType:"number",suggestedFormats:["WORDS"]},{key:"AMORTIZATION_TYPE",description:"Amortization type (IO, Fully Amortized, etc.)",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"REPAYMENT_SCHEDULE",description:"Payment frequency (Monthly, Quarterly, etc.)",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"LOAN_TYPE",description:"Loan type code (bridge, dscr, construction, etc.)",category:"Core Loan Terms",dataType:"text",suggestedFormats:["UPPER"]},{key:"LOAN_NAME",description:"Loan name/identifier",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"LOAN_NUMBER",description:"Loan number (dedicated field; falls back to loan name if empty)",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"IO_MONTHS",description:"Interest-only period in months",category:"Core Loan Terms",dataType:"number",suggestedFormats:["WORDS"]},{key:"PAYMENT_TYPE_DESCRIPTION",description:"Descriptive text for payment type",category:"Core Loan Terms",dataType:"text",suggestedFormats:[]},{key:"AMORT_PERIOD",description:"Amortization period in months",category:"Core Loan Terms",dataType:"number",suggestedFormats:[]},{key:"AMORT_PERIOD_AFTER_IO",description:"Amortization months after IO period",category:"Core Loan Terms",dataType:"number",suggestedFormats:[]},{key:"AMORT_SCHEDULE_MONTHS",description:"Partial amortization schedule months",category:"Core Loan Terms",dataType:"number",suggestedFormats:[]},{key:"EFFECTIVE_DATE",description:"Loan effective/origination date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"ORIGINATION_DATE",description:"Loan origination date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"ORIGINATION_DATE_LONG",description:"Origination date (pre-formatted long)",category:"Dates",dataType:"text",suggestedFormats:[]},{key:"TODAY",description:"Current date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"CLOSING_DATE",description:"Closing date (if set)",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"PAYMENT_START_DATE",description:"First payment date (month after origination)",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"MATURITY_DATE",description:"Loan maturity date",category:"Dates",dataType:"date",suggestedFormats:["LONGDATE","SHORTDATE"]},{key:"MATURITY_DATE_LONG",description:"Maturity date (pre-formatted long)",category:"Dates",dataType:"text",suggestedFormats:[]},{key:"MONTHLY_PAYMENT",description:"Computed monthly payment amount",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"MONTHLY_PAYMENT_WORDS",description:"Monthly payment in English words",category:"Payment Calculations",dataType:"text",suggestedFormats:[]},{key:"MONTHLY_PAYMENT_CENTS",description:"Monthly payment cents portion",category:"Payment Calculations",dataType:"text",suggestedFormats:[]},{key:"IO_MONTHLY_PAYMENT",description:"Interest-only period payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"AMORT_MONTHLY_PAYMENT",description:"Amortized period payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"PARTIAL_AMORT_PAYMENT",description:"Partially amortized payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"BALLOON_PAYMENT",description:"Balloon payment at maturity",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"DAILY_INTEREST",description:"Daily interest amount (principal x rate / 360)",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"IO_PERIOD_END_MONTH",description:"Last month of IO period",category:"Payment Calculations",dataType:"number",suggestedFormats:[]},{key:"AMORT_START_MONTH",description:"First month of amortization",category:"Payment Calculations",dataType:"number",suggestedFormats:[]},{key:"FULL_PRINCIPAL_IO_PAYMENT",description:"IO payment on full principal (no holdback)",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"FULL_PRINCIPAL_AMORT_PAYMENT",description:"Amort payment on full principal (no holdback)",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"DSR_MONTHS_PAYMENT",description:"Debt service reserve months x payment",category:"Payment Calculations",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"LOAN_AMOUNT_WORDS",description:"Loan amount in English words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LOAN_AMOUNT_CENTS",description:"Loan amount cents portion",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LOAN_AMOUNT_DOUBLED",description:"Principal x 2 (mortgage max obligation)",category:"Words & Cents",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"INTEREST_RATE_WORDS",description:"Interest rate whole part in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"INTEREST_RATE_CENTS",description:"Interest rate decimal portion",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"DEFAULT_RATE_WORDS",description:"Default rate in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"DEFAULT_RATE_CENTS",description:"Default rate decimal portion",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LATE_CHARGE_PERCENT_WORDS",description:"Late charge percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LATE_CHARGE_DAYS_WORDS",description:"Late charge days in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"TERM_MONTHS_WORDS",description:"Term months in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"IO_MONTHS_WORDS",description:"IO months in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXIT_FEE_DOLLAR_WORDS",description:"Exit fee dollar amount in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXIT_FEE_PERCENT_WORDS",description:"Exit fee percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"TERMINATION_PERCENT_WORDS",description:"Termination percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_WORDS",description:"Construction holdback in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_CENTS",description:"Construction holdback cents",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXTENSION_COUNT_WORDS",description:"Extension count in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXTENSION_LENGTH_WORDS",description:"Extension length in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"EXTENSION_FEE_PERCENT_WORDS",description:"Extension fee percent in words",category:"Words & Cents",dataType:"text",suggestedFormats:[]},{key:"LATE_CHARGE_PERCENT",description:"Late charge percentage",category:"Late Charges",dataType:"rate",suggestedFormats:["PERCENT","DECIMAL2"]},{key:"LATE_CHARGE_DAYS",description:"Grace period days before late charge",category:"Late Charges",dataType:"number",suggestedFormats:["WORDS"]},{key:"STATE_CHOICE_OF_LAW",description:"Governing state for the loan",category:"Choice of Law",dataType:"text",suggestedFormats:["UPPER"]},{key:"COUNTY_CHOICE_OF_LAW",description:"Governing county",category:"Choice of Law",dataType:"text",suggestedFormats:[]},{key:"TITLE_COMPANY_NAME",description:"Title company name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"TITLE_OFFICER_NAME",description:"Title officer name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"TITLE_EMAIL",description:"Title officer email",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"TITLE_POLICY_AMOUNT",description:"Title policy coverage amount",category:"Title & Escrow",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"TITLE_POLICY_PERCENT",description:"Title policy coverage percentage",category:"Title & Escrow",dataType:"rate",suggestedFormats:["PERCENT"]},{key:"ESCROW_COMPANY_NAME",description:"Escrow company name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"ESCROW_OFFICER_NAME",description:"Escrow officer name",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"ESCROW_EMAIL",description:"Escrow officer email",category:"Title & Escrow",dataType:"text",suggestedFormats:[]},{key:"DOC_PREP_NAME",description:"Document preparer name",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"DOC_PREP_CLOSING_NAME",description:"Closing contact name",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"DOC_PREP_CLOSING_EMAIL",description:"Closing contact email",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"MATTER_NUMBER",description:"Matter/file number",category:"Doc Prep",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_NAME",description:"General contractor name",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_ADDRESS",description:"Contractor street address",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_CITY",description:"Contractor city",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_STATE",description:"Contractor state",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONTRACTOR_ZIP",description:"Contractor ZIP code",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGN_PROFESSIONAL_NAME",description:"Design professional/architect name",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_ADDRESS",description:"Designer street address",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_CITY",description:"Designer city",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_STATE",description:"Designer state",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DESIGNER_ZIP",description:"Designer ZIP code",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_AMOUNT",description:"Construction holdback/reserve amount",category:"Construction",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"CONSTRUCTION_HOLDBACK_PAID_TO",description:"Construction holdback payee",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"CONSTRUCTION_HOLDBACK_PAID_TO_NOTES",description:"Construction holdback delivery notes",category:"Construction",dataType:"text",suggestedFormats:[]},{key:"DISBURSED_AMOUNT",description:"Disbursed amount (loan minus holdback) when Dutch interest is on",category:"Construction",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"EXTENSION_COUNT",description:"Number of extension options",category:"Extensions",dataType:"number",suggestedFormats:["WORDS"]},{key:"EXTENSION_LENGTH",description:"Duration of each extension (months)",category:"Extensions",dataType:"number",suggestedFormats:["WORDS"]},{key:"EXTENSION_FEE_PERCENT",description:"Extension fee as % of loan amount",category:"Extensions",dataType:"rate",suggestedFormats:["PERCENT","WORDS"]},{key:"TERMINATION_FEE_TYPE",description:"Termination fee type (Percentage, Dollar, Greater Of)",category:"Termination & Fees",dataType:"text",suggestedFormats:[]},{key:"TERMINATION_PERCENT",description:"Termination fee percentage",category:"Termination & Fees",dataType:"rate",suggestedFormats:["PERCENT"]},{key:"TERMINATION_DOLLAR",description:"Termination fee dollar amount",category:"Termination & Fees",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"EXIT_FEE_DOLLAR",description:"Exit fee dollar amount",category:"Termination & Fees",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"EXIT_FEE_PERCENT",description:"Exit fee percentage",category:"Termination & Fees",dataType:"rate",suggestedFormats:["PERCENT","WORDS"]},{key:"GUARANTEED_MONTHS_INTEREST",description:"Guaranteed months of interest (prepay)",category:"Termination & Fees",dataType:"number",suggestedFormats:["WORDS"]},{key:"PREPAY_PENALTY_TYPE",description:"Prepayment penalty type (Stepdown, GuaranteedInterest)",category:"Termination & Fees",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_AMOUNT",description:"Debt service reserve amount",category:"Reserves",dataType:"money",suggestedFormats:["CURRENCY","WORDS"]},{key:"DEBT_SERVICE_RESERVE_AMOUNT_WORDS",description:"DSR amount in words",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_WORDS",description:"DSR amount in words (alias)",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_PAID_TO",description:"DSR payee",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"DEBT_SERVICE_RESERVE_PAID_TO_NOTES",description:"DSR delivery notes",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_TAX_RESERVE_AMOUNT",description:"Property tax reserve amount",category:"Reserves",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"PROPERTY_TAX_RESERVE_PAID_TO",description:"Property tax reserve payee",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_TAX_RESERVE_NOTES",description:"Property tax reserve notes",category:"Reserves",dataType:"text",suggestedFormats:[]},{key:"MIN_NUMBER",description:"MERS Identification Number",category:"MERS",dataType:"text",suggestedFormats:[]},{key:"TOTAL_FEES_PERCENT",description:"Sum of all fee percentages",category:"Fees",dataType:"rate",suggestedFormats:["PERCENT"]},{key:"TOTAL_FEES_AMOUNT",description:"Sum of all fee amounts",category:"Fees",dataType:"money",suggestedFormats:["CURRENCY"]},{key:"BORROWER_NAME",description:"Primary borrower full name",category:"Primary Borrower",dataType:"text",suggestedFormats:["UPPER"]},{key:"BORROWER_ENTITY_TYPE",description:"Primary borrower entity type",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_ENTITY_STRUCTURE",description:"Primary borrower entity structure",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_STATE_ORG",description:"Primary borrower state of formation",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_ADDRESS",description:"Primary borrower street address",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_CITY",description:"Primary borrower city",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_STATE",description:"Primary borrower state",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_ZIP",description:"Primary borrower ZIP",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_FULL_ADDRESS",description:"Primary borrower formatted address",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_AUTH_SIGNER",description:"Primary borrower authorized signer",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"BORROWER_AUTH_SIGNER_TITLE",description:"Primary borrower signer title",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"ALL_BORROWERS",description:"All borrowers with entity descriptions",category:"Primary Borrower",dataType:"text",suggestedFormats:[]},{key:"LENDER_NAME",description:"Primary lender full name",category:"Primary Lender",dataType:"text",suggestedFormats:["UPPER"]},{key:"LENDER_ENTITY_TYPE",description:"Primary lender entity type",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_ENTITY_STRUCTURE",description:"Primary lender entity structure",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_STATE_ORG",description:"Primary lender state of formation",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_ADDRESS",description:"Primary lender street address",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_CITY",description:"Primary lender city",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_STATE",description:"Primary lender state",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_ZIP",description:"Primary lender ZIP",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_FULL_ADDRESS",description:"Primary lender formatted address",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_LICENSE",description:"Primary lender license number",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_CLOSING_CONTACT",description:"Primary lender closing contact name",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"LENDER_CLOSING_CONTACT_EMAIL",description:"Primary lender closing contact email",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"ALL_LENDERS",description:"All lenders with entity descriptions and licenses",category:"Primary Lender",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_NAME",description:"Primary guarantor full name",category:"Primary Guarantor",dataType:"text",suggestedFormats:["UPPER"]},{key:"GUARANTOR_ADDRESS",description:"Primary guarantor street address",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_CITY",description:"Primary guarantor city",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_STATE",description:"Primary guarantor state",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_ZIP",description:"Primary guarantor ZIP",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_FULL_ADDRESS",description:"Primary guarantor formatted address",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_ENTITY_TYPE",description:"Primary guarantor entity type",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_ENTITY_STRUCTURE",description:"Primary guarantor entity structure",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"GUARANTOR_STATE_ORG",description:"Primary guarantor state of formation",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"ALL_GUARANTORS",description:"All guarantors with entity descriptions",category:"Primary Guarantor",dataType:"text",suggestedFormats:[]},{key:"BROKER_NAME",description:"Primary broker name",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ADDRESS",description:"Primary broker street address",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_CITY",description:"Primary broker city",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_STATE",description:"Primary broker state",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ZIP",description:"Primary broker ZIP",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_FULL_ADDRESS",description:"Primary broker formatted address",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ENTITY_TYPE",description:"Primary broker entity type",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_ENTITY_STRUCTURE",description:"Primary broker entity structure",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_STATE_ORG",description:"Primary broker state of formation",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_LICENSE_TYPE",description:"Primary broker license type",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"BROKER_LICENSE",description:"Primary broker license number",category:"Primary Broker",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_ADDRESS",description:"Primary property street address",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_CITY",description:"Primary property city",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_STATE",description:"Primary property state",category:"Property",dataType:"text",suggestedFormats:["UPPER"]},{key:"PROPERTY_STATE_UPPER",description:"Primary property state (uppercase)",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_ZIP",description:"Primary property ZIP",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_TYPE",description:"Primary property type",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_PARCEL",description:"Primary property parcel/APN number",category:"Property",dataType:"text",suggestedFormats:[]},{key:"PROPERTY_FULL_ADDRESS",description:"Primary property formatted address",category:"Property",dataType:"text",suggestedFormats:[]},{key:"SECURITY_INSTRUMENT_TYPE",description:"Deed of Trust or Mortgage (per primary property state)",category:"Property",dataType:"text",suggestedFormats:[]},{key:"OWNER_NOTARY_BLOCK",description:"SIG-encoded notary acknowledgment for primary property owner",category:"Property",dataType:"sig",suggestedFormats:[]},{key:"OWNER_NOTARY_TEXT",description:"Plain-text notary acknowledgment for primary property owner",category:"Property",dataType:"text",suggestedFormats:[]},{key:"OWNER_NOTARY_STATE",description:"State name used in primary property owner notary",category:"Property",dataType:"text",suggestedFormats:[]},{key:"OWNER_NOTARY_CITATION",description:"Statutory citation for primary property owner notary",category:"Property",dataType:"text",suggestedFormats:[]},{key:"SERVICER_NAME",description:"Loan servicer name",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_ADDRESS",description:"Servicer street address",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_CITY",description:"Servicer city",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_STATE",description:"Servicer state",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_ZIP",description:"Servicer ZIP",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"SERVICER_FULL_ADDRESS",description:"Servicer formatted full address",category:"Servicer",dataType:"text",suggestedFormats:[]},{key:"ALL_BORROWER_SIGNATURE_BLOCKS",description:"All borrower signature blocks (pre-formatted with nested signatories)",category:"Signature Blocks",dataType:"text",suggestedFormats:[]},{key:"ALL_GUARANTOR_SIGNATURE_BLOCKS",description:"All guarantor signature blocks (pre-formatted with nested signatories)",category:"Signature Blocks",dataType:"text",suggestedFormats:[]},{key:"ALL_LENDER_SIGNATURE_BLOCKS",description:"All lender signature blocks (pre-formatted with nested signatories)",category:"Signature Blocks",dataType:"text",suggestedFormats:[]},{key:"ALL_BORROWER_NOTARY_BLOCKS",description:"All borrower notary acknowledgment blocks joined",category:"Notary Blocks",dataType:"text",suggestedFormats:[]},{key:"ALL_GUARANTOR_NOTARY_BLOCKS",description:"All guarantor notary acknowledgment blocks joined",category:"Notary Blocks",dataType:"text",suggestedFormats:[]},{key:"ALL_LENDER_NOTARY_BLOCKS",description:"All lender notary acknowledgment blocks joined",category:"Notary Blocks",dataType:"text",suggestedFormats:[]},{key:"BORROWER_COUNT",description:"Number of borrowers",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"LENDER_COUNT",description:"Number of lenders",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"GUARANTOR_COUNT",description:"Number of guarantors",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"PROPERTY_COUNT",description:"Number of properties",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"DOT_COUNT",description:"Number of Deed of Trust properties",category:"Counts",dataType:"number",suggestedFormats:[]},{key:"MORTGAGE_COUNT",description:"Number of Mortgage properties",category:"Counts",dataType:"number",suggestedFormats:[]}],I=(new Set(A.map(e=>e.category)),new Set(A.map(e=>e.key)),[{key:"IS_BRIDGE",description:"Loan type is Bridge",category:"Loan Type"},{key:"IS_DSCR",description:"Loan type is DSCR / Rental",category:"Loan Type"},{key:"IS_CONSTRUCTION",description:"Loan type is Construction",category:"Loan Type"},{key:"IS_FIX_FLIP",description:"Loan type is Fix & Flip",category:"Loan Type"},{key:"IS_COMMERCIAL",description:"Loan type is Commercial",category:"Loan Type"},{key:"IS_LAND",description:"Loan type is Land",category:"Loan Type"},{key:"IS_INTEREST_ONLY",description:"Amortization is Interest-Only",category:"Amortization"},{key:"IS_FULLY_AMORTIZED",description:"Amortization is Fully Amortized",category:"Amortization"},{key:"IS_IO_THEN_AMORT",description:"IO then Fully Amortized",category:"Amortization"},{key:"IS_IO_THEN_AMORTIZED",description:"IO then Fully Amortized (alias)",category:"Amortization"},{key:"IS_PARTIALLY_AMORTIZED",description:"Partially Amortized with balloon",category:"Amortization"},{key:"HAS_MERS",description:"MERS is included",category:"Loan Features"},{key:"HAS_CONSTRUCTION_HOLDBACK",description:"Construction holdback/reserve exists (requires amount > $0)",category:"Loan Features"},{key:"HAS_DUTCH_INTEREST",description:"Dutch interest applies",category:"Loan Features"},{key:"HAS_CONSTRUCTION_CONTRACT",description:"Construction contract provided",category:"Loan Features"},{key:"HAS_DESIGN_PROFESSIONAL",description:"Design professional/architect assigned",category:"Loan Features"},{key:"HAS_CONDITIONAL_EXTENSION",description:"Conditional extension right exists",category:"Loan Features"},{key:"HAS_PARTIAL_RELEASE",description:"Partial release clause included",category:"Loan Features"},{key:"HAS_TERMINATION_FEE",description:"Termination fee applies",category:"Loan Features"},{key:"HAS_EXIT_FEE",description:"Exit fee applies",category:"Loan Features"},{key:"HAS_PREPAYMENT_PENALTY",description:"Prepayment penalty applies",category:"Loan Features"},{key:"HAS_DEBT_SERVICE_RESERVE",description:"Debt service reserve exists (requires amount)",category:"Loan Features"},{key:"HAS_DEBT_SERVICE_INTEREST_RESERVE",description:"Alias for HAS_DEBT_SERVICE_RESERVE",category:"Loan Features"},{key:"HAS_DEBT_RESERVE_HOLDBACK",description:"Alias for HAS_DEBT_SERVICE_RESERVE",category:"Loan Features"},{key:"HAS_PROPERTY_TAX_RESERVE",description:"Property tax reserve exists (requires amount)",category:"Loan Features"},{key:"HAS_PROPERTY_TAX_HOLDBACK",description:"Alias for HAS_PROPERTY_TAX_RESERVE",category:"Loan Features"},{key:"HAS_HOLDBACKS",description:"At least one holdback/reserve has amount > $0",category:"Loan Features"},{key:"HAS_CROSS_COLLATERAL",description:"Cross-collateral clause included",category:"Loan Features"},{key:"HAS_BORROWER_SERVICE_FEES",description:"Borrower service fees apply",category:"Loan Features"},{key:"HAS_ACH_PAYMENTS",description:"ACH payments required",category:"Loan Features"},{key:"HAS_W9",description:"W-9 included",category:"Loan Features"},{key:"HAS_SIGNING_AFFIDAVIT",description:"Signing affidavit included",category:"Loan Features"},{key:"LOAN_INTENDED_FOR_SALE",description:"Loan intended for sale",category:"Loan Features"},{key:"NOT_HAS_CONSTRUCTION_HOLDBACK",description:"No construction holdback",category:"Negated Flags"},{key:"NOT_HAS_PREPAYMENT_PENALTY",description:"No prepayment penalty",category:"Negated Flags"},{key:"NOT_HAS_ACH_PAYMENTS",description:"No ACH payments required",category:"Negated Flags"},{key:"HAS_BORROWER",description:"At least one borrower exists",category:"Party Presence"},{key:"HAS_LENDER",description:"At least one lender exists",category:"Party Presence"},{key:"HAS_PROPERTY",description:"At least one property exists",category:"Party Presence"},{key:"HAS_GUARANTOR",description:"Guarantor exists on the loan",category:"Party Presence"},{key:"HAS_BROKER",description:"Broker exists on the loan",category:"Party Presence"},{key:"HAS_SERVICER",description:"Loan servicer is assigned",category:"Party Presence"},{key:"HAS_ESCROW",description:"Escrow company exists",category:"Party Presence"},{key:"HAS_ASSIGNEE",description:"Loan assignee exists",category:"Party Presence"},{key:"MULTIPLE_BORROWERS",description:"More than one borrower",category:"Party Presence"},{key:"MULTIPLE_LENDERS",description:"More than one lender",category:"Party Presence"},{key:"MULTIPLE_GUARANTORS",description:"More than one guarantor",category:"Party Presence"},{key:"MULTIPLE_PROPERTIES",description:"More than one property",category:"Party Presence"},{key:"SINGLE_BORROWER",description:"Exactly one borrower",category:"Party Presence"},{key:"SINGLE_LENDER",description:"Exactly one lender",category:"Party Presence"},{key:"SINGLE_GUARANTOR",description:"Exactly one guarantor",category:"Party Presence"},{key:"SINGLE_PROPERTY",description:"Exactly one property",category:"Party Presence"},{key:"MULTIPLE_ASSIGNEES",description:"More than one assignee",category:"Party Presence"},{key:"HAS_ENTITY_BORROWER",description:"Any borrower is an entity (LLC, Corp)",category:"Borrower Types"},{key:"HAS_TRUST_BORROWER",description:"Any borrower is a trust",category:"Borrower Types"},{key:"HAS_INDIVIDUAL_BORROWER",description:"Any borrower is an individual",category:"Borrower Types"},{key:"BORROWER_IS_ENTITY",description:"Primary borrower is an entity",category:"Borrower Types"},{key:"BORROWER_IS_TRUST",description:"Primary borrower is a trust",category:"Borrower Types"},{key:"BORROWER_IS_INDIVIDUAL",description:"Primary borrower is an individual",category:"Borrower Types"},{key:"BORROWER_HAS_REG_AGENT",description:"Primary borrower has registered agent",category:"Borrower Types"},{key:"HAS_DOT",description:"Has property in a Deed of Trust state",category:"Security Instrument"},{key:"HAS_MORTGAGE",description:"Has property in a Mortgage state",category:"Security Instrument"},{key:"HAS_DOT_AND_MORTGAGE",description:"Has properties in both DOT and Mortgage states",category:"Security Instrument"},{key:"PROPERTY_IS_DOT_STATE",description:"Primary property is in a DOT state",category:"Security Instrument"},{key:"PROPERTY_REQUIRES_WITNESSES",description:"Primary property state requires witnesses",category:"Security Instrument"},{key:"MULTIPLE_DOT_PROPERTIES",description:"More than one DOT property",category:"Security Instrument"},{key:"MULTIPLE_MORTGAGE_PROPERTIES",description:"More than one Mortgage property",category:"Security Instrument"},{key:"MULTIPLE_BORROWER_SIGNERS",description:"More than one borrower signer total",category:"Signature Blocks"},{key:"SIGNER_IS_ENTITY",description:"Any borrower is an entity (needs auth signer)",category:"Signature Blocks"},{key:"HAS_NOTARY_BLOCKS",description:"Borrower notary acknowledgment blocks available",category:"Notary Blocks"},{key:"HAS_GUARANTOR_NOTARY_BLOCKS",description:"Guarantor notary acknowledgment blocks available",category:"Notary Blocks"},{key:"HAS_LENDER_NOTARY_BLOCKS",description:"Lender notary acknowledgment blocks available",category:"Notary Blocks"},{key:"HAS_OWNER_NOTARY_BLOCK",description:"Property owner notary acknowledgment available (scalar)",category:"Notary Blocks"},{key:"HAS_LENDER_FEES",description:"Lender fees exist",category:"Fee Presence"},{key:"HAS_BROKER_FEES",description:"Broker fees exist",category:"Fee Presence"},{key:"HAS_OTHER_FEES",description:"Other fees exist",category:"Fee Presence"},{key:"TERMINATION_IS_PERCENTAGE",description:"Termination fee is percentage-based",category:"Termination & Prepay Types"},{key:"TERMINATION_IS_DOLLAR",description:"Termination fee is dollar-based",category:"Termination & Prepay Types"},{key:"TERMINATION_IS_GREATER_OF",description:"Termination fee is greater of % or $",category:"Termination & Prepay Types"},{key:"PREPAY_TYPE_STEPDOWN",description:"Prepayment penalty is stepdown schedule",category:"Termination & Prepay Types"},{key:"PREPAY_TYPE_GUARANTEED_INTEREST_FOR_X_MONTHS",description:"Prepay is guaranteed months of interest",category:"Termination & Prepay Types"},{key:"HAS_TITLE_COMPANY",description:"Title company info exists",category:"Title & Escrow"},{key:"HAS_CFL_LICENSE",description:"Any lender has CFL license",category:"Title & Escrow"},{key:"PROPERTY_IS_ALABAMA",description:"Primary property is in Alabama",category:"State-Specific"},{key:"PROPERTY_IS_ALASKA",description:"Primary property is in Alaska",category:"State-Specific"},{key:"PROPERTY_IS_ARIZONA",description:"Primary property is in Arizona",category:"State-Specific"},{key:"PROPERTY_IS_ARKANSAS",description:"Primary property is in Arkansas",category:"State-Specific"},{key:"PROPERTY_IS_CALIFORNIA",description:"Primary property is in California",category:"State-Specific"},{key:"PROPERTY_IS_COLORADO",description:"Primary property is in Colorado",category:"State-Specific"},{key:"PROPERTY_IS_CONNECTICUT",description:"Primary property is in Connecticut",category:"State-Specific"},{key:"PROPERTY_IS_DELAWARE",description:"Primary property is in Delaware",category:"State-Specific"},{key:"PROPERTY_IS_DISTRICT_OF_COLUMBIA",description:"Primary property is in DC",category:"State-Specific"},{key:"PROPERTY_IS_FLORIDA",description:"Primary property is in Florida",category:"State-Specific"},{key:"PROPERTY_IS_GEORGIA",description:"Primary property is in Georgia",category:"State-Specific"},{key:"PROPERTY_IS_HAWAII",description:"Primary property is in Hawaii",category:"State-Specific"},{key:"PROPERTY_IS_IDAHO",description:"Primary property is in Idaho",category:"State-Specific"},{key:"PROPERTY_IS_ILLINOIS",description:"Primary property is in Illinois",category:"State-Specific"},{key:"PROPERTY_IS_INDIANA",description:"Primary property is in Indiana",category:"State-Specific"},{key:"PROPERTY_IS_IOWA",description:"Primary property is in Iowa",category:"State-Specific"},{key:"PROPERTY_IS_KANSAS",description:"Primary property is in Kansas",category:"State-Specific"},{key:"PROPERTY_IS_KENTUCKY",description:"Primary property is in Kentucky",category:"State-Specific"},{key:"PROPERTY_IS_LOUISIANA",description:"Primary property is in Louisiana",category:"State-Specific"},{key:"PROPERTY_IS_MAINE",description:"Primary property is in Maine",category:"State-Specific"},{key:"PROPERTY_IS_MARYLAND",description:"Primary property is in Maryland",category:"State-Specific"},{key:"PROPERTY_IS_MASSACHUSETTS",description:"Primary property is in Massachusetts",category:"State-Specific"},{key:"PROPERTY_IS_MICHIGAN",description:"Primary property is in Michigan",category:"State-Specific"},{key:"PROPERTY_IS_MINNESOTA",description:"Primary property is in Minnesota",category:"State-Specific"},{key:"PROPERTY_IS_MISSISSIPPI",description:"Primary property is in Mississippi",category:"State-Specific"},{key:"PROPERTY_IS_MISSOURI",description:"Primary property is in Missouri",category:"State-Specific"},{key:"PROPERTY_IS_MONTANA",description:"Primary property is in Montana",category:"State-Specific"},{key:"PROPERTY_IS_NEBRASKA",description:"Primary property is in Nebraska",category:"State-Specific"},{key:"PROPERTY_IS_NEVADA",description:"Primary property is in Nevada",category:"State-Specific"},{key:"PROPERTY_IS_NEW_HAMPSHIRE",description:"Primary property is in New Hampshire",category:"State-Specific"},{key:"PROPERTY_IS_NEW_JERSEY",description:"Primary property is in New Jersey",category:"State-Specific"},{key:"PROPERTY_IS_NEW_MEXICO",description:"Primary property is in New Mexico",category:"State-Specific"},{key:"PROPERTY_IS_NEW_YORK",description:"Primary property is in New York",category:"State-Specific"},{key:"PROPERTY_IS_NORTH_CAROLINA",description:"Primary property is in North Carolina",category:"State-Specific"},{key:"PROPERTY_IS_NORTH_DAKOTA",description:"Primary property is in North Dakota",category:"State-Specific"},{key:"PROPERTY_IS_OHIO",description:"Primary property is in Ohio",category:"State-Specific"},{key:"PROPERTY_IS_OKLAHOMA",description:"Primary property is in Oklahoma",category:"State-Specific"},{key:"PROPERTY_IS_OREGON",description:"Primary property is in Oregon",category:"State-Specific"},{key:"PROPERTY_IS_PENNSYLVANIA",description:"Primary property is in Pennsylvania",category:"State-Specific"},{key:"PROPERTY_IS_RHODE_ISLAND",description:"Primary property is in Rhode Island",category:"State-Specific"},{key:"PROPERTY_IS_SOUTH_CAROLINA",description:"Primary property is in South Carolina",category:"State-Specific"},{key:"PROPERTY_IS_SOUTH_DAKOTA",description:"Primary property is in South Dakota",category:"State-Specific"},{key:"PROPERTY_IS_TENNESSEE",description:"Primary property is in Tennessee",category:"State-Specific"},{key:"PROPERTY_IS_TEXAS",description:"Primary property is in Texas",category:"State-Specific"},{key:"PROPERTY_IS_UTAH",description:"Primary property is in Utah",category:"State-Specific"},{key:"PROPERTY_IS_VERMONT",description:"Primary property is in Vermont",category:"State-Specific"},{key:"PROPERTY_IS_VIRGINIA",description:"Primary property is in Virginia",category:"State-Specific"},{key:"PROPERTY_IS_WASHINGTON",description:"Primary property is in Washington",category:"State-Specific"},{key:"PROPERTY_IS_WEST_VIRGINIA",description:"Primary property is in West Virginia",category:"State-Specific"},{key:"PROPERTY_IS_WISCONSIN",description:"Primary property is in Wisconsin",category:"State-Specific"},{key:"PROPERTY_IS_WYOMING",description:"Primary property is in Wyoming",category:"State-Specific"},{key:"MULTIPLE_EXTENSION_COUNT",description:"More than one extension option",category:"Extensions"},{key:"MULTIPLE_EXTENSION_LENGTH",description:"Extension length > 1 month",category:"Extensions"},{key:"MULTIPLE_OWNERS_OF_ENTITYS",description:"More than one entity owner",category:"Entity Owners"},{key:"OWNERS_OF_ENTITY_COUNT_GT_2",description:"More than two entity owners",category:"Entity Owners"},{key:"IS_GUARANTY_LIMITED",description:"Guaranty is limited (not yet implemented)",category:"Defaults"},{key:"IS_NOTE_HYPOTHECATION",description:"Note hypothecation (not yet implemented)",category:"Defaults"},{key:"HAS_DIFFERENT_EFFECTIVE_DATE",description:"Different effective date (not yet implemented)",category:"Defaults"}]),N=(new Set(I.map(e=>e.category)),new Set(I.map(e=>e.key)),[{key:"NAME",description:"Full legal name"},{key:"FIRST_NAME",description:"First name (individual)"},{key:"LAST_NAME",description:"Last name (individual)"},{key:"ENTITY_TYPE",description:"Individual, Entity, or Trust"},{key:"ENTITY_STRUCTURE",description:"LLC, Corporation, etc."},{key:"STATE_OF_FORMATION",description:"State of organization"},{key:"STATE_ORG",description:"State of organization (alias)"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"FULL_ADDRESS",description:"Formatted full address"},{key:"ENTITY_DESCRIPTION",description:'e.g., "a California limited liability company"'},{key:"TYPE_IS_INDIVIDUAL",description:"True if individual"},{key:"TYPE_IS_ENTITY",description:"True if entity"},{key:"TYPE_IS_TRUST",description:"True if trust"},{key:"AUTH_SIGNER",description:"First authorized signer name"},{key:"AUTH_SIGNER_TITLE",description:"First signer title"},{key:"HAS_AUTH_SIGNER",description:"True if any signer exists"},{key:"MULTIPLE_AUTH_SIGNERS",description:"True if > 1 signer"},{key:"AUTH_SIGNER_COUNT",description:"Number of signers"}]),O=[{key:"BORROWERS",description:"All borrowers on the loan",category:"Parties",itemFields:[...N,{key:"REG_AGENT",description:"Registered agent name"},{key:"REG_AGENT_ADDRESS",description:"Registered agent address"},{key:"AKA_NAMES",description:"Also-known-as names (comma-separated)"},{key:"HAS_AKA",description:"True if has AKA names"},{key:"AUTH_SIGNER_2",description:"Second authorized signer"},{key:"AUTH_SIGNER_2_TITLE",description:"Second signer title"},{key:"TYPE_IS_CORPORATION",description:"True if entity structure is corporation"},{key:"TYPE_IS_NON_CORPORATION",description:"True if entity structure is NOT corporation"},{key:"BORROWER_SIGNER_NEEDS_SIGNER",description:"True if entity/trust (needs auth signer)"},{key:"STATE_ORG_IS_{STATE}",description:"True if state of formation matches (e.g., STATE_ORG_IS_FLORIDA, STATE_ORG_IS_TEXAS)"},{key:"STATE_IS_{STATE}",description:"True if address state matches (e.g., STATE_IS_LOUISIANA, STATE_IS_CONNECTICUT)"},{key:"STATE_ORG_NOT_TEXAS",description:"True if state of formation is NOT Texas"}]},{key:"LENDERS",description:"All lenders on the loan",category:"Parties",itemFields:[...N,{key:"PERCENTAGE_INTEREST",description:"Lender's percentage interest (e.g., 75.00)"},{key:"HAS_CFL",description:"True if has CFL license"},{key:"CFL_LICENSE",description:"CFL license number"},{key:"HAS_DRE",description:"True if has DRE license"},{key:"DRE_LICENSE",description:"DRE license number"},{key:"LICENSE",description:"Primary license number (CFL or DRE)"},{key:"CLOSING_CONTACT",description:"Closing contact name"},{key:"CLOSING_CONTACT_EMAIL",description:"Closing contact email"}]},{key:"GUARANTORS",description:"All guarantors on the loan",category:"Parties",itemFields:[...N,{key:"AKA_NAMES",description:"Also-known-as names"},{key:"GUARANTOR_NAME",description:"Guarantor name (alias)"},{key:"GUARANTOR_AKA_NAME",description:"Guarantor AKA names"},{key:"GUARANTOR_NAME_NOT_IN_ALL_SIGNERS",description:"True if guarantor isn't already a borrower signer"}]},{key:"BROKERS",description:"All brokers on the loan",category:"Parties",itemFields:[{key:"NAME",description:"Broker name"},{key:"ENTITY_TYPE",description:"Individual, Entity, or Trust"},{key:"ENTITY_STRUCTURE",description:"LLC, Corporation, etc."},{key:"STATE_OF_FORMATION",description:"State of organization"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"FULL_ADDRESS",description:"Formatted full address"},{key:"LICENSE_TYPE",description:"License type (CFL, DRE, etc.)"},{key:"LICENSE",description:"License number"},{key:"FEE",description:"Broker fee"}]},{key:"PROPERTIES",description:"All collateral properties",category:"Properties",itemFields:[{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"STATE_UPPER",description:"State (uppercase)"},{key:"FULL_ADDRESS",description:"Formatted full address"},{key:"PROPERTY_TYPE",description:"Property type (Single Family, etc.)"},{key:"PARCEL_NUMBER",description:"Parcel/APN number"},{key:"IS_DOT",description:"True if Deed of Trust state"},{key:"SECURITY_TYPE",description:'"Deed of Trust" or "Mortgage"'},{key:"REQUIRES_WITNESSES",description:"True if witness-required state"},{key:"LIEN",description:"Lien position (first, second, etc.)"},{key:"LIEN_LOWER",description:"Lien position lowercase"},{key:"ORDINAL",description:"Position ordinal (1st, 2nd, 3rd)"},{key:"PARTIAL_RELEASE_AMOUNT",description:"Partial release amount"},{key:"OWNER",description:"Property owner name"},{key:"OWNER_ENTITY_TYPE",description:"Owner entity type"},{key:"OWNER_STATE_ORG",description:"Owner state of organization"},{key:"DESCRIPTION",description:"Legal description"},{key:"TITLE_ORDER_NUMBER",description:"Title order number"},{key:"TITLE_EFFECTIVE_DATE",description:"Title effective date"},{key:"TITLE_ENDORSEMENTS",description:"Title policy endorsements required"},{key:"TITLE_POLICY_EXCEPTIONS",description:"Instructions to title regarding exceptions"},{key:"TITLE_POLICY_REQUIRED",description:"Type of title policy requested"},{key:"OWNER_NOTARY_BLOCK",description:"Notary acknowledgment for property owner (based on owner's state)"},{key:"OWNER_NOTARY_TEXT",description:"Plain text notary acknowledgment for property owner"},{key:"OWNER_NOTARY_STATE",description:"State abbreviation used for owner notary block"},{key:"OWNER_NOTARY_CITATION",description:"Statutory citation for owner notary block"},{key:"HAS_OWNER_NOTARY_BLOCK",description:"True if owner notary block was generated"}]},{key:"DOT_PROPERTIES",description:"Properties in Deed of Trust states only",category:"Properties",itemFields:[{key:"(same as PROPERTIES)",description:"Same fields as PROPERTIES collection"}]},{key:"MORTGAGE_PROPERTIES",description:"Properties in Mortgage states only",category:"Properties",itemFields:[{key:"(same as PROPERTIES)",description:"Same fields as PROPERTIES collection"}]},{key:"FEES",description:"All fees (lender, broker, and other)",category:"Fees",itemFields:[{key:"DESCRIPTION",description:"Fee type/description"},{key:"AMOUNT",description:"Fee amount (cleaned numeric)"},{key:"OWED_TO",description:"Fee recipient"},{key:"NOTES",description:"Additional notes"},{key:"CATEGORY",description:"Lender, Broker, or Other"}]},{key:"LENDER_FEES",description:"Lender fees only",category:"Fees",itemFields:[{key:"(same as FEES)",description:"Same fields as FEES collection"}]},{key:"BROKER_FEES",description:"Broker fees only",category:"Fees",itemFields:[{key:"(same as FEES)",description:"Same fields as FEES collection"}]},{key:"OTHER_FEES",description:"Other fees only",category:"Fees",itemFields:[{key:"(same as FEES)",description:"Same fields as FEES collection"}]},{key:"PARTIAL_RELEASES",description:"Properties with partial release amounts (only properties that have a release amount set)",category:"Other",itemFields:[{key:"PROPERTY",description:"Full property address"},{key:"PARTIAL_RELEASE_PROP",description:"Full property address (alias)"},{key:"AMOUNT",description:"Release amount"},{key:"RELEASE_AMOUNT",description:"Release amount (alias)"}]},{key:"ASSIGNEES",description:"Loan assignees",category:"Other",itemFields:[{key:"NAME",description:"Assignee name"},{key:"ENTITY_TYPE",description:"Entity type"},{key:"ENTITY_STRUCTURE",description:"Entity structure"},{key:"STATE_OF_FORMATION",description:"State of organization"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"FULL_ADDRESS",description:"Formatted full address"}]},{key:"ENTITY_OWNERS",description:"Owners of the borrowing entity",category:"Other",itemFields:[{key:"NAME",description:"Owner name"},{key:"FIRST_NAME",description:"First name"},{key:"LAST_NAME",description:"Last name"},{key:"ENTITY_TYPE",description:"Entity type"},{key:"ENTITY_STRUCTURE",description:"Entity structure"},{key:"STATE_OF_FORMATION",description:"State of formation"},{key:"ABBREVIATION",description:"Owner abbreviation"},{key:"ADDRESS",description:"Street address"},{key:"CITY",description:"City"},{key:"STATE",description:"State"},{key:"ZIP",description:"ZIP code"},{key:"TYPE_IS_INDIVIDUAL",description:"True if owner is Individual"},{key:"TYPE_IS_ENTITY",description:"True if owner is Entity"},{key:"TYPE_IS_TRUST",description:"True if owner is Trust"},{key:"HAS_AUTH_SIGNER",description:"True if owner has authorized signer"},{key:"AUTH_SIGNER",description:"First authorized signer name"},{key:"AUTH_SIGNER_TITLE",description:"First authorized signer title"},{key:"AUTH_SIGNER_COUNT",description:"Number of authorized signers"}]},{key:"SIGNATURE_BLOCKS",description:"Signature blocks for all borrowers (one per borrower)",category:"Signatures",itemFields:[{key:"BLOCK",description:"Full formatted signature block with nested signatories (use \\n for line breaks)"},{key:"TYPE",description:'"individual", "entity", or "trust"'},{key:"NAME",description:"Party name"},{key:"LINE_LABEL",description:"Flat signature line label (backward compat)"},{key:"ENTITY_NAME",description:"Entity/Trust name (empty for Individual)"},{key:"SIGNER_NAME",description:"Leaf signer name (deepest Individual)"},{key:"SIGNER_TITLE",description:"Leaf signer title"},{key:"TYPE_IS_INDIVIDUAL",description:"True if individual borrower"},{key:"TYPE_IS_ENTITY",description:"True if entity borrower"},{key:"TYPE_IS_TRUST",description:"True if trust borrower"},{key:"HAS_BLOCK",description:"Always true (for conditional use)"}]},{key:"GUARANTOR_SIGNATURE_BLOCKS",description:"Signature blocks for all guarantors (one per guarantor)",category:"Signatures",itemFields:[{key:"BLOCK",description:"Full formatted signature block with nested signatories"},{key:"TYPE",description:'"individual", "entity", or "trust"'},{key:"NAME",description:"Party name"},{key:"LINE_LABEL",description:"Flat signature line label"},{key:"ENTITY_NAME",description:"Entity/Trust name (empty for Individual)"},{key:"SIGNER_NAME",description:"Leaf signer name"},{key:"SIGNER_TITLE",description:"Leaf signer title"},{key:"TYPE_IS_INDIVIDUAL",description:"True if individual guarantor"},{key:"TYPE_IS_ENTITY",description:"True if entity guarantor"},{key:"TYPE_IS_TRUST",description:"True if trust guarantor"},{key:"HAS_BLOCK",description:"Always true"}]},{key:"LENDER_SIGNATURE_BLOCKS",description:"Signature blocks for all lenders (one per lender)",category:"Signatures",itemFields:[{key:"BLOCK",description:"Full formatted signature block with nested signatories"},{key:"TYPE",description:'"individual", "entity", or "trust"'},{key:"NAME",description:"Party name"},{key:"LINE_LABEL",description:"Flat signature line label"},{key:"ENTITY_NAME",description:"Entity/Trust name (empty for Individual)"},{key:"SIGNER_NAME",description:"Leaf signer name"},{key:"SIGNER_TITLE",description:"Leaf signer title"},{key:"TYPE_IS_INDIVIDUAL",description:"True if individual lender"},{key:"TYPE_IS_ENTITY",description:"True if entity lender"},{key:"TYPE_IS_TRUST",description:"True if trust lender"},{key:"HAS_BLOCK",description:"Always true"}]},{key:"BORROWER_SIGNERS",description:"Authorized signers for all borrowers",category:"Signatures",itemFields:[{key:"SIGNER_NAME",description:"Signer full name"},{key:"SIGNER_TITLE",description:"Signer title"},{key:"SIGNER_TYPE",description:"Signer entity type: Individual, Entity, or Trust"},{key:"SIGNER_TYPE_IS_INDIVIDUAL",description:"True if signer is Individual"},{key:"SIGNER_TYPE_IS_ENTITY",description:"True if signer is Entity"},{key:"SIGNER_TYPE_IS_TRUST",description:"True if signer is Trust"},{key:"SIGNER_ENTITY_STRUCTURE",description:"Signer's entity structure (e.g., limited liability company)"},{key:"SIGNER_STATE_OF_FORMATION",description:"Signer's state of formation"},{key:"SIGNER_ADDRESS",description:"Signer's street address"},{key:"SIGNER_CITY",description:"Signer's city"},{key:"SIGNER_STATE",description:"Signer's state"},{key:"SIGNER_ZIP",description:"Signer's ZIP code"},{key:"ENTITY_NAME",description:"Entity being signed for"},{key:"ENTITY_TYPE",description:"Entity type"}]},{key:"LENDER_SIGNERS",description:"Authorized signers for all lenders",category:"Signatures",itemFields:[{key:"SIGNER_NAME",description:"Signer full name"},{key:"SIGNER_TITLE",description:"Signer title"},{key:"SIGNER_TYPE",description:"Signer entity type: Individual, Entity, or Trust"},{key:"SIGNER_TYPE_IS_INDIVIDUAL",description:"True if signer is Individual"},{key:"SIGNER_TYPE_IS_ENTITY",description:"True if signer is Entity"},{key:"SIGNER_TYPE_IS_TRUST",description:"True if signer is Trust"},{key:"SIGNER_ENTITY_STRUCTURE",description:"Signer's entity structure"},{key:"SIGNER_STATE_OF_FORMATION",description:"Signer's state of formation"},{key:"SIGNER_ADDRESS",description:"Signer's street address"},{key:"SIGNER_CITY",description:"Signer's city"},{key:"SIGNER_STATE",description:"Signer's state"},{key:"SIGNER_ZIP",description:"Signer's ZIP code"},{key:"ENTITY_NAME",description:"Entity being signed for"}]},{key:"GUARANTOR_SIGNERS",description:"Authorized signers for all guarantors",category:"Signatures",itemFields:[{key:"SIGNER_NAME",description:"Signer full name"},{key:"SIGNER_TITLE",description:"Signer title"},{key:"SIGNER_TYPE",description:"Signer entity type: Individual, Entity, or Trust"},{key:"SIGNER_TYPE_IS_INDIVIDUAL",description:"True if signer is Individual"},{key:"SIGNER_TYPE_IS_ENTITY",description:"True if signer is Entity"},{key:"SIGNER_TYPE_IS_TRUST",description:"True if signer is Trust"},{key:"SIGNER_ENTITY_STRUCTURE",description:"Signer's entity structure"},{key:"SIGNER_STATE_OF_FORMATION",description:"Signer's state of formation"},{key:"SIGNER_ADDRESS",description:"Signer's street address"},{key:"SIGNER_CITY",description:"Signer's city"},{key:"SIGNER_STATE",description:"Signer's state"},{key:"SIGNER_ZIP",description:"Signer's ZIP code"},{key:"ENTITY_NAME",description:"Entity being signed for"},{key:"AKA_NAME",description:"Guarantor AKA names"}]},{key:"NOTARY_BLOCKS",description:"Notary acknowledgment blocks for all borrowers (state-specific, one per signer)",category:"Notary Blocks",itemFields:[{key:"BLOCK",description:"Full formatted notary block (expands to Word paragraphs with bold venue)"},{key:"TEXT",description:"Plain text notary acknowledgment"},{key:"STATE",description:"State abbreviation (e.g. CA)"},{key:"STATE_NAME",description:"Full state name (e.g. California)"},{key:"CITATION",description:"Statutory citation for the acknowledgment form"},{key:"SIGNER_NAME",description:"Name of person appearing before notary"},{key:"TEMPLATE_TYPE",description:'"individual" or "representative"'},{key:"IS_RON",description:"True if Remote Online Notarization language used"},{key:"HAS_BLOCK",description:"Always true (for conditional use)"}]},{key:"GUARANTOR_NOTARY_BLOCKS",description:"Notary acknowledgment blocks for all guarantors",category:"Notary Blocks",itemFields:[{key:"BLOCK",description:"Full formatted notary block"},{key:"TEXT",description:"Plain text notary acknowledgment"},{key:"STATE",description:"State abbreviation"},{key:"STATE_NAME",description:"Full state name"},{key:"CITATION",description:"Statutory citation"},{key:"SIGNER_NAME",description:"Name of person appearing before notary"},{key:"TEMPLATE_TYPE",description:'"individual" or "representative"'},{key:"IS_RON",description:"True if RON language used"},{key:"HAS_BLOCK",description:"Always true"}]},{key:"LENDER_NOTARY_BLOCKS",description:"Notary acknowledgment blocks for all lenders",category:"Notary Blocks",itemFields:[{key:"BLOCK",description:"Full formatted notary block"},{key:"TEXT",description:"Plain text notary acknowledgment"},{key:"STATE",description:"State abbreviation"},{key:"STATE_NAME",description:"Full state name"},{key:"CITATION",description:"Statutory citation"},{key:"SIGNER_NAME",description:"Name of person appearing before notary"},{key:"TEMPLATE_TYPE",description:'"individual" or "representative"'},{key:"IS_RON",description:"True if RON language used"},{key:"HAS_BLOCK",description:"Always true"}]}],x=(new Set(O.map(e=>e.category)),new Set(O.map(e=>e.key)),"https://app.automateloandocs.com");function P(){try{return localStorage.getItem("ald_api_url")||x}catch{return x}}let b=null,h=null,C=null;const L=[{suffix:"CURRENCY",description:"US dollar format",example:"$850,000.00",applicableTo:["money","number"]},{suffix:"WORDS",description:"Number in English words",example:"Eight Hundred Fifty Thousand and 00/100",applicableTo:["money","number"]},{suffix:"CENTS",description:"Cents portion only",example:"00",applicableTo:["money","number"]},{suffix:"UPPER",description:"UPPERCASE text",example:"JOHN DOE",applicableTo:["text"]},{suffix:"LOWER",description:"lowercase text",example:"john doe",applicableTo:["text"]},{suffix:"DECIMAL2",description:"Two decimal places",example:"12.50",applicableTo:["rate","number"]},{suffix:"DECIMAL3",description:"Three decimal places",example:"12.500",applicableTo:["rate","number"]},{suffix:"LONGDATE",description:"Full date format",example:"January 15, 2026",applicableTo:["date"]},{suffix:"SHORTDATE",description:"Short date format",example:"01/15/2026",applicableTo:["date"]},{suffix:"PERCENT",description:"Percentage with % sign",example:"12.50%",applicableTo:["rate","number"]}];function v(e,t){if(!t.trim())return e;const n=t.toLowerCase();return e.filter(e=>e.key.toLowerCase().includes(n)||e.description.toLowerCase().includes(n))}async function F(e){await Word.run(async t=>{t.document.getSelection().insertText(e,Word.InsertLocation.replace),await t.sync()})}async function w(e,t){let n=!1;return await Word.run(async r=>{const i=r.document.body.search(e,{matchCase:!0});i.load("items"),await r.sync();for(const e of i.items)e.insertText(t,Word.InsertLocation.replace),n=!0;await r.sync()}),n}async function D(e){let t=!1;return await Word.run(async n=>{const r=n.document.body.search(e,{matchCase:!1});r.load("items"),await n.sync(),r.items.length>0&&(r.items[0].select(),t=!0),await n.sync()}),t}function M(e,t,...n){const r=document.createElement(e);return t?.cls&&(r.className=t.cls),t?.attrs&&Object.entries(t.attrs).forEach(([e,t])=>r.setAttribute(e,t)),t?.text&&(r.textContent=t.text),t?.html&&(r.innerHTML=t.html),n.forEach(e=>{"string"==typeof e?r.appendChild(document.createTextNode(e)):r.appendChild(e)}),r}function Y(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function U(e,t,n){e.addEventListener("click",r=>{const i=r.target.closest(t);i&&e.contains(i)&&n(i,r)})}L.map(e=>e.suffix);let G,H,B="",W=A;function $(e){G=e,U(G,".field-item",(e,t)=>{if(t.target.closest(".format-picker"))return;const n=e.getAttribute("data-key"),r=G.querySelector(`.format-picker[data-for="${n}"]`);r&&(G.querySelectorAll(".format-picker.open").forEach(e=>{e!==r&&e.classList.remove("open")}),r.classList.contains("open")?r.classList.remove("open"):r.querySelectorAll(".format-btn").length<=1?V(n,""):r.classList.add("open"))}),U(G,".format-btn",e=>{const t=e.closest(".format-picker");V(t?.getAttribute("data-for")??"",e.getAttribute("data-fmt")??""),t?.classList.remove("open")}),K(),async function(){if(h)return h;try{const e=await fetch(`${P()}/api/catalog/fields`);if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();return h=t.flatMap(e=>e.items.map(t=>({key:t.key,description:t.description,category:e.category,dataType:t.dataType,suggestedFormats:t.formats}))),h}catch{return h=A,h}}().then(e=>{e!==W&&(W=e,K())})}function z(e){B=e,K()}function K(){G.innerHTML="";const e=v(W,B),t=new Map;for(const n of e){const e=t.get(n.category)??[];e.push(n),t.set(n.category,e)}if(0!==t.size)for(const[e,n]of t){const t=M("div",{cls:"category"+(B.length>0?" open":"")}),r=M("div",{cls:"category-header"});r.innerHTML=`<span class="arrow">&#9654;</span> ${e} <span class="count">${n.length}</span>`,r.addEventListener("click",()=>t.classList.toggle("open"));const i=M("div",{cls:"category-body"});for(const e of n){const t=M("div",{cls:"field-item",attrs:{"data-key":e.key}});t.innerHTML=`<span class="field-key">${e.key}</span><span class="field-desc">${e.description}</span>`;const n=M("div",{cls:"format-picker",attrs:{"data-for":e.key}}),r=M("button",{cls:"format-btn",text:"Plain",attrs:{"data-fmt":""}});n.appendChild(r);for(const t of e.suggestedFormats){const e=L.find(e=>e.suffix===t),r=M("button",{cls:"format-btn",text:t,attrs:{"data-fmt":t,title:e?.example??""}});n.appendChild(r)}i.appendChild(t),i.appendChild(n)}t.appendChild(r),t.appendChild(i),G.appendChild(t)}else G.appendChild(M("div",{cls:"field-desc",text:"No fields match your search."}))}async function V(e,t){const n=t?`{{${e}:${t}}}`:`{{${e}}}`;try{await F(n),q(`Inserted ${n}`)}catch{q("Place cursor in document first")}}function q(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}let j,X="",Z=I,J=[],Q=1,ee=null,te=null,ne=null,re=null;function ie(e){if("boolean"===e.type)return e.key;if("IN"===e.operator)return`${e.field} IN "${e.value}"`;const t=isNaN(Number(e.value))?`"${e.value}"`:e.value;return`${e.field} ${e.operator} ${t}`}function oe(){return J.map((e,t)=>{const n=ie(e.atom);return 0===t?n:`${e.joinOperator} ${n}`}).join(" ")}function ae(e){const t=0===J.length?null:"AND";J.push({id:Q++,atom:e,joinOperator:t}),pe()}function se(e){H=e,U(H,".condition-item",e=>{re&&clearTimeout(re),re=setTimeout(()=>{re=null;const t=e.getAttribute("data-key");t&&(ae({type:"boolean",key:t}),le(`Added ${t} to builder`))},250)}),H.addEventListener("dblclick",e=>{const t=e.target.closest(".condition-item");if(!t||!H.contains(t))return;re&&(clearTimeout(re),re=null);const n=t.getAttribute("data-key");n&&async function(e){try{await F(`{{#IF ${e}}}\n\n{{/IF}}`),le(`Inserted IF ${e}`)}catch{le("Place cursor in document first")}}(n)}),U(H,".chip-remove",e=>{var t;t=parseInt(e.getAttribute("data-id")??"0",10),J=J.filter(e=>e.id!==t),J.length>0&&(J[0].joinOperator=null),pe()}),U(H,".builder-join-toggle",e=>{!function(e){const t=J.find(t=>t.id===e);t&&null!==t.joinOperator&&(t.joinOperator="AND"===t.joinOperator?"OR":"AND",pe())}(parseInt(e.getAttribute("data-id")??"0",10))}),U(H,".builder-insert-btn",async e=>{const t=e.getAttribute("data-action")??"";await async function(e){if(0===J.length)return void le("Add at least one condition first");const t=function(e){const t=oe();switch(e){case"block-if":return`{{#IF ${t}}}\n\n{{/IF}}`;case"block-else":return`{{#IF ${t}}}\n\n{{#ELSE}}\n\n{{/IF}}`;case"inline-if":return`{{#IF ${t}}}text here{{/IF}}`;case"unless":return`{{#UNLESS ${t}}}\n\n{{/IF}}`;default:return""}}(e);if(t)try{await F(t);const n=oe();le(`Inserted ${e.toUpperCase()} ${n}`),J=[],pe()}catch{le("Place cursor in document first")}}(t)}),U(H,"#builder-clear-btn",()=>(J=[],pe(),void le("Builder cleared"))),U(H,"#add-custom-btn",()=>{const e=H.querySelector("#custom-input"),t=e?.value.trim().toUpperCase().replace(/\s+/g,"_")??"";t?(ae({type:"boolean",key:t}),e.value="",le(`Added ${t} to builder`)):le("Enter a condition name")}),U(H,"#add-comparison-btn",()=>{const e=H.querySelector("#cmp-field")?.value.trim().toUpperCase().replace(/\s+/g,"_"),t=H.querySelector("#cmp-op")?.value,n=H.querySelector("#cmp-value")?.value.trim();e?n?(ae({type:"comparison",field:e,operator:t,value:n}),H.querySelector("#cmp-field").value="",H.querySelector("#cmp-value").value="",le(`Added ${e} ${t} ${n} to builder`)):le("Enter a value"):le("Enter a field name")}),U(H,".category-header",e=>{const t=e.closest(".category");t&&t.classList.toggle("open")}),de(),async function(){if(b)return b;try{const e=await fetch(`${P()}/api/catalog/conditions`);if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();return b=t.flatMap(e=>e.items.map(t=>({key:t.key,description:t.description,category:e.category}))),b}catch{return b=I,b}}().then(e=>{e!==Z&&(Z=e,de())})}function ce(e){X=e,ye()}function de(){H.innerHTML="",ee=M("div",{cls:"builder-box"}),H.appendChild(ee),te=M("div",{cls:"builder-inputs"}),te.innerHTML='\n    <div class="input-row">\n      <input id="custom-input" type="text" class="builder-input"\n             placeholder="Custom condition (e.g. MY_FLAG)" spellcheck="false" autocomplete="off" />\n      <button id="add-custom-btn" class="builder-add-btn" title="Add to builder">+</button>\n    </div>\n    <div class="input-row">\n      <input id="cmp-field" type="text" class="builder-input"\n             placeholder="FIELD" spellcheck="false" autocomplete="off" style="flex:2;" />\n      <select id="cmp-op" class="builder-input" style="flex:0 0 auto; min-width:48px;">\n        <option value="==">=</option>\n        <option value="!=">!=</option>\n        <option value=">">&gt;</option>\n        <option value=">=">&gt;=</option>\n        <option value="<">&lt;</option>\n        <option value="<=">&lt;=</option>\n        <option value="IN">IN</option>\n      </select>\n      <input id="cmp-value" type="text" class="builder-input"\n             placeholder="value" spellcheck="false" autocomplete="off" style="flex:2;" />\n      <button id="add-comparison-btn" class="builder-add-btn" title="Add comparison to builder">+</button>\n    </div>\n  ',H.appendChild(te),ne=M("div",{cls:"catalog-section"}),H.appendChild(ne),pe(),ye()}function pe(){if(!ee)return;if(0===J.length)return void(ee.innerHTML='\n      <div class="builder-header">\n        <span class="builder-label">CONDITION BUILDER</span>\n      </div>\n      <div class="builder-empty">Click any condition below to start building, or type a custom one above.</div>\n    ');let e='<div class="builder-header">\n    <span class="builder-label">CONDITION BUILDER</span>\n    <button id="builder-clear-btn" class="builder-clear-btn" title="Clear all">Clear</button>\n  </div>';e+='<div class="builder-parts">';for(const t of J)t.joinOperator&&(e+=`<button class="builder-join-toggle" data-id="${t.id}" title="Click to toggle AND / OR">${t.joinOperator}</button>`),e+=`<div class="builder-chip">\n      <span class="chip-text">${Y(ie(t.atom))}</span>\n      <button class="chip-remove" data-id="${t.id}" title="Remove">&times;</button>\n    </div>`;e+="</div>",e+=`<div class="builder-preview">${Y(function(){const e=oe();return`{{#IF ${e}}}\n  ...\n{{/IF}}`}())}</div>`,e+='<div class="builder-insert-actions">\n    <button class="builder-insert-btn" data-action="block-if">Block IF</button>\n    <button class="builder-insert-btn" data-action="block-else">IF / ELSE</button>\n    <button class="builder-insert-btn" data-action="inline-if">Inline IF</button>\n    <button class="builder-insert-btn" data-action="unless">UNLESS</button>\n  </div>',ee.innerHTML=e}function ye(){if(!ne)return;ne.innerHTML="";const e=v(Z,X),t=new Map;for(const n of e){const e=t.get(n.category)??[];e.push(n),t.set(n.category,e)}if(0===t.size){const e=M("div",{cls:"field-desc",text:"No conditions match your search."});return e.style.padding="8px",void ne.appendChild(e)}for(const[e,n]of t){const t=M("div",{cls:"category"+(X.length>0?" open":"")}),r=M("div",{cls:"category-header"});r.innerHTML=`<span class="arrow">&#9654;</span> ${e} <span class="count">${n.length}</span>`;const i=M("div",{cls:"category-body"});for(const e of n){const t=M("div",{cls:"condition-item",attrs:{"data-key":e.key}});t.innerHTML=`<span class="field-key">${Y(e.key)}</span><span class="field-desc" style="margin-left:6px;">${Y(e.description)}</span><span class="add-hint">+</span>`,i.appendChild(t)}t.appendChild(r),t.appendChild(i),ne.appendChild(t)}}function le(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}let ge,ue="",Te=O;function Ee(e){j=e,U(j,".action-btn[data-col]",async e=>{const t=e.getAttribute("data-col")??"",n="row"===(e.getAttribute("data-type")??"")?"ROW":"EACH",r=Te.find(e=>e.key===t),i=r?.itemFields.some(e=>"BLOCK"===e.key),o=`{{#${n} ${t}}}${i?"\n{{ITEM.BLOCK}}\n":"\n\n"}{{/${n} ${t}}}`;try{await F(o),Se(`Inserted ${n} ${t}`)}catch{Se("Place cursor in document first")}}),U(j,".item-field",async e=>{const t=`{{ITEM.${e.getAttribute("data-item")??""}}}`;try{await F(t),Se(`Inserted ${t}`)}catch{Se("Place cursor in document first")}}),fe(),async function(){if(C)return C;try{const e=await fetch(`${P()}/api/catalog/collections`);if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();return C=t.flatMap(e=>e.items.map(t=>({key:t.key,description:t.description,category:e.category,itemFields:t.itemFields}))),C}catch{return C=O,C}}().then(e=>{e!==Te&&(Te=e,fe())})}function me(e){ue=e,fe()}function fe(){j.innerHTML="";const e=ue.toLowerCase(),t=e?Te.filter(t=>t.key.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.itemFields.some(t=>t.key.toLowerCase().includes(e)||t.description.toLowerCase().includes(e))):Te;if(0===t.length)return void j.appendChild(M("div",{cls:"field-desc",text:"No collections match your search."}));const n=M("div",{cls:"ref-section",html:'<div style="font-size:10px; color:#8E949A; padding:4px 4px 8px;">\n      All loops include: <code style="font-family:var(--mono);">ITEM.INDEX</code>,\n      <code style="font-family:var(--mono);">ITEM.IS_FIRST</code>,\n      <code style="font-family:var(--mono);">ITEM.IS_LAST</code>,\n      <code style="font-family:var(--mono);">ITEM.COUNT</code>,\n      <code style="font-family:var(--mono);">ITEM.SEPARATOR</code>\n    </div>'});j.appendChild(n);for(const e of t){const t=M("div",{cls:"collection-card"+(ue?" open":"")}),n=M("div",{cls:"collection-header",attrs:{"data-key":e.key}});n.innerHTML=`<span>${e.key} <span style="font-weight:400; color:#8E949A; font-size:10px;">(${e.itemFields.length} fields)</span></span><span class="arrow">&#9654;</span>`,n.addEventListener("click",()=>t.classList.toggle("open"));const r=M("div",{cls:"collection-body"});r.appendChild(M("div",{cls:"collection-desc",text:e.description}));const i=M("div",{cls:"insert-btns"}),o=M("button",{cls:"action-btn",text:"Block EACH",attrs:{"data-col":e.key,"data-type":"each"}}),a=M("button",{cls:"action-btn",text:"Table ROW",attrs:{"data-col":e.key,"data-type":"row"}});i.appendChild(o),i.appendChild(a),r.appendChild(i);for(const t of e.itemFields){const e=M("div",{cls:"item-field",attrs:{"data-item":t.key}});e.innerHTML=`<span class="field-key" style="font-size:10px;">ITEM.${t.key}</span><span class="field-desc">${t.description}</span>`,r.appendChild(e)}t.appendChild(n),t.appendChild(r),j.appendChild(t)}}function Se(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}const Re=new Set(A.map(e=>e.key.toUpperCase())),ke=new Set(I.map(e=>e.key.toUpperCase())),_e=new Set(O.map(e=>e.key.toUpperCase())),Ae=new Set(L.map(e=>e.suffix.toUpperCase())),Ie=new Set;for(const e of O)for(const t of e.itemFields)Ie.add(t.key.toUpperCase());["INDEX","INDEX0","IS_FIRST","IS_LAST","COUNT","SEPARATOR"].forEach(e=>Ie.add(e));const Ne=new Set([...ke,...Re,..._e]);function Oe(e,t){const n=e.length,r=t.length;if(0===n)return r;if(0===r)return n;const i=Array.from({length:n+1},()=>Array(r+1).fill(0));for(let e=0;e<=n;e++)i[e][0]=e;for(let e=0;e<=r;e++)i[0][e]=e;for(let o=1;o<=n;o++)for(let n=1;n<=r;n++){const r=e[o-1]===t[n-1]?0:1;i[o][n]=Math.min(i[o-1][n]+1,i[o][n-1]+1,i[o-1][n-1]+r)}return i[n][r]}function xe(e,t,n=3){const r=e.toUpperCase();let i=null,o=n+1;for(const e of t){if(Math.abs(e.length-r.length)>n)continue;const t=Oe(r,e);t<o&&(o=t,i=e)}return i}let Pe,be,he,Ce,Le,ve=[];function Fe(e){ge=e,function(){ge.innerHTML="";const e=M("button",{cls:"validate-btn",text:"Scan Document"});e.addEventListener("click",De),ge.appendChild(e),ge.appendChild(M("div",{cls:"field-desc",html:"Click <strong>Scan Document</strong> to find all placeholders and check for errors."}))}()}function we(e){}async function De(){ge.innerHTML="";const e=M("div",{cls:"field-desc",text:"Scanning document..."});ge.appendChild(e);try{const e=(await async function(){const e=[];return await Word.run(async t=>{const n=t.document.body.paragraphs;n.load("text"),await t.sync();for(let t=0;t<n.items.length;t++)e.push(n.items[t].text)}),e}()).join("\n"),t=[];let n=0,r=0,i=0;const o=/\{\{([^}]+)\}\}/g;let a;const s=[];let c=0;for(;null!==(a=o.exec(e));){const e=a[1].trim(),o=a[0];if(e.startsWith("#IF ")||e.startsWith("#UNLESS ")){e.startsWith("#UNLESS");const n=e.replace(/^#(IF|UNLESS)\s+/,"").trim();s.push({type:e.startsWith("#UNLESS")?"UNLESS":"IF",key:n}),r++;const i=n.split(/\s+(?:OR|AND)\s+/i);for(const e of i){const n=e.replace(/\s*[><=!]+\s*\S+$/,"").trim();if(!Ne.has(n.toUpperCase())&&!n.startsWith("ITEM.")){const e=xe(n,Ne),r=e?o.replace(n,e):void 0;t.push({type:"warning",message:`Unknown condition: ${n}`,detail:o,suggestion:r,originalText:e?o:void 0})}n.toUpperCase().startsWith("ITEM.")&&0===c&&t.push({type:"error",message:`Condition ${n} used outside of {{#EACH}} loop`,detail:o})}}else if("#ELSE"===e)if(0===s.length)t.push({type:"error",message:"{{#ELSE}} found outside of any IF/UNLESS block",detail:o});else{const e=s[s.length-1];"IF"!==e.type&&"UNLESS"!==e.type&&t.push({type:"error",message:`{{#ELSE}} inside {{#${e.type} ${e.key}}} — ELSE is only valid inside IF/UNLESS`,detail:o})}else if(e.startsWith("/IF ")||"/IF"===e)if(s.length>0){const e=s[s.length-1];"IF"===e.type||"UNLESS"===e.type?s.pop():t.push({type:"error",message:`Nesting error: {{/IF}} closes a {{#${e.type} ${e.key}}} block`,detail:o})}else t.push({type:"error",message:`Unmatched closing: ${o}`,detail:o});else if(e.startsWith("#EACH ")||e.startsWith("#ROW ")){const n=e.startsWith("#ROW")?"ROW":"EACH",r=e.replace(/^#(EACH|ROW)\s+/,"").trim();if(s.push({type:n,key:r}),i++,c++,!_e.has(r.toUpperCase())){const e=xe(r,_e),i=e?`{{#${n} ${e}}}`:void 0;t.push({type:"warning",message:`Unknown collection: ${r}`,detail:o,suggestion:i,originalText:e?o:void 0})}}else if(e.startsWith("/EACH")||e.startsWith("/ROW")){const n=e.startsWith("/ROW")?"ROW":"EACH";if(s.length>0){const e=s[s.length-1];e.type===n?(s.pop(),c--):t.push({type:"error",message:`Nesting error: {{/${n}}} closes a {{#${e.type} ${e.key}}} block`,detail:o})}else t.push({type:"error",message:`Unmatched closing: ${o}`,detail:o})}else if(e.startsWith("ITEM.")||e.startsWith("item.")){const r=e.replace(/^item\./i,""),i=r.split(":")[0].trim().toUpperCase(),a=r.split(":")[1]?.trim().toUpperCase();if(n++,0===c&&t.push({type:"error",message:`ITEM.${i} used outside of {{#EACH}} loop`,detail:o}),!Ie.has(i)){const e=xe(i,Ie),n=e?`{{ITEM.${e}${a?":"+a:""}}}`:void 0;t.push({type:"warning",message:`Unknown item field: ITEM.${i}`,detail:o,suggestion:n,originalText:e?o:void 0})}if(a&&!Ae.has(a)){const e=xe(a,Ae,2),n=e?`{{ITEM.${i}:${e}}}`:void 0;t.push({type:"warning",message:`Unknown format: ${a}`,detail:o,suggestion:n,originalText:e?o:void 0})}}else if(!e.startsWith("#")&&!e.startsWith("/")){n++;const r=e.split(":"),i=r[0].trim().toUpperCase(),a=r[1]?.trim().toUpperCase();if(!Re.has(i)&&!ke.has(i)){const e=xe(i,Re),n=e?`{{${e}${a?":"+a:""}}}`:void 0;t.push({type:"warning",message:`Unknown field: ${i}`,detail:o,suggestion:n,originalText:e?o:void 0})}if(a&&!Ae.has(a)){const e=xe(a,Ae,2),n=e?`{{${i}:${e}}}`:void 0;t.push({type:"warning",message:`Unknown format: ${a}`,detail:o,suggestion:n,originalText:e?o:void 0})}}}for(const e of s){const n="UNLESS"===e.type?"IF":e.type;t.push({type:"error",message:`Unclosed ${e.type} block: ${e.key}`,detail:`Missing {{/${n} ${e.key}}}`})}ve=t,function(e,t,n,r,i){ge.innerHTML="";const o=M("button",{cls:"validate-btn",text:"Re-scan Document"});o.addEventListener("click",De),ge.appendChild(o);const a=e.filter(e=>"error"===e.type).length,s=e.filter(e=>"warning"===e.type).length,c=e.filter(e=>e.suggestion).length,d=0===a&&0===s?`${t} fields, ${n} conditions, ${r} loops — No issues found`:`${t} fields, ${n} conditions, ${r} loops — ${a} error${1!==a?"s":""}, ${s} warning${1!==s?"s":""}`,p=M("div",{cls:"validate-summary "+(a>0?"errors":"success")}),y=M("span",{text:d});if(p.appendChild(y),c>0){const t=M("button",{cls:"fix-all-btn",text:`Fix All (${c})`});t.addEventListener("click",()=>async function(e){const t=e.filter(e=>e.suggestion&&e.originalText&&!e.fixed);let n=0;for(const r of t)try{if(await w(r.originalText,r.suggestion)){r.fixed=!0,n++;const t=ge.querySelector(`[data-issue-idx="${e.indexOf(r)}"]`);if(t){t.classList.add("fixed");const e=t.querySelector(".issue-type");e&&(e.className="issue-type fixed-label",e.textContent="FIXED");const n=t.querySelector(".issue-fix-btn");n&&(n.textContent="Done",n.disabled=!0,n.classList.add("fixed"))}}}catch{}Ue(`Fixed ${n} of ${t.length} issues`),Ye()}(e)),p.appendChild(t)}if(ge.appendChild(p),0===r&&0===a){const e=["PROPERTY_","BORROWER_","LENDER_","GUARANTOR_","BROKER_","ENTITY_OWNER_","ASSIGNEE_","FEE_"];if((i.match(/\{\{([^}]+)\}\}/g)||[]).some(t=>{const n=t.replace(/\{\{|\}\}/g,"").trim().split(":")[0].toUpperCase();return e.some(e=>n.startsWith(e))})){const e=M("div",{cls:"validate-info"});e.innerHTML='<span style="color:#92400e;font-weight:600;">Tip:</span> This template uses collection-derived fields (e.g., PROPERTY_*, BORROWER_*) without EACH loops. If configured as a <strong>Multiply By</strong> template in the admin panel, each copy will automatically receive per-item data.',ge.appendChild(e)}}for(let t=0;t<e.length;t++){const n=e[t],r=M("div",{cls:"issue-card"});r.setAttribute("data-issue-idx",String(t));let i=`\n      <div class="issue-type ${n.type}">${Y(n.type)}</div>\n      <div class="issue-text">${Y(n.message)}</div>\n      <div class="issue-detail">${Y(n.detail)}</div>\n    `;n.suggestion&&(i+=`\n        <div class="issue-suggestion-row">\n          <span class="issue-suggestion">Did you mean: <code>${Y(n.suggestion)}</code></span>\n          <button class="issue-fix-btn" data-fix-idx="${t}">Fix</button>\n        </div>\n      `),r.innerHTML=i,r.addEventListener("click",async e=>{e.target.classList.contains("issue-fix-btn")||Ue(await D(n.detail)?`Navigated to: ${n.detail}`:"Could not locate in document")});const o=r.querySelector(".issue-fix-btn");o&&o.addEventListener("click",async e=>{e.stopPropagation(),await Me(n,r)}),ge.appendChild(r)}}(t,n,r,i,e),Ue(`Scan complete: ${n} fields, ${t.length} issues`)}catch(e){ge.innerHTML="",ge.appendChild(M("div",{cls:"validate-summary errors",text:`Error scanning: ${e}`}))}}async function Me(e,t){if(e.originalText&&e.suggestion&&!e.fixed)try{if(await w(e.originalText,e.suggestion)){e.fixed=!0,t.classList.add("fixed");const n=t.querySelector(".issue-type");n&&(n.className="issue-type fixed-label",n.textContent="FIXED");const r=t.querySelector(".issue-fix-btn");r&&(r.textContent="Done",r.disabled=!0,r.classList.add("fixed")),Ue(`Fixed: ${e.originalText} → ${e.suggestion}`),Ye()}else Ue(`Could not find "${e.originalText}" in document`)}catch(e){Ue(`Fix failed: ${e}`)}}function Ye(){const e=ve.filter(e=>e.suggestion&&!e.fixed).length,t=ge.querySelector(".fix-all-btn");t&&(0===e?(t.textContent="All Fixed",t.disabled=!0,t.classList.add("fixed")):t.textContent=`Fix All (${e})`)}function Ue(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}function Ge(e){Pe=e,function(){Pe.innerHTML="";const e=M("div",{cls:"ref-section"});e.innerHTML='\n    <h3>Placeholder Syntax</h3>\n    <div class="ref-row"><span class="ref-syntax">{{FIELD}}</span><span class="ref-explain">Simple field replacement</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{FIELD:FORMAT}}</span><span class="ref-explain">Formatted field (e.g., :CURRENCY, :WORDS)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF FLAG}}</span><span class="ref-explain">Start conditional block</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{/IF FLAG}}</span><span class="ref-explain">End conditional block</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF A and B}}</span><span class="ref-explain">AND &mdash; both must be true</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF A or B}}</span><span class="ref-explain">OR &mdash; either can be true</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF A and B or C}}</span><span class="ref-explain">AND binds tighter: (A AND B) OR C</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF KEY == "val"}}</span><span class="ref-explain">Field comparison (==, !=, &gt;, &gt;=, &lt;, &lt;=)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#IF KEY IN "a,b,c"}}</span><span class="ref-explain">True if KEY matches any listed value</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#UNLESS FLAG}}</span><span class="ref-explain">Negated conditional (show when false)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#ELSE}}</span><span class="ref-explain">Else branch inside IF block</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#EACH COLL}}</span><span class="ref-explain">Loop over collection (paragraph-level)</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{/EACH COLL}}</span><span class="ref-explain">End loop</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{#ROW COLL}}</span><span class="ref-explain">Loop table rows</span></div>\n    <div class="ref-row"><span class="ref-syntax">{{ITEM.FIELD}}</span><span class="ref-explain">Field inside a loop</span></div>\n  ',Pe.appendChild(e);const t=M("div",{cls:"ref-section"});let n="<h3>Format Specifiers</h3>";for(const e of L)n+=`<div class="ref-row"><span class="ref-syntax">:${e.suffix}</span><span class="ref-explain">${e.description} &mdash; <em>${e.example}</em></span></div>`;t.innerHTML=n,Pe.appendChild(t);const r=M("div",{cls:"ref-section"});r.innerHTML='\n    <h3>Tips</h3>\n    <div class="ref-row"><span class="ref-explain"><strong>Case-insensitive</strong> &mdash; {{loan_amount}}, {{LOAN_AMOUNT}}, {{Loan_Amount}} all work</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Whitespace-tolerant</strong> &mdash; {{ FIELD }} and {{FIELD}} both work</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Block vs Inline IF</strong> &mdash; If opening and closing tags are in the <em>same</em> paragraph, only text between them is toggled. If in <em>different</em> paragraphs, entire paragraphs are removed.</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Split runs</strong> &mdash; Word may split {{FIELD}} across multiple XML runs. The engine normalizes this automatically.</span></div>\n    <div class="ref-row"><span class="ref-explain"><strong>Content Controls</strong> &mdash; You can also use Word Content Controls with a Tag matching the field name.</span></div>\n  ',Pe.appendChild(r);const i=M("div",{cls:"ref-section"});i.innerHTML='\n    <h3>Loop Meta Fields</h3>\n    <div class="ref-row"><span class="ref-syntax">ITEM.INDEX</span><span class="ref-explain">1-based position (1, 2, 3...)</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.IS_FIRST</span><span class="ref-explain">"true" for the first item</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.IS_LAST</span><span class="ref-explain">"true" for the last item</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.COUNT</span><span class="ref-explain">Total items in collection</span></div>\n    <div class="ref-row"><span class="ref-syntax">ITEM.SEPARATOR</span><span class="ref-explain">Smart comma+and: "A, B, and C"</span></div>\n  ',Pe.appendChild(i)}()}function He(e){}let Be=!1;const We=["What field for borrower name?","How to conditionally show a section?","Show me a ROW table example","What conditions for construction loans?"];function $e(e){be=e,be.innerHTML=`\n    <div class="ask-quick-section">\n      <div class="ask-section-label">Quick Questions</div>\n      <div class="ask-chips">\n        ${We.map(e=>`<button class="ask-chip" data-quick="${Y(e)}">${Y(e)}</button>`).join("")}\n      </div>\n    </div>\n    <div class="ask-input-row">\n      <textarea class="ask-input" placeholder="Ask about fields, conditions, syntax... (paste template snippets here)" rows="2" maxlength="3000"></textarea>\n      <button class="ask-send-btn" title="Send">&#9654;</button>\n    </div>\n    <div class="ask-response"></div>\n  `,he=be.querySelector(".ask-input"),Ce=be.querySelector(".ask-response"),Le=be.querySelector(".ask-send-btn"),he&&(he.addEventListener("keydown",e=>{"Enter"===e.key&&!e.shiftKey&&he.value.trim()&&(e.preventDefault(),Ke(he.value.trim()))}),he.addEventListener("input",()=>qe(he))),U(be,"[data-quick]",e=>{const t=e.getAttribute("data-quick");t&&Ke(t)}),U(be,".ask-send-btn",()=>{he?.value.trim()&&Ke(he.value.trim())}),U(be,"[data-insert-field]",async e=>{const t=e.getAttribute("data-insert-field")||"";try{await F(t),Ve(`Inserted ${t}`)}catch{Ve("Insert failed")}}),he=be.querySelector(".ask-input"),Ce=be.querySelector(".ask-response"),Le=be.querySelector(".ask-send-btn"),he&&(he.addEventListener("keydown",e=>{"Enter"===e.key&&!e.shiftKey&&he.value.trim()&&(e.preventDefault(),Ke(he.value.trim()))}),he.addEventListener("input",()=>qe(he)))}function ze(e){}async function Ke(e){if(!Be){Be=!0,he&&(he.value=e),Ce&&(Ce.innerHTML='\n    <div class="ask-loading">\n      <div class="ask-spinner"></div>\n      <span>Thinking...</span>\n    </div>\n  '),Ve("Asking AI...");try{const t=await async function(e){const t=await fetch(`${P()}/api/catalog/ask`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})});if(!t.ok){const e=await t.text();throw new Error(e||`Error ${t.status}`)}return(await t.json()).answer}(e);!function(e,t){Ce&&(Ce.innerHTML=`<div class="ask-answer">${function(e){let t=Y(e);return t=t.replace(/`(\{\{[^`]+?\}\})`/g,(e,t)=>{const n=t.trim();return`<button class="ask-field-chip" data-insert-field="${Y(n)}" title="Click to insert">${Y(n)}</button>`}),t=t.replace(/`([^`]+?)`/g,(e,t)=>`<code class="ask-code">${Y(t)}</code>`),t=t.replace(/\n/g,"<br>"),t}(t)}</div>`)}(0,t),Ve("Ready")}catch(e){t=e instanceof Error?e.message:"Unknown error",Ce&&(Ce.innerHTML=`\n    <div class="ask-error">\n      Could not get a response. ${Y(t)}\n    </div>\n  `),Ve("Error")}finally{Be=!1,he&&(he.value="",he.focus())}}var t}function Ve(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}function qe(e){e.style.height="auto",e.style.height=Math.min(e.scrollHeight,120)+"px"}const je={fields:r,conditions:i,loops:o,validate:a,reference:s,ask:c};let Xe="fields",Ze=null;function Je(e){Xe=e,document.querySelectorAll("#tab-bar .tab").forEach(t=>{t.classList.toggle("active",t.getAttribute("data-tab")===e)}),document.querySelectorAll(".tab-panel").forEach(t=>{t.classList.toggle("active",t.id===`tab-${e}`)});const t=document.getElementById("search-input");t&&t.value&&(t.value="",je[e]?.search(""))}Office.onReady(e=>{e.host===Office.HostType.Word&&function(){const e=document.getElementById("tab-bar");e&&e.addEventListener("click",e=>{const t=e.target.closest("[data-tab]");if(!t)return;const n=t.getAttribute("data-tab");n&&n!==Xe&&Je(n)});const t=document.getElementById("search-input");t&&t.addEventListener("input",()=>{Ze&&clearTimeout(Ze),Ze=setTimeout(()=>{const e=t.value.trim();je[Xe]?.search(e)},200)});for(const[e,t]of Object.entries(je)){const n=document.getElementById(`tab-${e}`);n&&t.init(n)}Je("fields"),function(){const e=document.getElementById("status-text");e&&(e.textContent="Ready — click a field to insert")}()}()})})();